<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Eric Chang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="~爱前端，爱生活~">
<meta property="og:type" content="website">
<meta property="og:title" content="Eric Chang's Blog">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="Eric Chang's Blog">
<meta property="og:description" content="~爱前端，爱生活~">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Eric Chang's Blog">
<meta name="twitter:description" content="~爱前端，爱生活~">
  
    <link rel="alternative" href="/atom.xml" title="Eric Chang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">


	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/images/me.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/" style="font-family: Microsoft Yahei;">Eric Chang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">归档</a></li>
				        
							<li><a href="/tags/feeling">感悟</a></li>
				        
							<li><a href="/tags/me">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/changsiyuan" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/2803286360" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="mailto:changsiyuan2011@126.com" title="mail">mail</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/preview?locale=zh_CN&trk=prof-0-sb-preview-primary-button" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Angularjs/" style="font-size: 11.25px;">Angularjs</a> <a href="/tags/JSONP/" style="font-size: 10px;">JSONP</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/JavaScript/" style="font-size: 18.75px;">JavaScript</a> <a href="/tags/Latex/" style="font-size: 10px;">Latex</a> <a href="/tags/Linkedlist/" style="font-size: 11.25px;">Linkedlist</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Operating-System/" style="font-size: 10px;">Operating System</a> <a href="/tags/RESTful/" style="font-size: 10px;">RESTful</a> <a href="/tags/Tree/" style="font-size: 11.25px;">Tree</a> <a href="/tags/Web/" style="font-size: 17.5px;">Web</a> <a href="/tags/books/" style="font-size: 11.25px;">books</a> <a href="/tags/computer/" style="font-size: 11.25px;">computer</a> <a href="/tags/cooking/" style="font-size: 10px;">cooking</a> <a href="/tags/css/" style="font-size: 12.5px;">css</a> <a href="/tags/datebase/" style="font-size: 13.75px;">datebase</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/feeling/" style="font-size: 16.25px;">feeling</a> <a href="/tags/git/" style="font-size: 11.25px;">git</a> <a href="/tags/glassfish/" style="font-size: 10px;">glassfish</a> <a href="/tags/hadoop/" style="font-size: 16.25px;">hadoop</a> <a href="/tags/hardware/" style="font-size: 10px;">hardware</a> <a href="/tags/hdfs/" style="font-size: 10px;">hdfs</a> <a href="/tags/html/" style="font-size: 11.25px;">html</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/jQuery/" style="font-size: 12.5px;">jQuery</a> <a href="/tags/javaEE/" style="font-size: 10px;">javaEE</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/mail/" style="font-size: 10px;">mail</a> <a href="/tags/mapreduce/" style="font-size: 13.75px;">mapreduce</a> <a href="/tags/me/" style="font-size: 10px;">me</a> <a href="/tags/network/" style="font-size: 10px;">network</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/others/" style="font-size: 11.25px;">others</a> <a href="/tags/psychology/" style="font-size: 11.25px;">psychology</a> <a href="/tags/publicity/" style="font-size: 10px;">publicity</a> <a href="/tags/selenium/" style="font-size: 10px;">selenium</a> <a href="/tags/translation/" style="font-size: 11.25px;">translation</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/home.html">阮一峰</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://es6.ruanyifeng.com/#README">ES6</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript">MDN-JavaScript</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.uisdc.com/">优设网</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我叫常思源，毕业于北京邮电大学。专注前端开发事业。虽然在很多方面仍是小白，但我会不断努力哒~</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Eric Chang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/images/me.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Eric Chang</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">归档</a></li>
		        
					<li><a href="/tags/feeling">感悟</a></li>
		        
					<li><a href="/tags/me">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/changsiyuan" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/2803286360" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="mailto:changsiyuan2011@126.com" title="mail">mail</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/preview?locale=zh_CN&trk=prof-0-sb-preview-primary-button" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-java-zip" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/28/java-zip/" class="article-date">
  	<time datetime="2015-10-27T16:00:00.000Z" itemprop="datePublished">2015-10-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/28/java-zip/">java 文件压缩和解压</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>文件压缩和解压是常见的操作</li>
<li>本文重点总结了java中文件压缩和解压的方法</li>
</ul>
<h3 id="方法一">方法一</h3><ul>
<li>zip格式，不支持中文</li>
<li>压缩：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileInputStream;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileOutputStream;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.IOException;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipEntry;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span><br><span class="line"></span>&#123;	</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main( String[] args )</span><br><span class="line">    &#123;</span><br><span class="line">    	byte[] buffer = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">try</span>&#123;</span><br><span class="line">    		</span><br><span class="line">    		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"C:\\MyFile.zip"</span>);</span><br><span class="line">    		ZipOutputStream zos = <span class="keyword">new</span> ZipOutputStream(fos);</span><br><span class="line">    		ZipEntry ze= <span class="keyword">new</span> ZipEntry(<span class="string">"spy.log"</span>);</span><br><span class="line">    		zos.putNextEntry(ze);</span><br><span class="line">    		FileInputStream <span class="keyword">in</span> = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\spy.log"</span>);</span><br><span class="line">   	   </span><br><span class="line">    		int len;</span><br><span class="line">    		<span class="keyword">while</span> ((len = <span class="keyword">in</span>.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    			zos.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">    		&#125;</span><br><span class="line"></span><br><span class="line">    		<span class="keyword">in</span>.close();</span><br><span class="line">    		zos.closeEntry();</span><br><span class="line">           </span><br><span class="line">    		<span class="comment">//remember close it</span></span><br><span class="line">    		zos.close();</span><br><span class="line">          </span><br><span class="line">    		System.out.println(<span class="string">"Done"</span>);</span><br><span class="line"></span><br><span class="line">    	&#125;<span class="keyword">catch</span>(IOException ex)&#123;</span><br><span class="line">    	   ex.printStackTrace();</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解压</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> UnZip</span><br><span class="line">&#123;</span><br><span class="line">    List&lt;String&gt; fileList;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INPUT_ZIP_FILE = <span class="string">"C:\\MyFile.zip"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String OUTPUT_FOLDER = <span class="string">"C:\\outputzip"</span>;</span><br><span class="line">		</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main( String[] args )</span><br><span class="line">    &#123;</span><br><span class="line">    	UnZip unZip = <span class="keyword">new</span> UnZip();</span><br><span class="line">    	unZip.unZipIt(INPUT_ZIP_FILE,OUTPUT_FOLDER);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Unzip it</span><br><span class="line">     * @param zipFile input zip file</span><br><span class="line">     * @param output zip file output folder</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> unZipIt(String zipFile, String outputFolder)&#123;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    	</span><br><span class="line">     <span class="keyword">try</span>&#123;</span><br><span class="line">    		</span><br><span class="line">    	<span class="comment">//create output directory is not exists</span></span><br><span class="line">    	<span class="keyword">File</span> folder = <span class="keyword">new</span> <span class="keyword">File</span>(OUTPUT_FOLDER);</span><br><span class="line">    	<span class="keyword">if</span>(!folder.exists())&#123;</span><br><span class="line">    		folder.mkdir();</span><br><span class="line">    	&#125;</span><br><span class="line">    		</span><br><span class="line">    	<span class="comment">//get the zip file content</span></span><br><span class="line">    	ZipInputStream zis = </span><br><span class="line">    		<span class="keyword">new</span> ZipInputStream(<span class="keyword">new</span> FileInputStream(zipFile));</span><br><span class="line">    	<span class="comment">//get the zipped file list entry</span></span><br><span class="line">    	ZipEntry ze = zis.getNextEntry();</span><br><span class="line">    		</span><br><span class="line">    	<span class="keyword">while</span>(ze!=<span class="keyword">null</span>)&#123;</span><br><span class="line">    			</span><br><span class="line">    	   String fileName = ze.getName();</span><br><span class="line">           <span class="keyword">File</span> newFile = <span class="keyword">new</span> <span class="keyword">File</span>(outputFolder + <span class="keyword">File</span>.separator + fileName);</span><br><span class="line">                </span><br><span class="line">           System.out.<span class="keyword">println</span>(<span class="string">"file unzip : "</span>+ newFile.getAbsoluteFile());</span><br><span class="line">                </span><br><span class="line">            <span class="comment">//create all non exists folders</span></span><br><span class="line">            <span class="comment">//else you will hit FileNotFoundException for compressed folder</span></span><br><span class="line">            <span class="keyword">new</span> <span class="keyword">File</span>(newFile.getParent()).mkdirs();</span><br><span class="line">              </span><br><span class="line">            FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(newFile);             </span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> len;</span><br><span class="line">            <span class="keyword">while</span> ((len = zis.<span class="keyword">read</span>(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">       		fos.<span class="keyword">write</span>(buffer, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line">        		</span><br><span class="line">            fos.close();   </span><br><span class="line">            ze = zis.getNextEntry();</span><br><span class="line">    	&#125;</span><br><span class="line">    	</span><br><span class="line">        zis.closeEntry();</span><br><span class="line">    	zis.close();</span><br><span class="line">    		</span><br><span class="line">    	System.out.<span class="keyword">println</span>(<span class="string">"Done"</span>);</span><br><span class="line">    		</span><br><span class="line">    &#125;<span class="keyword">catch</span>(IOException ex)&#123;</span><br><span class="line">       ex.printStackTrace(); </span><br><span class="line">    &#125;</span><br><span class="line">   &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法二">方法二</h3><ul>
<li>GBK编码，支持中文，zip格式</li>
<li>压缩</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">File</span>; </span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.IOException; </span><br><span class="line"><span class="keyword">import</span> java.io.InputStream; </span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset; </span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry; </span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> zip &#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[]) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">      <span class="keyword">File</span> inFile = <span class="keyword">new</span> <span class="keyword">File</span>(<span class="string">"D:\\test.txt"</span>); </span><br><span class="line">      ZipOutputStream zos = <span class="keyword">new</span> ZipOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\test.zip"</span>), Charset.forName(<span class="string">"GBK"</span>));</span><br><span class="line">      </span><br><span class="line">      zos.setComment(<span class="string">"ziped by Ming Cheng."</span>); </span><br><span class="line">      zipFile(inFile, zos, <span class="string">""</span>); </span><br><span class="line">      zos.close(); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> zipFile(<span class="keyword">File</span> inFile, ZipOutputStream zos, String dir) <span class="keyword">throws</span> IOException &#123; </span><br><span class="line">        <span class="keyword">if</span> (inFile.isDirectory()) &#123; </span><br><span class="line">            <span class="keyword">File</span>[] files = inFile.listFiles(); </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">File</span> <span class="keyword">file</span>:files) </span><br><span class="line">                zipFile(<span class="keyword">file</span>, zos, dir + <span class="string">"\\"</span> + inFile.getName()); </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            String entryName = <span class="keyword">null</span>; </span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">""</span>.equals(dir)) </span><br><span class="line">                entryName = dir + <span class="string">"\\"</span> + inFile.getName(); </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                entryName = inFile.getName(); </span><br><span class="line">                </span><br><span class="line">            ZipEntry entry = <span class="keyword">new</span> ZipEntry(entryName); </span><br><span class="line">            zos.putNextEntry(entry); </span><br><span class="line">            </span><br><span class="line">            InputStream is = <span class="keyword">new</span> FileInputStream(inFile); </span><br><span class="line">            <span class="keyword">int</span> len = <span class="number">0</span>; </span><br><span class="line">            <span class="keyword">while</span> ((len = is.<span class="keyword">read</span>()) != -<span class="number">1</span>) </span><br><span class="line">                zos.<span class="keyword">write</span>(len); </span><br><span class="line">                </span><br><span class="line">            is.close(); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解压</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.File;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileInputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileOutputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.IOException;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.InputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.OutputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.nio.charset.Charset;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipEntry;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipFile;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipInputStream;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Unzip</span> </span>&#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[]) throws IOException &#123; </span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"D:\\test.zip"</span>);</span><br><span class="line">        ZipFile zipFile = <span class="keyword">new</span> ZipFile(file, Charset.forName(<span class="string">"GBK"</span>));</span><br><span class="line"></span><br><span class="line">        ZipInputStream zipInputStream = <span class="keyword">new</span> ZipInputStream(<span class="keyword">new</span> FileInputStream(file), Charset.forName(<span class="string">"GBK"</span>)); </span><br><span class="line">        unpack(zipFile, zipInputStream); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> unpack(ZipFile zipFile, ZipInputStream zipInputStream) throws IOException &#123; </span><br><span class="line"></span><br><span class="line">        ZipEntry zipEntry = <span class="literal">null</span>; </span><br><span class="line">        <span class="keyword">while</span> ((zipEntry = zipInputStream.getNextEntry()) != <span class="literal">null</span>) &#123; </span><br><span class="line">            String fileName = zipEntry.getName(); </span><br><span class="line">            File temp = <span class="keyword">new</span> File(<span class="string">"D:\\Test\\"</span> + fileName); </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (! temp.getParentFile().exists()) </span><br><span class="line">                temp.getParentFile().mkdirs(); </span><br><span class="line"></span><br><span class="line">            OutputStream os = <span class="keyword">new</span> FileOutputStream(temp); </span><br><span class="line">            InputStream <span class="keyword">is</span> = zipFile.getInputStream(zipEntry); </span><br><span class="line"></span><br><span class="line">            int len = <span class="number">0</span>; </span><br><span class="line">            System.out.println(zipEntry.getName()); </span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> ((len = <span class="keyword">is</span>.read()) != -<span class="number">1</span>) </span><br><span class="line">                os.write(len); </span><br><span class="line"></span><br><span class="line">            os.close(); </span><br><span class="line">            <span class="keyword">is</span>.close(); </span><br><span class="line">        &#125; </span><br><span class="line">        zipInputStream.close(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Java/">Java</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-math" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/27/js-math/" class="article-date">
  	<time datetime="2015-10-26T16:00:00.000Z" itemprop="datePublished">2015-10-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/27/js-math/">javascript 数学函数汇总</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>javascript中数学函数十分强大，能够帮助我们完成大多数常用的数学计算任务；</li>
<li>本文汇总了这些常用的数学函数；</li>
</ul>
<h3 id="基本计算">基本计算</h3><p><img src="/images/js-math/math1.png" alt="math1"></p>
<h3 id="科学计算">科学计算</h3><p><img src="/images/js-math/math2.png" alt="math2"></p>
<h3 id="实用技巧">实用技巧</h3><ul>
<li>快速得出number数组的最大最小值：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">math</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">6</span>];</span><br><span class="line">	<span class="keyword">var</span> max = <span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">	<span class="keyword">var</span> min = <span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取n-m之间的随机数（包含n和m）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">math</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> num = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*m + n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-array" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/27/js-array/" class="article-date">
  	<time datetime="2015-10-26T16:00:00.000Z" itemprop="datePublished">2015-10-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/27/js-array/">javascript 数组操作总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>数组是javascript中的重要数据结构，可以存储各种数据类型，有很多重要的操作必须牢记；</li>
<li>本文系统总结了javascript数组的各种常见操作，欢迎补充！</li>
</ul>
<h3 id="javascript数组需要掌握的方法">javascript数组需要掌握的方法</h3><ul>
<li>push、pop </li>
<li>shift、unshift </li>
<li>splice、slice </li>
<li>concat、join、sort、reverse</li>
<li>这些方法在下面会详细介绍</li>
</ul>
<h3 id="数组的定义">数组的定义</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法一，定义后赋值</span></span><br><span class="line">var arr = <span class="keyword">new</span> Array();</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">123</span></span><br><span class="line">arr[<span class="number">1</span>] = <span class="string">"abc"</span></span><br><span class="line">arr[<span class="number">5</span>] = <span class="function"><span class="literal">false</span></span><br><span class="line"><span class="title">alert</span><span class="params">(arr[<span class="number">3</span>])</span> <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//方法二，定义数组长度</span></span><br><span class="line">var arr2 </span>= <span class="keyword">new</span> Array(<span class="number">2</span>);</span><br><span class="line">arr2[<span class="number">0</span>] = <span class="string">"ddd"</span>;</span><br><span class="line">arr2[<span class="number">1</span>] = <span class="number">123</span>;</span><br><span class="line">arr2[<span class="number">4</span>] = <span class="literal">false</span>;  <span class="comment">//数组长度自动扩展</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//方法三，定义时赋值</span></span><br><span class="line">var arr3 = <span class="keyword">new</span> Array(<span class="literal">true</span>,<span class="number">123</span>,<span class="string">"aaa"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法四，直接赋值</span></span><br><span class="line">var arr4 = [<span class="string">"aaa"</span>,<span class="number">111</span>,<span class="literal">false</span>];</span><br></pre></td></tr></table></figure>
<h3 id="数组的判断">数组的判断</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.isArray(arr);  <span class="comment">//true</span></span><br><span class="line">arr <span class="keyword">instanceof</span> <span class="built_in">Array</span>;  <span class="comment">//true</span></span><br><span class="line">arr.constructor === <span class="built_in">Array</span>;  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<h3 id="数组元素的合并">数组元素的合并</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'d'</span>];</span><br><span class="line">document.<span class="keyword">write</span>(arr.<span class="keyword">join</span>());  <span class="comment">//c,b,d</span></span><br><span class="line">document.<span class="keyword">write</span>(arr.<span class="keyword">join</span>(<span class="string">"."</span>));  <span class="comment">//c.b.d</span></span><br></pre></td></tr></table></figure>
<h3 id="数组的属性">数组的属性</h3><ul>
<li>length属性</li>
</ul>
<figure class="highlight rsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'d'</span>];</span><br><span class="line">alert(arr.<span class="built_in">length</span>);  <span class="comment">//3</span></span><br><span class="line">arr.<span class="built_in">length</span> = <span class="number">10</span>;  <span class="comment">// 数组自动扩展</span></span><br><span class="line">arr.<span class="built_in">length</span> = <span class="number">2</span>;  <span class="comment">//arr[2]丢失</span></span><br></pre></td></tr></table></figure>
<ul>
<li>prototype属性</li>
</ul>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function <span class="built_in">max</span>()&#123;</span><br><span class="line">	var i,</span><br><span class="line">	<span class="built_in">max</span> = <span class="keyword">this</span>[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;<span class="keyword">this</span>.length; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">max</span>&lt;<span class="keyword">this</span>[i])&#123;</span><br><span class="line">			<span class="built_in">max</span> = <span class="keyword">this</span>[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">Array</span>.prototype.<span class="built_in">max</span> = <span class="built_in">max</span>;</span><br><span class="line">var x = <span class="keyword">new</span> <span class="keyword">Array</span>(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>);</span><br><span class="line">alert(x.<span class="built_in">max</span>());  <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<h3 id="数组常见操作">数组常见操作</h3><ul>
<li>添加元素</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="string">"aaa"</span>,<span class="literal">false</span>];</span><br><span class="line">arr.push(<span class="number">3</span>);  <span class="comment">//添加到末尾</span></span><br><span class="line">arr.unshift(<span class="string">'c'</span>);  <span class="comment">//添加到开头，其余元素后移</span></span><br><span class="line">arr.splice(<span class="number">1</span>,<span class="number">0</span>,<span class="string">'d'</span>);  <span class="comment">//插入到数组下表为1的位置，并且有0个元素被吃掉</span></span><br></pre></td></tr></table></figure>
<ul>
<li>删除元素</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="string">"aaa"</span>,<span class="literal">false</span>];</span><br><span class="line">arr.pop();  <span class="comment">//移除最后一个元素</span></span><br><span class="line">arr.shift();  <span class="comment">//移除最前面的元素并返回该元素的值</span></span><br><span class="line">arr.splice(<span class="number">1</span>,<span class="number">1</span>);  <span class="comment">//移除下标为1开始的1个元素</span></span><br><span class="line"><span class="keyword">delete</span> arr[<span class="number">2</span>];  <span class="comment">//移除下标为2的元素</span></span><br></pre></td></tr></table></figure>
<ul>
<li>移除特定元素</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>];</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">index</span> = null;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>; i&lt;arr.length; i++)<span class="comment">&#123;</span><br><span class="line">	if(arr[i]=='c')&#123;</span><br><span class="line">		index = i;</span><br><span class="line">	&#125;</span></span><br><span class="line">&#125;</span><br><span class="line">arr.splice(<span class="keyword">index</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>截取数组</li>
</ul>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="atom">var</span> <span class="atom">arr</span> = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>];</span><br><span class="line"><span class="atom">arr</span>.<span class="atom">slice</span>(<span class="number">1</span>,<span class="number">3</span>);  // [<span class="string">'b'</span>,<span class="string">'c'</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>连接数组</li>
</ul>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="atom">var</span> <span class="atom">arr</span> = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>];</span><br><span class="line"><span class="atom">var</span> <span class="atom">arr2</span> = [<span class="string">'f'</span>,<span class="string">'g'</span>];</span><br><span class="line"><span class="atom">arr</span>.<span class="atom">concat</span>(<span class="atom">arr2</span>);  // [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>拷贝数组</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.<span class="keyword">concat</span>();</span><br></pre></td></tr></table></figure>
<ul>
<li>数组排序</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'e'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>];</span><br><span class="line">alert(arr.sort());  <span class="comment">// a b c d e</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数组倒序</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'e'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>];</span><br><span class="line">alert(arr.<span class="keyword">reverse</span>());  <span class="comment">// e d c b a</span></span><br></pre></td></tr></table></figure>
<ul>
<li>判断数组是否包含特定值</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'e'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>];</span><br><span class="line">alert(arr.indexOf(<span class="string">'d'</span>));  <span class="comment">// 3</span></span><br><span class="line">alert(arr.indexOf(<span class="string">'g'</span>));  <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>求number数组最大最小值</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">math</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">var</span> max = <span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">    <span class="keyword">var</span> min = <span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组去重">数组去重</h3><ul>
<li>方法一：<ul>
<li>利用数组的indexOf方法</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr) &#123;</span><br><span class="line"> <span class="keyword">var</span> <span class="literal">result</span> = []; </span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++)</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="literal">result</span>.indexOf(arr[i]) == -<span class="number">1</span>) <span class="literal">result</span>.push(arr[i]);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法二：<ul>
<li>利用hash表</li>
<li>可能会出现字符串和数字一样的话出错，如var a = [1, 2, 3, 4, ‘3’, 5],会返回[1, 2, 3, 4, 5]</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> hash = &#123;&#125;,<span class="literal">result</span> = []; </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++)</span><br><span class="line">  &#123;</span><br><span class="line">     <span class="keyword">if</span> (!hash[arr[i]]) </span><br><span class="line">     &#123;</span><br><span class="line">         hash[arr[i]] = <span class="literal">true</span>; </span><br><span class="line">         <span class="literal">result</span>.push(arr[i]); </span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法三：<ul>
<li>排序后比较相邻，如果一样则放弃，否则加入到result</li>
<li>会出现与方法2一样的问题，如果数组中存在1,1,’1’这样的情况，则会排错</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr) &#123;</span><br><span class="line">  arr.sort();</span><br><span class="line">  <span class="keyword">var</span> <span class="literal">result</span>=[arr[<span class="number">0</span>]];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line">      <span class="keyword">if</span>( arr[i] !== arr[i-<span class="number">1</span>]) &#123;</span><br><span class="line">          <span class="literal">result</span>.push(arr[i]);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法四：<ul>
<li>最简单但是效率最低的算法,也不会出现方法2和方法3出现的bug</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr) &#123;</span><br><span class="line">  <span class="keyword">if</span>(arr.length == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="literal">result</span> = [arr[<span class="number">0</span>]], isRepeate;</span><br><span class="line">  <span class="keyword">for</span>( <span class="keyword">var</span> i = <span class="number">0</span>, j = arr.length; i &lt; j; i++ )&#123;</span><br><span class="line">    isRepeate = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>, h = <span class="literal">result</span>.length; k &lt; h; k++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">result</span>[k] === arr[i])&#123;</span><br><span class="line">            isRepeate = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k == h) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( !isRepeate ) <span class="literal">result</span>.push(arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组随机扰乱">数组随机扰乱</h3><ul>
<li>方法一：<ul>
<li>每次随机抽一个数并移动到新数组中</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">shuffle</span><span class="params">(<span class="built_in">array</span>)</span> </span>&#123;</span><br><span class="line">  var copy = [],</span><br><span class="line">       n = <span class="built_in">array</span>.length,</span><br><span class="line">       i;</span><br><span class="line">  <span class="comment">// 如果还剩有元素则继续。。。</span></span><br><span class="line">  <span class="keyword">while</span> (n) &#123;</span><br><span class="line">     <span class="comment">// 随机抽取一个元素</span></span><br><span class="line">     i = Math.<span class="built_in">floor</span>(Math.random() * <span class="built_in">array</span>.length);</span><br><span class="line">     <span class="comment">// 如果这个元素之前没有被选中过。。</span></span><br><span class="line">     <span class="keyword">if</span> (i in <span class="built_in">array</span>) &#123;</span><br><span class="line">        copy.push(<span class="built_in">array</span>[i]);</span><br><span class="line">        <span class="keyword">delete</span> <span class="built_in">array</span>[i];</span><br><span class="line">        n--;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法二：<ul>
<li>跟方法1类似，只不过通过splice来去掉原数组已选项</li>
</ul>
</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function shuffle(array) &#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="keyword">copy</span> = [],</span><br><span class="line">       <span class="keyword">n</span> = array.length,</span><br><span class="line">       i;</span><br><span class="line">  <span class="comment">// 如果还剩有元素。。</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="keyword">n</span>) &#123;</span><br><span class="line">     <span class="comment">// 随机选取一个元素</span></span><br><span class="line">     i = Math.<span class="literal">floor</span>(Math.random() * <span class="keyword">n</span>--);</span><br><span class="line">     <span class="comment">// 移动到新数组中</span></span><br><span class="line">     <span class="keyword">copy</span>.push(array.splice(i, 1)[0]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">copy</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法三：<ul>
<li>前面随机抽数依次跟末尾的数交换，后面依次前移</li>
<li>即：第一次前n个数随机抽一个跟第n个交换，第二次前n-1个数跟第n-1个交换，依次类推</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shuffle</span><span class="params">(array)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> m = <span class="keyword">array</span>.length,</span><br><span class="line">     t, i;</span><br><span class="line">  <span class="comment">// 如果还剩有元素…</span></span><br><span class="line">  <span class="keyword">while</span> (m) &#123;</span><br><span class="line">    <span class="comment">// 随机选取一个元素…</span></span><br><span class="line">    i = Math.floor(Math.random() * m--);</span><br><span class="line">    <span class="comment">// 与当前元素进行交换</span></span><br><span class="line">    t = <span class="keyword">array</span>[m];</span><br><span class="line">    <span class="keyword">array</span>[m] = <span class="keyword">array</span>[i];</span><br><span class="line">    <span class="keyword">array</span>[i] = t;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">array</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组间操作">数组间操作</h3><ul>
<li>数组求交集</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用filter和数组自带的indexOf方法</span></span><br><span class="line">array1.filter(<span class="function"><span class="keyword">function</span><span class="params">(n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array2.indexOf(n) != -<span class="number">1</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>数组求并集</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法原理：连接两个数组并去重</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arrayUnique</span><span class="params">(<span class="keyword">array</span>)</span> <span class="comment">&#123;</span><br><span class="line">  var a = array.concat();</span><br><span class="line">  for(var i=0; i&lt;a.length; ++i) &#123;</span><br><span class="line">    for(var j=i+1; j&lt;a.length; ++j) &#123;</span><br><span class="line">       if(a[i] === a[j])</span><br><span class="line">          a.splice(j--, 1);</span><br><span class="line">    &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title">return</span> <span class="title">a</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>数组求差集</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用filter和indexOf方法</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.diff = <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.filter(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;<span class="keyword">return</span> a.indexOf(i) &lt; <span class="number">0</span>;&#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-function" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/26/js-function/" class="article-date">
  	<time datetime="2015-10-25T16:00:00.000Z" itemprop="datePublished">2015-10-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/26/js-function/">javascript 函数解析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>javascript中，函数是重要的机制，可以避免页面载入时执行该脚本，这些代码只能被事件激活，或者在函数被调用时才会执行；</li>
<li>本文总结了javascript函数的定义和调用方法，以供参考；</li>
</ul>
<h3 id="javascript函数的定义">javascript函数的定义</h3><ul>
<li>直接定义函数：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;   </span><br><span class="line">	alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过函数字面量定义</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span><span class="params">(x)</span></span>&#123;  </span><br><span class="line">    alert(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过构造函数定义：</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> func2 = <span class="keyword">new</span> <span class="function"><span class="keyword">Function</span><span class="params">(x,alert<span class="params">(x)</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="javascript函数的调用">javascript函数的调用</h3><ul>
<li>直接通过函数名调用：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;   </span><br><span class="line">    alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();          </span><br><span class="line"><span class="built_in">window</span>.onload = test();</span><br></pre></td></tr></table></figure>
<ul>
<li>通过变量调用：</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function test()&#123;   </span><br><span class="line">    alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable"><span class="keyword">var</span> fun</span> = test;  </span><br><span class="line"><span class="function"><span class="title">fun</span><span class="params">()</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>下面两种方法可让函数自动执行</li>
</ul>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">(<span class="keyword">function</span> test<span class="list">()</span><span class="collection">&#123;   </span><br><span class="line">    alert<span class="list">(<span class="string">"..."</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span>)</span><span class="list">()</span></span><br><span class="line"></span><br><span class="line"><span class="list">(<span class="keyword">function</span> test<span class="list">()</span><span class="collection">&#123;   </span><br><span class="line">    alert<span class="list">(<span class="string">"..."</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span><span class="list">()</span>)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>下面的代码会发生错误，请注意括号</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;   <span class="comment">//error</span></span><br><span class="line">	alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-Closure" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/26/js-Closure/" class="article-date">
  	<time datetime="2015-10-25T16:00:00.000Z" itemprop="datePublished">2015-10-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/26/js-Closure/">JavaScript 闭包详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="js变量作用域">js变量作用域</h3><ul>
<li>变量的作用域无非就是两种：全局变量和局部变量；</li>
<li>Javascript语言的特殊之处，就在于函数内部可以直接读取全局变量：</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> n=<span class="number">999</span>;</span><br><span class="line">　　<span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">()</span><span class="comment">&#123;</span><br><span class="line">　　　　alert(n);</span><br><span class="line">　　&#125;</span></span><br><span class="line"><span class="title">f1</span><span class="params">()</span>;</span> <span class="comment">// 999</span></span><br></pre></td></tr></table></figure>
<ul>
<li>但是，在函数外部自然无法读取函数内的局部变量：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">()</span></span>&#123;</span><br><span class="line">　　　　<span class="keyword">var</span> n=<span class="number">999</span>;</span><br><span class="line">　　&#125;</span><br><span class="line">alert(n); <span class="comment">// error</span></span><br></pre></td></tr></table></figure>
<ul>
<li>除非不用var声明：</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">()</span><span class="comment">&#123;</span><br><span class="line">　　　　n=999;</span><br><span class="line">　　&#125;</span></span><br><span class="line">　　<span class="title">f1</span><span class="params">()</span>;</span></span><br><span class="line">alert(n); <span class="comment">// 999</span></span><br></pre></td></tr></table></figure>
<ul>
<li>总之，js中作用域是链式的，内部可获取外部变量，反之不行；</li>
<li>如果函数f2就被包括在函数f1内部，这时f1内部的所有局部变量，对f2都是可见的，但是反过来就不行，f2内部的局部变量，对f1就是不可见的；</li>
<li>既然f2可以读取f1中的局部变量，那么只要把f2作为返回值，我们不就可以在f1外部读取它的内部变量了吗；</li>
<li>这种打破常规，实现在函数外部访问函数私有变量的机制叫做闭包；</li>
</ul>
<h3 id="js什么时候进行垃圾回收？">js什么时候进行垃圾回收？</h3><ul>
<li>在javascript中，如果一个对象不再被引用，那么这个对象就会被GC回收；</li>
<li>如果两个对象互相引用，而不再被第3者所引用，那么这两个互相引用的对象也会被回收；</li>
</ul>
<h3 id="闭包（Closure）的定义">闭包（Closure）的定义</h3><ul>
<li>闭包就是能够读取其他函数内部变量的函数；</li>
<li>由于在Javascript语言中，只有函数内部的子函数才能读取局部变量，因此可以把闭包简单理解成”定义在一个函数内部的函数”；</li>
<li>在本质上，闭包就是将函数内部和函数外部连接起来的一座桥梁；</li>
</ul>
<h3 id="闭包的深入理解">闭包的深入理解</h3><p>看下面程序：</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">　　　　<span class="keyword">var</span> n=<span class="number">999</span>;</span><br><span class="line">　　　　nAdd=function()&#123;n+=<span class="number">1</span>&#125;</span><br><span class="line">　　　　function f2()&#123;</span><br><span class="line">　　　　　　alert(n);</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　　　<span class="keyword">return</span> f2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> <span class="literal">result</span>=f1();</span><br><span class="line"><span class="literal">result</span>(); // <span class="number">999</span></span><br><span class="line">nAdd();</span><br><span class="line"><span class="literal">result</span>(); // <span class="number">1000</span></span><br></pre></td></tr></table></figure>
<ul>
<li>result实际上就是闭包f2函数，它一共运行了两次，第一次的值是999，第二次的值是1000，这证明了，函数f1中的局部变量n一直保存在内存中，并没有在f1调用后被自动清除；</li>
<li>原因就在于f1是f2的父函数，而f2被赋给了一个全局变量，这导致f2始终在内存中（不满足上面任何一条垃圾回收条件），而f2的存在依赖于f1，因此f1也始终在内存中（不满足上面任何一条垃圾回收条件），不会在调用结束后被垃圾回收机制（garbage collection）回收；</li>
<li>这段代码中另一个值得注意的地方，就是”nAdd=function(){n+=1}”这一行；<ul>
<li>首先在nAdd前面没有使用var关键字，因此nAdd是一个全局变量，而不是局部变量；</li>
<li>其次，nAdd的值是一个匿名函数（anonymous function），而这个匿名函数本身也是一个闭包，所以nAdd相当于是一个setter，可以在函数外部对函数内部的局部变量进行操作；</li>
</ul>
</li>
</ul>
<h3 id="使用闭包需要注意">使用闭包需要注意</h3><ul>
<li>由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露,解决方法是，在退出函数之前，将不使用的局部变量全部删除；</li>
<li>闭包会在父函数外部，改变父函数内部变量的值，所以如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值；</li>
</ul>
<hr>
<p>本文参考：<a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="external">学习Javascript闭包（Closure）</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-this" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/25/js-this/" class="article-date">
  	<time datetime="2015-10-24T16:00:00.000Z" itemprop="datePublished">2015-10-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/25/js-this/">JavaScript中this关键字详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>js中，this关键是令人头疼的问题，它的指代对象和this所处的上下文环境、函数调用者等多重因素有关；</li>
<li>我们要解决的问题是，this关键字代指哪个对象；</li>
<li>本文用丰富的实例让您清晰、明确的判断各种情况下，this关键字所指代的对象；</li>
</ul>
<h3 id="判断原则：">判断原则：</h3><ul>
<li>原则一：this指的是直接调用函数的那个对象，没有的话就值window；</li>
<li>原则二：this代指的对象就是它使用的时候（不是定义的时候）所处的环境的上下文；</li>
<li>原则三：当new关键字出现时，this指代new出来的那个对象；</li>
<li>this是js关键字，某些程序中出现的that仅仅是普通的变量，不是关键字；</li>
<li>下面，我们用实例说话，一一验证上述原则；</li>
</ul>
<h3 id="无对象调用函数时this指代window的例子">无对象调用函数时this指代window的例子</h3><ul>
<li>例一：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</span><br><span class="line">    alert(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line">test();  <span class="comment">//1</span></span><br><span class="line">alert(x);  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例二：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line">test();  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例三：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">test();  </span><br><span class="line">alert(x); <span class="comment">//0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例四：</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = 0;</span><br><span class="line">function <span class="keyword">test</span>()&#123;</span><br><span class="line">    alert(this.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line">o.x = 1;</span><br><span class="line">o.<span class="keyword">m</span> = <span class="keyword">test</span>;</span><br><span class="line">o.<span class="keyword">m</span>.apply();  <span class="comment">//0  apply参数为空时，默认调用全局对象，故this指向window</span></span><br><span class="line">o.<span class="keyword">m</span>.apply(o);  <span class="comment">//1  test函数的调用者是o，故this指代对象o</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例五：<ul>
<li>执行第一个this时，function调用者为obj，故this指代obj对象；</li>
<li>执行f函数和匿名函数时，函数没有直接的调用者，故this指代window；</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> context = <span class="string">"global"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> obj = &#123;  </span><br><span class="line">    context: <span class="string">"object"</span>,</span><br><span class="line">    method: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);  <span class="comment">// [object Object]:object</span></span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> context = <span class="string">"function"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);   <span class="comment">// [object Window]:global</span></span><br><span class="line">        &#125;;</span><br><span class="line">        f(); </span><br><span class="line"> </span><br><span class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> context = <span class="string">"function"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);  <span class="comment">// [object Window]:global</span></span><br><span class="line">        &#125;)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">obj.method();</span><br></pre></td></tr></table></figure>
<h3 id="有对象调用函数时this指代调用函数者的例子">有对象调用函数时this指代调用函数者的例子</h3><ul>
<li>例一:<ul>
<li>o调用了test函数，故this指代对象o</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line">o.x = <span class="number">1</span>;</span><br><span class="line">o.m = test;</span><br><span class="line">o.m();  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例二：<ul>
<li>getInfo()函数的调用者是ext1，this指代ext1；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this1.png" alt="this1"></p>
<ul>
<li>例三：<ul>
<li>getInfo()函数的调用者是ext1，this指代ext1；</li>
<li>this.id和this.name都是代指ext1对象的id和name，但是由于ext1对象本身没有name属性，所以需要到原型链上查找name属性；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this2.png" alt="this2"></p>
<ul>
<li>例四：<ul>
<li>内层的funcion中包含了this，但是，内层function没有直接调用者；</li>
<li>故这里的this指window；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this3.png" alt="this3"></p>
<ul>
<li>例五：<ul>
<li>object对象调用了外层函数，所以var that = this中的this指代object对象，执行完此句后，that也指代object对象；</li>
<li>that并不是js的关键字，仅仅是一个普通的变量，所以下面return that.name的时候，返回的是object.name；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this4.png" alt="this4"></p>
<ul>
<li>例六：<ul>
<li>object对象直接调用了外层的function，故var that = this中的this指代object对象，执行完此句后，that也指代object对象；</li>
<li>内层function没有直接调用者，故内层函数中的this指代window；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this5.png" alt="this5"></p>
<ul>
<li>例七：<ul>
<li>point对象调用moveTo方法，故this指代point对象；</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var point = &#123; </span><br><span class="line"> x : <span class="number">0</span>, </span><br><span class="line"> y : <span class="number">0</span>, </span><br><span class="line"> moveTo : function(x, y) &#123; </span><br><span class="line">     <span class="keyword">this</span>.x = <span class="keyword">this</span>.x + x; </span><br><span class="line">     <span class="keyword">this</span>.y = <span class="keyword">this</span>.y + y; </span><br><span class="line">     &#125; </span><br><span class="line"> &#125;;</span><br><span class="line">point.moveTo(<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line">console.<span class="built_in">log</span>(point.x);  <span class="comment">//1</span></span><br><span class="line">console.<span class="built_in">log</span>(point.y);  <span class="comment">//1</span></span><br><span class="line">console.<span class="built_in">log</span>(x);  <span class="comment">//x is not defined</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例八：<ul>
<li>moveX和moveY函数没有调用者，所以其中的this指代window，而不是point对象；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = &#123; </span><br><span class="line"> x : <span class="number">0</span>, </span><br><span class="line"> y : <span class="number">0</span>, </span><br><span class="line"> moveTo : <span class="function"><span class="keyword">function</span><span class="params">(x, y)</span> </span>&#123; </span><br><span class="line">     <span class="keyword">var</span> moveX = <span class="function"><span class="keyword">function</span><span class="params">(x)</span> </span>&#123; </span><br><span class="line">         <span class="keyword">this</span>.x = x;</span><br><span class="line">     &#125;; </span><br><span class="line"></span><br><span class="line">     <span class="keyword">var</span> moveY = <span class="function"><span class="keyword">function</span><span class="params">(y)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">     &#125;; </span><br><span class="line">    </span><br><span class="line">     moveX(x); </span><br><span class="line">     moveY(y); </span><br><span class="line">    &#125; </span><br><span class="line"> &#125;; </span><br><span class="line"> point.moveTo(<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line"> point.x; <span class="comment">//=&gt;0 </span></span><br><span class="line"> point.y; <span class="comment">//=&gt;0 </span></span><br><span class="line"> x; <span class="comment">//=&gt;1 </span></span><br><span class="line"> y; <span class="comment">//=&gt;1</span></span><br></pre></td></tr></table></figure>
<h3 id="this指代new出来的那个对象">this指代new出来的那个对象</h3><ul>
<li>例一：<ul>
<li>由于存在new关键字，this指代的对象是new出来的对象，即对象o；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> test();</span><br><span class="line">alert(o.x);  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例二：<ul>
<li>this指代对象o，而不是window；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">2</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> test();</span><br><span class="line">alert(x);  <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例三：<ul>
<li>np对象是new出来的，所以this指代np对象；</li>
<li>p对象不是new出来的，且Point函数无调用者，故this指代window；</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params">x,y</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">this</span>.x = x; </span><br><span class="line">    <span class="keyword">this</span>.y = y; </span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">var</span> np=<span class="keyword">new</span> Point(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">np.x;  <span class="comment">//1</span></span><br><span class="line"><span class="keyword">var</span> p=Point(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">p.x;  <span class="comment">//error, p是一个空对象undefined</span></span><br><span class="line"><span class="built_in">window</span>.x;  <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例四：<ul>
<li>apply使得Point函数的调用者为p2，故this指代p2对象；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span><span class="params">(x, y)</span></span>&#123; </span><br><span class="line">    <span class="keyword">this</span>.x = x; </span><br><span class="line">    <span class="keyword">this</span>.y = y; </span><br><span class="line">    <span class="keyword">this</span>.moveTo = <span class="function"><span class="keyword">function</span><span class="params">(x, y)</span></span>&#123; </span><br><span class="line">        <span class="keyword">this</span>.x = x; </span><br><span class="line">        <span class="keyword">this</span>.y = y; </span><br><span class="line">    &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Point(<span class="number">0</span>, <span class="number">0</span>); </span><br><span class="line"><span class="keyword">var</span> p2 = &#123;x: <span class="number">0</span>, y: <span class="number">0</span>&#125;; </span><br><span class="line">p1.moveTo.apply(p2, [<span class="number">10</span>, <span class="number">10</span>]);  <span class="comment">//apply实际上为p2.moveTo(10,10)</span></span><br><span class="line">p2.x;   <span class="comment">//10</span></span><br></pre></td></tr></table></figure>
<h3 id="bind/call/apply重定向this关键字指向">bind/call/apply重定向this关键字指向</h3><ul>
<li>例一：<ul>
<li>apply和call将函数的调用者转变了，所以this指代的对象随之转变；</li>
<li>bind创建一个新的函数，这个函数中的this对象指代的内容也由bind函数指定；</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">add</span><span class="params">(numA, numB)</span></span>&#123;</span><br><span class="line">  console.<span class="built_in">log</span>( <span class="keyword">this</span>.original + numA + numB);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// NaN</span></span><br><span class="line"> </span><br><span class="line">var obj = &#123;original: <span class="number">10</span>&#125;;</span><br><span class="line">add.apply(obj, [<span class="number">1</span>, <span class="number">2</span>]);  <span class="comment">// 13</span></span><br><span class="line">add.call(obj, <span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// 13</span></span><br><span class="line"> </span><br><span class="line">var f1 = add.bind(obj);</span><br><span class="line">f1(<span class="number">2</span>, <span class="number">3</span>);  <span class="comment">// 15</span></span><br><span class="line"> </span><br><span class="line">var f2 = add.bind(obj, <span class="number">2</span>);</span><br><span class="line">f2(<span class="number">3</span>);  <span class="comment">// 15</span></span><br></pre></td></tr></table></figure>
<h3 id="js事件中的this指代">js事件中的this指代</h3><ul>
<li>例一：<ul>
<li>前面的一个，console调用者是button对象，故this指代button对象；</li>
<li>中间的一个，匿名函数没有直接调用者，所以this指代window；</li>
<li>第三个，通过bind重定向函数中的this指向，所以this代表button对象；</li>
</ul>
</li>
</ul>
<figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="transposed_variable">document.</span>write(<span class="string">'&lt;button onclick="</span><span class="transposed_variable">console.</span>log(this)<span class="string">"&gt;Show this&lt;/button&gt;'</span>);</span><br><span class="line"><span class="comment">// &lt;button onclick="console.log(this)"&gt;Show this&lt;/button&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="transposed_variable">document.</span>write(<span class="string">'&lt;button onclick="</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(this)</span>;&#125;)<span class="params">()</span>"&gt;<span class="title">Show</span> <span class="title">this</span>&lt;/<span class="title">button</span>&gt;');</span></span><br><span class="line"><span class="comment">// window</span></span><br><span class="line"></span><br><span class="line"><span class="transposed_variable">document.</span>write(<span class="string">'&lt;button onclick="</span>((<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(this)</span>;&#125;).<span class="title">bind</span><span class="params">(this)</span>)<span class="params">()</span>"&gt;<span class="title">Show</span> <span class="title">this</span>&lt;/<span class="title">button</span>&gt;');</span></span><br><span class="line"><span class="comment">// &lt;button onclick="((function()&#123;console.log(this);&#125;).bind(this))()"&gt;Show this&lt;/button&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>其他的js事件中的this关键字指代请参考<a href="http://mp.weixin.qq.com/s?__biz=MzAxODE2MjM1MA==&amp;mid=400742840&amp;idx=1&amp;sn=c2c389f831c29fd98c54297bc6a3b9e8&amp;3rd=MzA3MDU4NTYzMw==&amp;scene=6#rd" target="_blank" rel="external">这里</a>；</li>
</ul>
<h3 id="this关键字指代对象的暂存方法">this关键字指代对象的暂存方法</h3><ul>
<li>说明：<ul>
<li>有些时候希望在this指代正确的对象的时候将this指代的对象暂存起来，备用；</li>
</ul>
</li>
<li>例一：<ul>
<li>下面程序将this指代的bar对象暂存到self对象中；</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;</span><br><span class="line">    name: <span class="string">"bar"</span>,</span><br><span class="line">    body: <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>],</span><br><span class="line"> </span><br><span class="line">    greeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hi there, I'm "</span> + <span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;,</span><br><span class="line"> </span><br><span class="line">    anotherMethod: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">this</span>.body.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            self.greeting();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">bar.anotherMethod();   <span class="comment">// Hi there, I'm [object Object]:bar</span></span><br></pre></td></tr></table></figure>
<ul>
<li>上面的程序也可以用bind实现：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;</span><br><span class="line">    name: <span class="string">"bar"</span>,</span><br><span class="line">    body: <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>],</span><br><span class="line"> </span><br><span class="line">    greeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hi there, I'm "</span> + <span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;,</span><br><span class="line"> </span><br><span class="line">    anotherMethod: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.body.addEventListener(<span class="string">"click"</span>, (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.greeting();</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">bar.anotherMethod();   <span class="comment">// Hi there, I'm [object Object]:bar</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-node-js-config" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/24/node-js-config/" class="article-date">
  	<time datetime="2015-10-23T16:00:00.000Z" itemprop="datePublished">2015-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/24/node-js-config/">node.js开发环境配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是node-js">什么是node.js</h3><ul>
<li>维基百科的介绍：Node.js是谷歌V8引擎、libuv平台抽象层以及主体使用Javscript编写的核心库三者集合的一个包装外壳；</li>
<li>node.js在国内外的使用情况：<ul>
<li>linkedin移动版正在向node.js迁移；</li>
<li>twitter的消息队列用node.js实现；</li>
<li>知乎、网易的推送信息用node.js实现；</li>
<li>阿里的云计算平台也要部分向node.js迁移；</li>
<li>…..</li>
</ul>
</li>
<li>上面的介绍听起来很抽象，其实，node.js就是一个能够在服务器端运行javascript的框架，实现了众多web开发者在server端使用javascript开发的梦想；</li>
<li>node.js有很多优势，比如：<ul>
<li>模块化；</li>
<li>client和server双向实时通信；</li>
<li>高并发（单线程处理多个请求）；</li>
<li>IO非阻塞（一件事情正在完成时可以去干另一件事）；</li>
</ul>
</li>
<li>node.js的<a href="http://blog.jobbole.com/53736/" target="_blank" rel="external">这些优势</a>，使得它的应用场景十分广泛：<ul>
<li>聊天；</li>
<li>队列输入；</li>
<li>推送信息；</li>
<li>数据流传输；</li>
<li>代理；</li>
<li>只要是符合“计算简单、高并发、需要client和server双向通信”的业务模型都可以用！</li>
</ul>
</li>
<li>本文重点介绍了node.js在windows下的开发环境搭建；</li>
</ul>
<h3 id="node-js开发环境配置">node.js开发环境配置</h3><ul>
<li>node.js开发环境需要配置如下内容：<ul>
<li>在windows上安装Sublime和Webstorm；</li>
<li>在windows上安装VirtualBox和Centos虚拟机；</li>
<li>在windows上安装xShell和xFtp，方便在本机和虚拟机之间传送消息或文件；</li>
<li>在虚拟机上安装Redis和MongoDB；</li>
</ul>
</li>
<li>下面会一一讲解这些步骤；</li>
</ul>
<h3 id="VirtualBox的安装">VirtualBox的安装</h3><ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">下载VirtualBox</a></li>
<li>直接双击安装即可；</li>
</ul>
<h3 id="在VirtualBox中创建虚拟机">在VirtualBox中创建虚拟机</h3><ul>
<li>内存分配1024M；</li>
<li>磁盘种类选择默认种类；</li>
<li>安装CentOs basic web server版本，同时安装development tolls；</li>
<li>CentOs7的iso镜像文件可从网上下载，添加到虚拟机配置中；</li>
<li>如果你所在的局域网路由器DHCP功能启用了，就设置网卡为桥接网卡，系统会自动分配IP地址；</li>
<li>如果你所在的局域网路由器DHCP功能禁用了，就设置网卡为NAT模式，需要进一步进行端口映射的配置（下面会将具体配置方法）；</li>
<li>安装完reboot虚拟机；</li>
</ul>
<h3 id="虚拟机的配置">虚拟机的配置</h3><ul>
<li>网卡自启动的配置：<ul>
<li>进入下列配置文件，并将最后一行ONBOOT设置为yes；</li>
</ul>
</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>sysconfig<span class="regexp">/network-scripts/i</span>fcfg-enp0s3</span><br></pre></td></tr></table></figure>
<ul>
<li>如果你所在的局域网路由器DHCP功能启用了，此时就可通过<code>ifconfig</code>命令查询到ipv4地址，记下这个地址（当然你可以将它和它对应的域名配置到host文件中）；</li>
<li>如果你所在的局域网路由器DHCP功能禁用了，此时就将虚拟机网卡配置改为NAT网络模式，点击“端口转发按钮”，按照下图方式配置端口映射，这个设置的意思是，只要是访问本机（127.0.0.1）5905端口的消息全部转发给ip为10.0.2.15（这个ip是在虚拟机上运行<code>ifconfig</code>得到的，这是虚拟机在NAT模式下自行分配的ip）的22端口（SSH专用端口为22）；</li>
</ul>
<p><img src="/images/port-map.png" alt="port-map"></p>
<ul>
<li>安装epel：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="operator"><span class="keyword">install</span> epel-<span class="keyword">release</span></span></span><br></pre></td></tr></table></figure>
<h3 id="xShell和xFtp安装">xShell和xFtp安装</h3><ul>
<li>介绍：<ul>
<li>xShell是一款在windows上连接远程终端的软件，类似于SecureCRT，这里我们用它来连接本机上的虚拟机；</li>
<li>xFtp用来在windows PC和linux终端间传输文件，这里我们用xFtp来实现本机和上面CentOs之间的文件传输；</li>
</ul>
</li>
<li>xShell安装：<ul>
<li>下载地址（需先注册获取下载链接）：<a href="https://www.netsarang.com/xshell_download.html；" target="_blank" rel="external">https://www.netsarang.com/xshell_download.html；</a></li>
<li>下载后双击安装即可；</li>
</ul>
</li>
<li>xFtp安装：<ul>
<li>下载地址（需先注册获取下载链接）：<a href="https://www.netsarang.com/download/down_xfp.html；" target="_blank" rel="external">https://www.netsarang.com/download/down_xfp.html；</a></li>
<li>下载后双击安装即可；</li>
</ul>
</li>
<li>xShell连接虚拟机：<ul>
<li>如果你所在的局域网路由器DHCP功能启用了，直接连接虚拟机的ipv4地址（通过<code>ifconfig</code>命令查询到），端口22；</li>
<li>如果你所在的局域网路由器DHCP功能禁用了，此时连接127.0.0.1，端口5905，系统会自动根据上面的配置将数据映射到虚拟机；</li>
<li>连接成功后，输入用户名密码即可登录虚拟机；</li>
</ul>
</li>
</ul>
<h3 id="在虚拟机上安装相应软件">在虚拟机上安装相应软件</h3><ul>
<li>安装Nodejs<ul>
<li>安装<code>yum install nodejs</code></li>
<li>查看是否正常安装<code>node --version</code></li>
</ul>
</li>
<li>安装MongoDB<ul>
<li>安装<code>yum install mongodb-server</code>（mongodb服务器端）<code>yum install mongodb</code>（mongodb客户端）</li>
<li>查看是否正常安装<code>mongo --version</code></li>
</ul>
</li>
<li>安装redis<ul>
<li>安装<code>yum install redis</code></li>
<li>查看是否正常安装<code>redis-cli --version</code></li>
</ul>
</li>
</ul>
<h3 id="在windows安装相应软件">在windows安装相应软件</h3><ul>
<li>应当安装下列IDE或编辑器，不再赘述：<ul>
<li>sublime text；</li>
<li>WebStorm；</li>
</ul>
</li>
</ul>
<h3 id="第一个node程序">第一个node程序</h3><ul>
<li>在虚拟机上新建文件<code>test.js</code>，内容为：</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.<span class="function"><span class="title">log</span><span class="params">(<span class="string">"hello world!"</span>)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>在node运行这个文件<code>node test.js</code></li>
<li>执行结果为<code>hello world!</code>，终于实现了在server端运行javascript的梦想！</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2015-10-3-js-map" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/03/2015-10-3-js-map/" class="article-date">
  	<time datetime="2015-10-02T16:00:00.000Z" itemprop="datePublished">2015-10-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/03/2015-10-3-js-map/">javascript map的实现</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>在java语言中，map是一种重要的数据结构；</li>
<li>在js中，没有现成的map实现；</li>
<li>本文就带您来实现js中的map；</li>
</ul>
<h3 id="map的具体实现">map的具体实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Map</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.keys = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line">	<span class="keyword">this</span>.data = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.put = <span class="function"><span class="keyword">function</span>(<span class="params">key,value</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.data[key]==<span class="literal">null</span>)&#123;</span><br><span class="line">			<span class="keyword">this</span>.keys.push(key);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">this</span>.data[key] = value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.get = <span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.data[key];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.remove = <span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> index = <span class="keyword">this</span>.keys.indexOf(key);</span><br><span class="line">		<span class="keyword">this</span>.keys.splice(index,<span class="number">1</span>);   </span><br><span class="line">		<span class="keyword">this</span>.data[key] = <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.containsKey = <span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.keys.indexOf(key)!= -<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.keys.length;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.entrySet = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">		<span class="keyword">var</span> len = <span class="keyword">this</span>.keys.length; </span><br><span class="line">		<span class="keyword">var</span> entrys = <span class="keyword">new</span> <span class="built_in">Array</span>(len);     </span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;     </span><br><span class="line">			entrys[i] = &#123;     </span><br><span class="line">				key : <span class="keyword">this</span>.keys[i],     </span><br><span class="line">				value : <span class="keyword">this</span>.data[<span class="keyword">this</span>.keys[i]]     </span><br><span class="line">			&#125;;     </span><br><span class="line">		&#125;     </span><br><span class="line">		<span class="keyword">return</span> entrys;   </span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.keys.length == <span class="number">0</span>;     </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="自定义map的使用">自定义map的使用</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义map</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">map</span> = <span class="built_in">new</span> Map();</span><br><span class="line"><span class="keyword">map</span>.put(<span class="string">"name"</span>,<span class="string">"xiaozhang"</span>);</span><br><span class="line"><span class="keyword">map</span>.put(<span class="string">"age"</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">map</span>.put(<span class="string">"home"</span>,<span class="string">"beijing"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历map</span></span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">map</span>.entrySet();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>; i&lt;arr.length; i++)&#123;</span><br><span class="line">	document.write(arr[i].key+<span class="string">":"</span>+arr[i].value+<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取 移除元素</span></span><br><span class="line"><span class="keyword">map</span>.get(<span class="string">"name"</span>);  <span class="comment">// xiaozhang</span></span><br><span class="line"><span class="keyword">map</span>.remove(<span class="string">"home"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//其他方法</span></span><br><span class="line"><span class="keyword">map</span>.containsKey(<span class="string">"name"</span>);  <span class="comment">// true</span></span><br><span class="line"><span class="keyword">map</span>.size();  <span class="comment">// 2</span></span><br><span class="line"><span class="keyword">map</span>.isEmpty();  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2015-10-2-js-event" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/02/2015-10-2-js-event/" class="article-date">
  	<time datetime="2015-10-01T16:00:00.000Z" itemprop="datePublished">2015-10-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/02/2015-10-2-js-event/">javascript 事件详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>javascript事件是用户在访问页面时执行的操作，事件处理程序用于捕捉用户在页面执行的操作；</li>
<li>javascript事件是动态化页面的重要方式；</li>
<li>本文主要总结了重要的javascript事件，以及DOM0和DOM2对事件处理的异同；</li>
</ul>
<h3 id="事件大全">事件大全</h3><ul>
<li>下面总结了javascript事件，格式：事件名称+浏览器支持+说明</li>
</ul>
<h4 id="一般事件">一般事件</h4><ul>
<li>onclick    IE3、N2    鼠标点击时触发此事件</li>
<li>ondblclick    IE4、N4    鼠标双击时触发此事件</li>
<li>onmousedown    IE4、N4    按下鼠标时触发此事件</li>
<li>onmouseup    IE4、N4    鼠标按下后松开鼠标时触发此事件</li>
<li>onmouseover    IE3、N2    当鼠标移动到某对象范围的上方时触发此事件</li>
<li>onmousemove    IE4、N4    鼠标移动时触发此事件</li>
<li>onmouseout    IE4、N3    当鼠标离开某对象范围时触发此事件</li>
<li>onkeypress    IE4、N4    当键盘上的某个键被按下并且释放时触发此事件.</li>
<li>onkeydown    IE4、N4    当键盘上某个按键被按下时触发此事件</li>
<li>onkeyup    IE4、N4    当键盘上某个按键被按放开时触发此事件</li>
</ul>
<h4 id="页面相关事件">页面相关事件</h4><ul>
<li>onabort    IE4、N3    图片在下载时被用户中断</li>
<li>onbeforeunload    IE4、N    当前页面的内容将要被改变时触发此事件</li>
<li>onerror    IE4、N3    出现错误时触发此事件</li>
<li>onload    IE3、N2    页面内容完成时触发此事件</li>
<li>onmove    IE、N4    浏览器的窗口被移动时触发此事件</li>
<li>onresize    IE4、N4    当浏览器的窗口大小被改变时触发此事件</li>
<li>onscroll    IE4、N    浏览器的滚动条位置发生变化时触发此事件</li>
<li>onstop    IE5、N    浏览器的停止按钮被按下时触发此事件或者正在下载的文件被中断</li>
<li>onunload    IE3、N2    当前页面将被改变时触发此事件</li>
</ul>
<h4 id="表单相关事件">表单相关事件</h4><ul>
<li>onblur    IE3、N2    当前元素失去焦点时触发此事件</li>
<li>onchange    IE3、N2    当前元素失去焦点并且元素的内容发生改变而触发此事件</li>
<li>onfocus    IE3 、N2    当某个元素获得焦点时触发此事件</li>
<li>onreset    IE4 、N3    当表单中RESET的属性被激发时触发此事件</li>
<li>onsubmit    IE3 、N2    一个表单被递交时触发此事件</li>
</ul>
<h4 id="滚动字幕事件">滚动字幕事件</h4><ul>
<li>onbounce    IE4、N    在Marquee内的内容移动至Marquee显示范围之外时触发此事件</li>
<li>onfinish    IE4、N    当Marquee元素完成需要显示的内容后触发此事件</li>
<li>onstart    IE4、 N    当Marquee元素开始显示内容时触发此事件</li>
</ul>
<h4 id="编辑事件">编辑事件</h4><ul>
<li>onbeforecopy    IE5、N    当页面当前的被选择内容将要复制到浏览者系统的剪贴板前触发此事件</li>
<li>onbeforecut    IE5、 N    当页面中的一部分或者全部的内容将被移离当前页面[剪贴]并移动到浏览者的系统剪贴板时触发此事件</li>
<li>onbeforeeditfocus    IE5、N    当前元素将要进入编辑状态</li>
<li>onbeforepaste    IE5、 N    内容将要从浏览者的系统剪贴板传送[粘贴]到页面中时触发此事件</li>
<li>onbeforeupdate    IE5、 N    当浏览者粘贴系统剪贴板中的内容时通知目标对象</li>
<li>oncontextmenu    IE5、N    当浏览者按下鼠标右键出现菜单时或者通过键盘的按键触发页面菜单时触发的事件</li>
<li>oncopy    IE5、N    当页面当前的被选择内容被复制后触发此事件</li>
<li>oncut    IE5、N    当页面当前的被选择内容被剪切时触发此事件</li>
<li>ondrag    IE5、N    当某个对象被拖动时触发此事件 [活动事件]</li>
<li>ondragdrop    IE、N4    一个外部对象被鼠标拖进当前窗口或者帧</li>
<li>ondragend    IE5、N    当鼠标拖动结束时触发此事件，即鼠标的按钮被释放了</li>
<li>ondragenter    IE5、N    当对象被鼠标拖动的对象进入其容器范围内时触发此事件</li>
<li>ondragleave    IE5、N    当对象被鼠标拖动的对象离开其容器范围内时触发此事件</li>
<li>ondragover    IE5、N    当某被拖动的对象在另一对象容器范围内拖动时触发此事件</li>
<li>ondragstart    IE4、N    当某对象将被拖动时触发此事件</li>
<li>ondrop    IE5、N    在一个拖动过程中，释放鼠标键时触发此事件</li>
<li>onlosecapture    IE5、N    当元素失去鼠标移动所形成的选择焦点时触发此事件</li>
<li>onpaste    IE5、N    当内容被粘贴时触发此事件</li>
<li>onselect    IE4、N    当文本内容被选择时的事件</li>
<li>onselectstart    IE4、N    当文本内容选择将开始发生时触发的事件</li>
</ul>
<h4 id="数据绑定">数据绑定</h4><ul>
<li>onafterupdate    IE4、N    当数据完成由数据源到对象的传送时触发此事件</li>
<li>oncellchange    IE5、N    当数据来源发生变化时</li>
<li>ondataavailable    IE4、N    当数据接收完成时触发事件</li>
<li>ondatasetchanged    IE4、N    数据在数据源发生变化时触发的事件</li>
<li>ondatasetcomplete    IE4、N    当来子数据源的全部有效数据读取完毕时触发此事件</li>
<li>onerrorupdate    IE4、N    当使用onBeforeUpdate事件触发取消了数据传送时，代替onAfterUpdate事件</li>
<li>onrowenter    IE5、N    当前数据源的数据发生变化并且有新的有效数据时触发的事件</li>
<li>onrowexit    IE5、N    当前数据源的数据将要发生变化时触发的事件</li>
<li>onrowsdelete    IE5、N    当前数据记录将被删除时触发此事件</li>
<li>onrowsinserted    IE5、N    当前数据源将要插入新数据记录时触发此事件</li>
</ul>
<h4 id="外部事件">外部事件</h4><ul>
<li>onafterprint    IE5、N    当文档被打印后触发此事件</li>
<li>onbeforeprint    IE5、N    当文档即将打印时触发此事件</li>
<li>onfilterchange    IE4、N    当某个对象的滤镜效果发生变化时触发的事件</li>
<li>onhelp    IE4、N    当浏览者按下F1或者浏览器的帮助选择时触发此事件</li>
<li>onpropertychange    IE5、N    当对象的属性之一发生变化时触发此事件</li>
<li>onreadystatechange    IE4、N    当对象的初始化属性值发生变化时触发此事件</li>
</ul>
<h3 id="事件的使用">事件的使用</h3><h4 id="和html内联使用">和html内联使用</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="tag">button</span> id=<span class="string">"btn"</span> type=<span class="string">"button"</span> value=<span class="string">"button"</span> onclick=<span class="string">"alert('aaa')"</span>&gt;</span><br><span class="line">		<span class="tag">button</span></span><br><span class="line">&lt;/button&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">button</span> <span class="attribute">onclick</span>=<span class="value">"demo()"</span>&gt;</span>button<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="actionscript"></span><br><span class="line">		<span class="function"><span class="keyword">function</span> <span class="title">demo</span><span class="params">()</span></span>&#123;</span><br><span class="line">			alert(<span class="string">"aaa"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="外部js使用">外部js使用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"txt"</span>).onchange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	alert(<span class="string">"change"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="取消事件绑定">取消事件绑定</h4><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">   alert(<span class="string">"ok"</span>);</span><br><span class="line"> &#125;;</span><br><span class="line"> </span><br><span class="line"> btn.onclick = <span class="literal">null</span>;  <span class="comment">//取消绑定</span></span><br></pre></td></tr></table></figure>
<h3 id="DOM2事件详解">DOM2事件详解</h3><h4 id="DOM2事件的特点">DOM2事件的特点</h4><ul>
<li>DOM2支持同一dom元素注册多个同种事件；</li>
<li>DOM2新增了捕获和冒泡的概念；</li>
<li>DOM2事件通过addEventListener和removeEventListener管理；</li>
</ul>
<h4 id="注册事件(addEventListener)">注册事件(addEventListener)</h4><ul>
<li>参数一：事件名称，比上面DOM0的事件去掉”on”；</li>
<li>参数二：事件内容，fucntion中；</li>
<li>事件三：布尔型，true代表捕获事件，false代表冒泡事件；</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">outer.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span><span class="params">(e)</span></span>&#123;</span><br><span class="line">			alert(<span class="string">"outer"</span>);   </span><br><span class="line">		&#125;,<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<h4 id="捕获和冒泡事件">捕获和冒泡事件</h4><ul>
<li>如果外层和内层的多层DOM结构中，不同的层都注册有事件，先执行谁呢?</li>
<li>从外到内执行叫做捕获类型事件，从内到外执行叫做冒泡类型事件；</li>
<li>捕获类型事件总是比冒泡类型事件先执行；</li>
<li>如果两种类型的事件集中在了同一个元素身上，就不分这两种类型了，此时，哪个事件注册在前（在js中写在前面），他就先执行；</li>
<li>对于一个页面元素来说，他的身上如果集中了多个相同的事件，不会覆盖,都会执行，且定义在前的先执行；</li>
<li>如果普通事件和DOM2事件同时作用于一个元素，则不会出现后注册的覆盖先注册的，都执行，而且定义在前的先执行；</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"outer"</span> <span class="attribute">style</span>=<span class="value">"width:300px;height:300px;"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"inner"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">button</span> <span class="attribute">id</span>=<span class="value">"btn"</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"button"</span> <span class="attribute">onclick</span>=<span class="value">"alert('aaa')"</span>&gt;</span></span><br><span class="line">				button</span><br><span class="line">			<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">		<span class="keyword">var</span> outer = <span class="built_in">document</span>.getElementById(<span class="string">"outer"</span>);</span><br><span class="line">		<span class="keyword">var</span> inner = <span class="built_in">document</span>.getElementById(<span class="string">"inner"</span>);</span><br><span class="line">		<span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line">		</span><br><span class="line">		outer.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"outer"</span>);   <span class="comment">//先执行</span></span><br><span class="line">		&#125;,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">		inner.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"inner"</span>);   <span class="comment">//最后执行</span></span><br><span class="line">		&#125;,<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">		btn.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"btn"</span>);   <span class="comment">//再执行</span></span><br><span class="line">		&#125;,<span class="literal">false</span>);</span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"outer"</span> <span class="attribute">style</span>=<span class="value">"width:300px;height:300px;"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"inner"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">button</span> <span class="attribute">id</span>=<span class="value">"btn"</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"button"</span> <span class="attribute">onclick</span>=<span class="value">"alert('aaa')"</span>&gt;</span></span><br><span class="line">				button</span><br><span class="line">			<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">		<span class="keyword">var</span> outer = <span class="built_in">document</span>.getElementById(<span class="string">"outer"</span>);</span><br><span class="line">		<span class="keyword">var</span> inner = <span class="built_in">document</span>.getElementById(<span class="string">"inner"</span>);</span><br><span class="line">		<span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line"></span><br><span class="line">		inner.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"inner1"</span>);   <span class="comment">//先执行</span></span><br><span class="line">		&#125;,<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">		inner.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"inner2"</span>);   <span class="comment">//后执行</span></span><br><span class="line">		&#125;,<span class="literal">true</span>);</span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="stopPropagation阻止冒泡">stopPropagation阻止冒泡</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"outer"</span> <span class="attribute">style</span>=<span class="value">"width:300px;height:300px;"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"inner"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">button</span> <span class="attribute">id</span>=<span class="value">"btn"</span> <span class="attribute">type</span>=<span class="value">"button"</span> <span class="attribute">value</span>=<span class="value">"button"</span> <span class="attribute">onclick</span>=<span class="value">"alert('aaa')"</span>&gt;</span></span><br><span class="line">				button</span><br><span class="line">			<span class="tag">&lt;/<span class="title">button</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">		<span class="keyword">var</span> outer = <span class="built_in">document</span>.getElementById(<span class="string">"outer"</span>);</span><br><span class="line">		<span class="keyword">var</span> inner = <span class="built_in">document</span>.getElementById(<span class="string">"inner"</span>);</span><br><span class="line">		<span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line"></span><br><span class="line">		outer.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"outer"</span>);   <span class="comment">//不执行</span></span><br><span class="line">		&#125;,<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">		inner.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">			e.stopPropagation();  <span class="comment">//阻止冒泡</span></span><br><span class="line">			alert(<span class="string">"inner"</span>);   <span class="comment">//执行</span></span><br><span class="line">		&#125;,<span class="literal">false</span>);</span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="removeEventListener解除事件绑定">removeEventListener解除事件绑定</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line"><span class="keyword">var</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">	alert(<span class="string">"aa"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">btn.addEventListener(<span class="string">"click"</span>,fn,<span class="literal">false</span>); <span class="comment">//绑定</span></span><br><span class="line">btn.removeEventListener(<span class="string">"click"</span>,fn,<span class="literal">false</span>); <span class="comment">//解绑</span></span><br></pre></td></tr></table></figure>
<h3 id="IE8及之前版本浏览器的DOM2事件">IE8及之前版本浏览器的DOM2事件</h3><h4 id="說明">說明</h4><ul>
<li>IE8以及其之前版本的浏览器并不支持addEventListener()和removeEventListener()；</li>
<li>相应的，IE定义了类似的方法attachEvent()和detachEvent()；</li>
<li>attachEvent()和detachEvent()要求只有两个参数：事件类型（前面带上”on”）和事件处理函数，默认冒泡，不支持捕获；</li>
<li>同一个元素定义的同种类型的事件，都会执行，不会覆盖，且定义在后的先执行；</li>
<li>stopPropagation()不起作用；</li>
</ul>
<p>####示例</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">title</span>&gt;</span>test<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">		<span class="id">#outter</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">300px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">300px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#f00</span></span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line">		<span class="id">#inner</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">200px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">200px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#0f0</span></span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line">		<span class="id">#in</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">background-color</span>:<span class="value"> <span class="hexcolor">#00f</span></span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"outter"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"inner"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"in"</span>&gt;</span></span><br><span class="line">				</span><br><span class="line">			<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript"></span><br><span class="line">		<span class="built_in">document</span>.getElementById(<span class="string">"outter"</span>).attachEvent(<span class="string">'onclick'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"outter"</span>);  <span class="comment">//最后執行</span></span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="built_in">document</span>.getElementById(<span class="string">"inner"</span>).attachEvent(<span class="string">'onclick'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"inner"</span>);  <span class="comment">//再执行</span></span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			alert(<span class="string">"in1"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">document</span>.getElementById(<span class="string">"in"</span>).attachEvent(<span class="string">'onclick'</span>,test);  <span class="comment">//先执行</span></span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="兼容性说明">兼容性说明</h4><ul>
<li>添加事件的兼容性：需要先做判断浏览器支持哪种事件处理机制；</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(div1.addEventListener)&#123;</span><br><span class="line">    div1.addEventListener(<span class="string">'click'</span>, div1Fun, false);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(div1.attachEvent)&#123;</span><br><span class="line">    div1.attachEvent(<span class="string">'onclick'</span>, div1Fun);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>访问事件对象的兼容性：</li>
</ul>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> function myFun(<span class="keyword">event</span>)&#123;</span><br><span class="line">    <span class="keyword">event</span> = <span class="keyword">event</span> || <span class="keyword">window</span>.<span class="keyword">event</span>;</span><br><span class="line">    var target = <span class="keyword">event</span>.target || <span class="keyword">event</span>.srcElement;</span><br><span class="line">    console.<span class="keyword">log</span>(<span class="keyword">event</span>.type);</span><br><span class="line">    console.<span class="keyword">log</span>(target);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2015-10-2-datebase-conflict" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/02/2015-10-2-datebase-conflict/" class="article-date">
  	<time datetime="2015-10-01T16:00:00.000Z" itemprop="datePublished">2015-10-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/02/2015-10-2-datebase-conflict/">数据库并发冲突的解决</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>数据库读写看似简单，其实蕴含着许多值得思考的问题；</li>
<li>并发读写是令数据库设计者头疼的问题，其实，这个问题不仅令数据库设计者困惑，对于数据库的使用者来说，如何从业务层面高效处理并发读写问题也是不小的挑战；</li>
<li>本文就此问题做简单探讨；</li>
</ul>
<h3 id="问题描述">问题描述</h3><ul>
<li>在多用户环境中，在同一时间可能会有多个用户更新相同的记录，这会产生冲突，具体为：<ul>
<li>丢失更新：一个事务的更新覆盖了其它事务的更新结果，就是所谓的更新丢失。例如：用户A把值从6改为2，用户B把值从2改为6，则用户A丢失了他的更新；</li>
<li>脏读：当一个事务读取其它完成一半事务的记录时，就会发生脏读取。例如：用户A,B看到的值都是6，用户B把值改为2，用户A读到的值仍为6；</li>
</ul>
</li>
</ul>
<h3 id="数据库层面的并发控制-悲观锁">数据库层面的并发控制-悲观锁</h3><ul>
<li>说明：<ul>
<li>假定本次读写一定会发生并发冲突，屏蔽一切可能违反数据完整性的操作；</li>
<li>适用于实际业务中冲突发生可能性较大的情况，比如很有可能不同的人同时修改同一条数据库记录；</li>
<li>如果实际业务中冲突发生可能性较小，则用悲观锁效率很低（因为上锁的代价大）；</li>
</ul>
</li>
<li>使用：<ul>
<li>操作之前先上锁；</li>
<li>需要使用数据库的锁机制，比如SQL SERVER 的TABLOCKX（排它表锁） 此选项被选中时，SQL  Server将在整个表上置排它锁直至该命令或事务结束，这将防止其他进程读取或修改表中的数据；</li>
</ul>
</li>
</ul>
<h3 id="数据库层面的并发控制-乐观锁">数据库层面的并发控制-乐观锁</h3><ul>
<li>说明：<ul>
<li>假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性，乐观锁不能解决脏读的问题；</li>
<li>适用于实际业务中冲突发生可能性较小的情况，比如几乎不可能不同的人同时修改同一条数据库记录；</li>
</ul>
</li>
<li>使用：<ul>
<li>数据表中专门有一个version字段（int型）记录版本信息；</li>
<li>每当这条记录改动时，这条记录对应的version字段增1；</li>
<li>每次更新时检查版本号是否一致，比如数据库中数据版本为6，更新提交时version=6+1,使用该version值(=7)与数据库version+1(=7)作比较，如果相等，则可以更新，如果不等则有可能其他程序已更新该记录，所以返回错误；</li>
</ul>
</li>
</ul>
<h3 id="结论">结论</h3><ul>
<li>在实际生产环境里边，如果并发量不大且不允许脏读，可以使用悲观锁解决并发问题；</li>
<li>但如果系统的并发非常大的话,悲观锁定会带来非常大的性能问题,所以我们就要选择乐观锁定的方法；</li>
<li>上面介绍的锁都是数据库层面的锁，其实，如果从业务层面来看，上面的并发控制机制还是不够的，在数据库设计时，可以设计lock字段，如果要暂时锁定某些行，令lock=1时视为锁定，业务锁面向业务，更加可靠；</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/datebase/">datebase</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/datebase/">datebase</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/7/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Eric Chang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
	
	<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/cn/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/">知识共享署名 3.0 中国大陆许可协议</a>进行许可。
	
	<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','1BK1VZMDEA-ktxiBz_9B');
</script>

<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258423514'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1258423514%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
          
	
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>