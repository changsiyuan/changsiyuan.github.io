<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Eric Chang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="~爱前端，爱生活~">
<meta property="og:type" content="website">
<meta property="og:title" content="Eric Chang's Blog">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="Eric Chang's Blog">
<meta property="og:description" content="~爱前端，爱生活~">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Eric Chang's Blog">
<meta name="twitter:description" content="~爱前端，爱生活~">
  
    <link rel="alternative" href="/atom.xml" title="Eric Chang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">


	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/images/me.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/" style="font-family: Microsoft Yahei;">Eric Chang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">归档</a></li>
				        
							<li><a href="/tags/feeling">感悟</a></li>
				        
							<li><a href="/tags/me">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/changsiyuan" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/2803286360" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="mailto:changsiyuan2011@126.com" title="mail">mail</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/preview?locale=zh_CN&trk=prof-0-sb-preview-primary-button" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Angularjs/" style="font-size: 11.25px;">Angularjs</a> <a href="/tags/Flask/" style="font-size: 10px;">Flask</a> <a href="/tags/JSONP/" style="font-size: 10px;">JSONP</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/JavaScript/" style="font-size: 18.75px;">JavaScript</a> <a href="/tags/Latex/" style="font-size: 10px;">Latex</a> <a href="/tags/Linkedlist/" style="font-size: 11.25px;">Linkedlist</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Operating-System/" style="font-size: 10px;">Operating System</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/RESTful/" style="font-size: 10px;">RESTful</a> <a href="/tags/Safety/" style="font-size: 10px;">Safety</a> <a href="/tags/Tree/" style="font-size: 11.25px;">Tree</a> <a href="/tags/Web/" style="font-size: 17.5px;">Web</a> <a href="/tags/books/" style="font-size: 11.25px;">books</a> <a href="/tags/computer/" style="font-size: 11.25px;">computer</a> <a href="/tags/cooking/" style="font-size: 11.25px;">cooking</a> <a href="/tags/css/" style="font-size: 12.5px;">css</a> <a href="/tags/datebase/" style="font-size: 13.75px;">datebase</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/feeling/" style="font-size: 17.5px;">feeling</a> <a href="/tags/git/" style="font-size: 11.25px;">git</a> <a href="/tags/glassfish/" style="font-size: 10px;">glassfish</a> <a href="/tags/hadoop/" style="font-size: 16.25px;">hadoop</a> <a href="/tags/hardware/" style="font-size: 10px;">hardware</a> <a href="/tags/hdfs/" style="font-size: 10px;">hdfs</a> <a href="/tags/html/" style="font-size: 11.25px;">html</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/jQuery/" style="font-size: 12.5px;">jQuery</a> <a href="/tags/javaEE/" style="font-size: 10px;">javaEE</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/mail/" style="font-size: 10px;">mail</a> <a href="/tags/mapreduce/" style="font-size: 13.75px;">mapreduce</a> <a href="/tags/me/" style="font-size: 10px;">me</a> <a href="/tags/network/" style="font-size: 10px;">network</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/others/" style="font-size: 11.25px;">others</a> <a href="/tags/psychology/" style="font-size: 11.25px;">psychology</a> <a href="/tags/publicity/" style="font-size: 10px;">publicity</a> <a href="/tags/selenium/" style="font-size: 10px;">selenium</a> <a href="/tags/translation/" style="font-size: 11.25px;">translation</a> <a href="/tags/travel/" style="font-size: 11.25px;">travel</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.yinshuisiyuan.net/">我的主页</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/home.html">阮一峰</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/">Github</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://azure.microsoft.com/en-us/?v=17.14">Azure</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000">Python</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434501245426ad4b91f2b880464ba876a8e3043fc8ef000">Nodejs</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我叫常思源，毕业于北京邮电大学，目前就职于斯伦贝谢技术有限公司。专注DevOps和持续交付。快速学习，注重细节，追求卓越！</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Eric Chang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/images/me.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Eric Chang</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">归档</a></li>
		        
					<li><a href="/tags/feeling">感悟</a></li>
		        
					<li><a href="/tags/me">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/changsiyuan" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/2803286360" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="mailto:changsiyuan2011@126.com" title="mail">mail</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/preview?locale=zh_CN&trk=prof-0-sb-preview-primary-button" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2015-11-3-java-ArrayList" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/03/2015-11-3-java-ArrayList/" class="article-date">
  	<time datetime="2015-11-02T16:00:00.000Z" itemprop="datePublished">2015-11-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/03/2015-11-3-java-ArrayList/">Java ArrayList的实现</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>Java中，ArrayList是重要的数据结构；</li>
<li>ArrayList用数组实现；</li>
<li>本文实现了一个简单的ArrayList；</li>
</ul>
<h3 id="具体实现">具体实现</h3><ul>
<li>MyArrayList 完成大部分方法实现</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">package arraylisttest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> MyArrayList&lt;T&gt; &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> final <span class="keyword">int</span> initialSize = <span class="number">16</span>;</span><br><span class="line">	Object[] <span class="built_in">array</span> = <span class="keyword">new</span> Object[initialSize];</span><br><span class="line">	T[] myArray = (T[]) <span class="built_in">array</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> size = <span class="number">0</span>; <span class="comment">// 数组长度</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 构造器</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 删除全部元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="built_in">array</span> = <span class="keyword">new</span> Object[initialSize];</span><br><span class="line">		myArray = (T[]) <span class="built_in">array</span>;</span><br><span class="line">		size = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 检测数组空间是否充足</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (size &gt; (<span class="keyword">int</span>) (myArray.length / <span class="number">2</span>)) &#123;</span><br><span class="line">			Object[] newArray = <span class="keyword">new</span> Object[<span class="built_in">array</span>.length * <span class="number">2</span>];</span><br><span class="line">			T[] newMyArray = (T[]) newArray;</span><br><span class="line">			System.arraycopy(<span class="built_in">array</span>, <span class="number">0</span>, newMyArray, <span class="number">0</span>, myArray.length);</span><br><span class="line">			myArray = newMyArray; <span class="comment">// 新数组的引用赋值给原数组变量名，原数组的堆中的存储空间失去引用，交给垃圾回收处理</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 在末尾增加元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">		ensureCapacity();</span><br><span class="line">		myArray[size] = data;</span><br><span class="line">		size++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 在特定位置增加元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T data, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">		ensureCapacity();</span><br><span class="line">		T temp = null;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; myArray.length; i++) &#123;</span><br><span class="line">			temp = myArray[i];</span><br><span class="line">			myArray[i] = data;</span><br><span class="line">			data = temp;</span><br><span class="line">		&#125;</span><br><span class="line">		size++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 检测是否存在元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> boolean <span class="title">contains</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (myArray[i].equals(data)) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 获取特定元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> myArray[index];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 获取特定元素的索引值</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">indexOf</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (myArray[i].equals(data)) &#123;</span><br><span class="line">				<span class="keyword">return</span> i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取元素最后一次出现的索引值</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lastIndexOf</span><span class="params">(T data)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span> (myArray[i].equals(data)) &#123;</span><br><span class="line">				index = i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> index;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 判断是否为空</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> boolean <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 移除特定索引的元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(index&lt;size)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i =index+<span class="number">1</span>; i&lt;size; i++)&#123;</span><br><span class="line">				myArray[i-<span class="number">1</span>]=myArray[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		size--;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//移除特定元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(T data)</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">		boolean match = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;size; i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(myArray[i].equals(data))&#123;</span><br><span class="line">				index = i;</span><br><span class="line">				match = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!match)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i =index+<span class="number">1</span>; i&lt;size; i++)&#123;</span><br><span class="line">				myArray[i-<span class="number">1</span>]=myArray[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		size--;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//替换对应元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T data, <span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(index&lt;size)&#123;</span><br><span class="line">			myArray[index] = data;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//显示全部元素</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">displayAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;size; i++)&#123;</span><br><span class="line">			System.out.print(myArray[i]+<span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.print(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>MyArrayListTest 测试类</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">package arraylisttest;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> MyArrayListTest &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] <span class="keyword">args</span>) &#123;</span><br><span class="line">		MyArrayList&lt;String&gt; <span class="keyword">list</span> = new MyArrayList&lt;String&gt;();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"111"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"222"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"333"</span>);</span><br><span class="line">		<span class="keyword">list</span>.displayAll();</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"test"</span>, 1);</span><br><span class="line">		<span class="keyword">list</span>.displayAll();</span><br><span class="line">		<span class="keyword">list</span>.<span class="keyword">clear</span>();</span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.isEmpty()); <span class="comment">//true</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="string">"----------"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"aaa"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"bbb"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"aaa"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"ccc"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"eee"</span>);</span><br><span class="line">		<span class="keyword">list</span>.add(<span class="string">"ddd"</span>);</span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.contains(<span class="string">"ccc"</span>));  <span class="comment">//true</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.contains(<span class="string">"sss"</span>));  <span class="comment">//false</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.<span class="literal">get</span>(2));  <span class="comment">//aaa</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.indexOf(<span class="string">"aaa"</span>)); <span class="comment">//0</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.lastIndexOf(<span class="string">"aaa"</span>));  <span class="comment">//2</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.indexOf(<span class="string">"ddd"</span>)); <span class="comment">//5</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="keyword">list</span>.isEmpty());  <span class="comment">//false</span></span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="string">"----------"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">list</span>.displayAll();</span><br><span class="line">		<span class="keyword">list</span>.remove(1);</span><br><span class="line">		<span class="keyword">list</span>.remove(<span class="string">"ddd"</span>);</span><br><span class="line">		<span class="keyword">list</span>.displayAll();</span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="string">"----------"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">list</span>.<span class="keyword">set</span>(<span class="string">"bbb"</span>,1);</span><br><span class="line">		<span class="keyword">list</span>.displayAll();</span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="string">"----------"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Java/">Java</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2015-11-2-js-string" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/2015-11-2-js-string/" class="article-date">
  	<time datetime="2015-11-01T16:00:00.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/2015-11-2-js-string/">javascript字符串操作</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>字符串操作是js中常见的操作；</li>
<li>本文总结了js中常见的字符串操作；</li>
</ul>
<h3 id="常见字符串操作">常见字符串操作</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = <span class="string">"aaa"</span>;</span><br><span class="line"><span class="keyword">var</span> str2 = <span class="string">"bbb"</span>;</span><br><span class="line"><span class="keyword">var</span> str3 = <span class="string">"ccc"</span>;</span><br><span class="line"><span class="keyword">var</span> str4 = <span class="string">"aaabbbccc"</span>;</span><br><span class="line"><span class="keyword">var</span> str5=<span class="string">"Hello world!"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//字符串长度</span></span><br><span class="line"><span class="built_in">document</span>.write(str1.length +<span class="string">"&lt;br&gt;"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//大小写转换</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.toLowerCase() +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">//hello world!</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.toUpperCase() +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">//HELLO WORLD!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//连接两个字符串</span></span><br><span class="line"><span class="built_in">document</span>.write(str1.concat(str2) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">//aaabbb</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回字符串中一个子串第一处出现的索引。如果没有匹配项，返回 -1 </span></span><br><span class="line"><span class="built_in">document</span>.write(str4.indexOf(<span class="string">"b"</span>) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.indexOf(<span class="string">"c"</span>) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">// 6</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.indexOf(<span class="string">"ab"</span>) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回字符串中一个子串最后一处出现的索引，如果没有匹配项，返回 -1</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.lastIndexOf(<span class="string">"b"</span>) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回指定位置的字符</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.charAt(<span class="number">2</span>) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">// a</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.charAt(<span class="number">7</span>) +<span class="string">"&lt;br&gt;"</span>)  <span class="comment">// c</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用 match() 来检索一个字符串</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.match(<span class="string">"world"</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// world</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.match(<span class="string">"World"</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// null</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.match(<span class="string">"worlld"</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// null</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.match(<span class="string">"world!"</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// world!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用 match() 来检索一个正则表达式的匹配</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.match(<span class="regexp">/a*b/</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// aaab</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回字符串的一个子串,传入参数是起始位置和结束位置</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.substring(<span class="number">0</span>,<span class="number">5</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">//aaabb</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//slice() 方法可提取字符串的某个部分，并以新的字符串返回被提取的部分</span></span><br><span class="line"><span class="comment">//stringObject.slice(start,end)</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.slice(<span class="number">1</span>,<span class="number">4</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// aab</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//替换部分字符串，stringObject.replace(regexp/substr,replacement)</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.replace(<span class="string">"aaab"</span>,<span class="string">"ccc"</span>) + <span class="string">"&lt;br /&gt;"</span>) <span class="comment">//cccbbccc</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.replace(<span class="regexp">/a*b/</span>,<span class="string">"ccc"</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">//cccbbccc</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//search() 方法用于检索字符串中指定的子字符串,或检索与正则表达式相匹配的子字符串</span></span><br><span class="line"><span class="comment">//stringObject.search(regexp)</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.search(<span class="regexp">/a*b/</span>) + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">// 0</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.search(<span class="regexp">/b*c/</span>) + <span class="string">"&lt;br /&gt;"</span>) <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">document</span>.write(str4.search(<span class="regexp">/.*d/</span>) + <span class="string">"&lt;br /&gt;"</span>) <span class="comment">// -1(无匹配)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//通过将字符串划分成子串，将一个字符串做成一个字符串数组</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.split(<span class="string">" "</span>)[<span class="number">0</span>] + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">//Hello</span></span><br><span class="line"><span class="built_in">document</span>.write(str5.split(<span class="string">" "</span>)[<span class="number">1</span>] + <span class="string">"&lt;br /&gt;"</span>)  <span class="comment">//world!</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-java-memory" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/31/java-memory/" class="article-date">
  	<time datetime="2015-10-30T16:00:00.000Z" itemprop="datePublished">2015-10-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/31/java-memory/">Java堆内存和栈内存</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="JVM运行时数据区">JVM运行时数据区</h3><p><img src="/images/jvm.jpeg" alt="jvm"></p>
<ul>
<li>程序计数器：存放线程执行位置（main函数也是一个线程）；</li>
<li>虚拟机栈（栈内存）：<ul>
<li>生命周期和对应的线程相同，存放该线程的局部变量、对象的引用；</li>
<li>方法中可能嵌套调用别的方法，这些方法的变量以”先进后出、后进先出“的方式在栈内存中存储，所以内层方法无法访问外层方法的变量（他们在栈底），执行外层方法时内层方法的变量已经弹出栈消失了，所以外层方法也不会访问到内层方法的变量；</li>
<li>一个方法的执行过程，就是这个方法对于帧栈的入栈出栈过程；</li>
</ul>
</li>
<li>本地方法栈：<ul>
<li>作用和虚拟机栈完全相同；</li>
<li>虚拟机栈对应普通的java方法，本地方法栈对应native方法；</li>
<li>native方法是一个java调用非java代码的接口；</li>
</ul>
</li>
<li>方法区：<ul>
<li>JVM内存管理中最大一块；</li>
<li>存储常量（final修饰）、类变量/成员变量（static修饰）、类信息（每个类的访问控制符、修饰符、继承关系等）；</li>
</ul>
</li>
<li>堆内存：JVM启动时创建，存放对象本身，不存放对对象的引用（引用存在栈内存）；</li>
</ul>
<h3 id="堆内存和栈内存的区别">堆内存和栈内存的区别</h3><ul>
<li>变量存在栈内存中（无论是static类变量还是对象的变量），已经不在其作用域中的对象要及时弹出栈；</li>
<li>new出来的对象或实例，它的名称存在栈内存中，实体存在堆内存中，名称通过实体在堆内存的地址引用实体；</li>
<li>垃圾回收的目标是堆内存中失去引用的对象实体；</li>
<li>栈内存一般是用物理一级缓存实现，堆内存一般是用物理二级缓存实现，栈内存存取速度快于堆内存，代码本身存储在磁盘中，和堆栈内存无关；</li>
<li>堆主要用来存放对象的，栈主要是用来执行程序的；</li>
<li>每个线程有自己的栈内存（栈内存是线程私有的），在一个JVM实例中（一个java应用对应一个JVM实例），堆内存只有一个（堆内存是线程共享的）；</li>
<li>在java中：<ul>
<li>基本数据类型（int, short, long, byte, float, double, boolean, char），他们存储在栈内存中，函数调用它们的时候是”传值”；</li>
<li>复杂数据类型（数组, 对象, map, List, Set等），他们的实体存储在堆内存中，栈内存中只存储他们的对象的名称、通过堆内存的地址引用实体对象，函数调用它们的时候是”传引用地址”；</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Java/">Java</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-cross-domain" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/30/cross-domain/" class="article-date">
  	<time datetime="2015-10-29T16:00:00.000Z" itemprop="datePublished">2015-10-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/30/cross-domain/">同源策略详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是同源策略">什么是同源策略</h3><ul>
<li>同源策略是Netscape提出的一个著名的安全策略；</li>
<li>同源策略是浏览器最核心最基础的安全策略；</li>
<li>现在所有的可支持javascript的浏览器都会使用这个策略；</li>
<li>web构建在同源策略基础之上，浏览器对非同源脚本的限制措施是对同源策略的具体实现；</li>
<li>本文详细说明了同源策略的含义，用具体的例子让您深入理解同源策略，并且对跨域访问的几种常用机制作了说明；</li>
</ul>
<h3 id="同源策略的含义详解">同源策略的含义详解</h3><ul>
<li>含义一（DOM层面的同源策略）：<ul>
<li>限制了来自不同源的”document”对象或js脚本，对当前“document”对象的读取或设置某些属性；</li>
</ul>
</li>
<li>含义二（Cookie和XMLHttprequest层面的同源策略）：<ul>
<li>只有和本网页同源的脚本才会被执行，有时，AJAX已经加载不同源的脚本，但绝对不会被执行；</li>
</ul>
</li>
<li>含义三（同源策略的非绝对性）：<ul>
<li>同源策略通常允许进行跨域写操作、通常允许跨域资源嵌入、通常不允许跨域读操作；</li>
<li><code>&lt;script&gt;&lt;img&gt;&lt;iframe&gt;&lt;link&gt;&lt;video&gt;&lt;audio&gt;</code>等带有src属性的标签可以从不同的域加载和执行资源，同源策略关注的是加载js的页面所在的域，而不是页面内存放的js文件的域；</li>
</ul>
</li>
<li>含义四（其他插件的同源策略）：<ul>
<li><code>flash、java applet、silverlight、googlegears</code>等浏览器加载的第三方插件也有各自的同源策略，只是这些同源策略不属于浏览器原生的同源策略，如果有漏洞则可能被黑客利用，从而留下XSS攻击的后患；</li>
</ul>
</li>
</ul>
<h3 id="几个同源策略常见问题">几个同源策略常见问题</h3><ul>
<li><p>没有同源策略会怎样？为什么同源策略禁止跨域读操作？</p>
<ul>
<li>设想你打开了一个银行网站，又打开了一个恶意网站，如果没有同源策略，将会：</li>
<li>恶意网站包含了脚本a.js，银行网站在没有加载此脚本的情况下，就可以被此脚本操纵，操纵的后果是：</li>
<li>银行网站页面DOM结构被篡改；</li>
<li>银行网站页面DOM元素的属性和值被篡改；</li>
<li>银行页面发送的表单信息可能被恶意脚本接收到，造成用户名密码泄漏；</li>
<li>恶意网站通过自己加载的恶意js脚本获取了银行网站用户的cookie信息，并将它发送给了银行网站，随后，恶意网站就可以自动的、不受用户限制的、在用户不知情的情况下登录用户的银行网站并且伪装用户发送转账等请求；</li>
</ul>
</li>
<li><p>有了同源策略会怎样？</p>
<ul>
<li>浏览器在执行一个js脚本（或其他脚本）前，需要对这个脚本进行同源检测，如果加载这个脚本的页面和当前页面不同源，浏览器将拒绝执行此脚本；</li>
<li>注意，浏览器并不关心js脚本来自何方（不关心js脚本从哪个域名、哪个”源”加载），它只关心加载脚本的那个页面是否和当前页面同源；</li>
</ul>
</li>
<li><p>为什么<code>&lt;script&gt;&lt;img&gt;&lt;iframe&gt;&lt;link&gt;&lt;video&gt;&lt;audio&gt;</code>等带有src属性的标签可以不遵守同源策略/为什么同源策略允许跨域嵌入：</p>
<ul>
<li>现在很多大型网站的js脚本、图片等都不是存放在存储网站页面的那台服务器上，他们很可能通过CDN等方式传送到浏览器端，如果限制他们必须和网站页面同源，无异于自己束缚手脚；</li>
<li>一个网站要加载哪些脚本，由网站的编写人员说了算，他们不会故意加载恶意脚本（比如银行网站的编写人员不会将恶意网站的脚本写在银行网站中），所以只要是写在网页中的脚本，我们认为它是安全的；</li>
<li>所以，a.com的网页中可以写<code>&lt;script src=&quot;b.js&quot;&gt;&lt;/script&gt;</code>，a网站加载了b网站的脚本，这是完全可以的，不受任何限制；<br>可以这样认为，只要是页面加载的脚本，都和页面同源，无论这个脚本来自哪个”源”（source）；</li>
</ul>
</li>
<li><p>为什么同源策略允许跨域写操作？</p>
<ul>
<li>和上面一条理解相同；</li>
<li>比如提交表单这个写操作，表单不一定提交到提供网页页面的网站，很有可能提交到专门处理表单的服务器，如果不允许跨域写，将是很不灵活的；</li>
<li>表单提交到什么地方，是编写页面时程序员决定，程序员不可能故意写一个恶意域名进去，所以写操作通常是安全的；</li>
</ul>
</li>
<li><p>“同源”的具体含义?</p>
<ul>
<li>网站的同源：域名、协议、端口有一个不同就不是同源，三者均相同，这两个网站才是同源；</li>
<li>js脚本的同源：处于同源网站上的js脚本同源，否则不同源；</li>
</ul>
</li>
<li><p>浏览器沙箱机制：</p>
<ul>
<li>纵向上，浏览器的不同标签页分属不同的进程，进程间不能相互访问内存；</li>
<li>横向上，浏览器进程、渲染进程、插件进程、扩展进程相互隔离，他们可以相互通信，但要经过严格的安全检测；</li>
<li>浏览器的沙箱机制是从内存管理的角度设计的安全措施，是对同源策略的补充，进一步提升浏览器安全性；</li>
</ul>
</li>
</ul>
<h3 id="几种跨域访问策略和原理">几种跨域访问策略和原理</h3><ul>
<li><p>document.domain</p>
<ul>
<li>浏览器在检测是否同源时肯定要检测域名是否相同，它是通过<code>document.domain</code>属性来获取当前页面域名的；</li>
<li><code>document.domain</code>属性不能随便更改，但可以通过js将<code>document.domain</code>属性设置为当前<code>document.domain</code>属性值的后缀；</li>
<li>例如，假设在 <code>http://store.company.com/dir/other.html</code>中的一个脚本执行了下列语句<code>document.domain = &quot;company.com&quot;</code>，这条语句执行之后，浏览器将会成功地通过对<code>http://company.com/dir/page.html</code>的同源检测，但不能设置 <code>document.domain为othercompany.com.</code>；</li>
<li>如果需要跨域访问的网站和本网站端口、协议均相同，只有域名不同，而且需要跨域访问的网站的域名是本网站的后缀，则可以使用<code>document.domain</code>暂时更改当前document对象的域名值，实现跨域访问；</li>
<li>此种跨域访问限制颇多，空间上，只能跨域访问协议、端口相同的且域名是本网站后缀的网站，时间上，一旦原网站重新刷新页面，<code>document.domain</code>值恢复原状，不能继续跨域访问，所以这种跨域访问策略只能算是局部的、暂时的、基础域名相同的网站间的跨域访问；</li>
</ul>
</li>
<li><p>window.name</p>
<ul>
<li>浏览器一个窗口（标签页）的<code>window.name</code>属性在时间上是全局的，无论一个窗口中的页面如何跳转，<code>window.name</code>属性不变;</li>
<li>可以看到，如果在一个标签里面跳转网页的话，我们的 <code>window.name</code> 是不会改变的；</li>
<li>由于安全原因，浏览器始终会保持 <code>window.name</code> 是string类型；</li>
<li><code>window.name</code>比<code>document.domain</code>更强大，可以从任意页面获取string类型的数据；</li>
</ul>
</li>
<li><p>JSONP</p>
<ul>
<li>JSONP是一种依靠开发人员的聪明才智创造出的一种非官方跨域数据交互协议；</li>
<li>JSONP本质是利用了<code>&lt;script&gt;&lt;img&gt;&lt;iframe&gt;</code>等标签可跨预加载脚本的特性实现数据跨域传输；</li>
<li>本地的js代码将需要请求的数据包装好（如需要某天的某次航班的飞机票数据），发送到远端js，远端js依据本地js提供的信息获取相应的数据传回到本地js；</li>
<li>JSONP 的理念就是，我和服务端约定好一个函数名，当我请求文件的时候，服务端返回一段 JavaScript，这段 JavaScript 调用了我们约定好的函数，并且将数据当做参数传入；</li>
</ul>
</li>
<li><p>postMessage</p>
<ul>
<li>postMessage()方法允许来自不同源的脚本（无视协议，端口，域名的不同）采用异步方式进行有限的通信，可以实现跨文本档、多窗口、跨域消息传递；</li>
<li><code>postMessage(data,origin)</code>方法接受两个参数：</li>
<li>data:要传递的数据，html5规范中提到该参数可以是JavaScript的任意基本类型或可复制的对象，然而并不是所有浏览器都做到了这点儿，部分浏览器只能处理字符串参数，所以我们在传递参数的时候需要使用JSON.stringify()方法对对象参数序列化，在低版本IE中引用json2.js可以实现类似效果；</li>
<li>origin：字符串参数，指明目标窗口的源，协议+主机+端口号[+URL]，URL会被忽略，所以可以不写，这个参数是为了安全考虑，postMessage()方法只会将message传递给指定窗口，当然如果愿意也可以建参数设置为”*”，这样可以传递给任意窗口，如果要指定和当前窗口同源的话设置为”/“；</li>
</ul>
</li>
<li><p>对于跨域访问的说明：</p>
<ul>
<li>对于不同的浏览器、不同的业务类型、不同的安全等级、不同的实际情况，对下述内容的管制也不相同，有的允许有的禁止：跨域写、跨域嵌入、跨域读、跨域API接口访问、跨域数据存储（DB）访问、跨域授权情况；</li>
<li>其他的跨域访问机制：CORS(允许一个域上的网络应用向另一个域提交跨域AJAX请求)、OAuth(跨域授权)；</li>
<li>严格的同源策略限制所有的跨域读写、跨域访问和跨域资源嵌入，虽然保证了安全性，但是对于大型网站来说，强迫他们把一个网站的所有功能放在一个域名下，降低了效率和网站的可扩展性；</li>
<li>所以现有的同源策略、跨域访问策略是在效率和安全性之间做出的最佳权衡；</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/">Web</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-java-zip" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/28/java-zip/" class="article-date">
  	<time datetime="2015-10-27T16:00:00.000Z" itemprop="datePublished">2015-10-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/28/java-zip/">java 文件压缩和解压</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>文件压缩和解压是常见的操作</li>
<li>本文重点总结了java中文件压缩和解压的方法</li>
</ul>
<h3 id="方法一">方法一</h3><ul>
<li>zip格式，不支持中文</li>
<li>压缩：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileInputStream;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileOutputStream;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.IOException;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipEntry;</span></span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span><br><span class="line"></span>&#123;	</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main( String[] args )</span><br><span class="line">    &#123;</span><br><span class="line">    	byte[] buffer = <span class="keyword">new</span> byte[<span class="number">1024</span>];</span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">try</span>&#123;</span><br><span class="line">    		</span><br><span class="line">    		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"C:\\MyFile.zip"</span>);</span><br><span class="line">    		ZipOutputStream zos = <span class="keyword">new</span> ZipOutputStream(fos);</span><br><span class="line">    		ZipEntry ze= <span class="keyword">new</span> ZipEntry(<span class="string">"spy.log"</span>);</span><br><span class="line">    		zos.putNextEntry(ze);</span><br><span class="line">    		FileInputStream <span class="keyword">in</span> = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\spy.log"</span>);</span><br><span class="line">   	   </span><br><span class="line">    		int len;</span><br><span class="line">    		<span class="keyword">while</span> ((len = <span class="keyword">in</span>.read(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    			zos.write(buffer, <span class="number">0</span>, len);</span><br><span class="line">    		&#125;</span><br><span class="line"></span><br><span class="line">    		<span class="keyword">in</span>.close();</span><br><span class="line">    		zos.closeEntry();</span><br><span class="line">           </span><br><span class="line">    		<span class="comment">//remember close it</span></span><br><span class="line">    		zos.close();</span><br><span class="line">          </span><br><span class="line">    		System.out.println(<span class="string">"Done"</span>);</span><br><span class="line"></span><br><span class="line">    	&#125;<span class="keyword">catch</span>(IOException ex)&#123;</span><br><span class="line">    	   ex.printStackTrace();</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解压</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipInputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> UnZip</span><br><span class="line">&#123;</span><br><span class="line">    List&lt;String&gt; fileList;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String INPUT_ZIP_FILE = <span class="string">"C:\\MyFile.zip"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String OUTPUT_FOLDER = <span class="string">"C:\\outputzip"</span>;</span><br><span class="line">		</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main( String[] args )</span><br><span class="line">    &#123;</span><br><span class="line">    	UnZip unZip = <span class="keyword">new</span> UnZip();</span><br><span class="line">    	unZip.unZipIt(INPUT_ZIP_FILE,OUTPUT_FOLDER);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * Unzip it</span><br><span class="line">     * @param zipFile input zip file</span><br><span class="line">     * @param output zip file output folder</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> unZipIt(String zipFile, String outputFolder)&#123;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    	</span><br><span class="line">     <span class="keyword">try</span>&#123;</span><br><span class="line">    		</span><br><span class="line">    	<span class="comment">//create output directory is not exists</span></span><br><span class="line">    	<span class="keyword">File</span> folder = <span class="keyword">new</span> <span class="keyword">File</span>(OUTPUT_FOLDER);</span><br><span class="line">    	<span class="keyword">if</span>(!folder.exists())&#123;</span><br><span class="line">    		folder.mkdir();</span><br><span class="line">    	&#125;</span><br><span class="line">    		</span><br><span class="line">    	<span class="comment">//get the zip file content</span></span><br><span class="line">    	ZipInputStream zis = </span><br><span class="line">    		<span class="keyword">new</span> ZipInputStream(<span class="keyword">new</span> FileInputStream(zipFile));</span><br><span class="line">    	<span class="comment">//get the zipped file list entry</span></span><br><span class="line">    	ZipEntry ze = zis.getNextEntry();</span><br><span class="line">    		</span><br><span class="line">    	<span class="keyword">while</span>(ze!=<span class="keyword">null</span>)&#123;</span><br><span class="line">    			</span><br><span class="line">    	   String fileName = ze.getName();</span><br><span class="line">           <span class="keyword">File</span> newFile = <span class="keyword">new</span> <span class="keyword">File</span>(outputFolder + <span class="keyword">File</span>.separator + fileName);</span><br><span class="line">                </span><br><span class="line">           System.out.<span class="keyword">println</span>(<span class="string">"file unzip : "</span>+ newFile.getAbsoluteFile());</span><br><span class="line">                </span><br><span class="line">            <span class="comment">//create all non exists folders</span></span><br><span class="line">            <span class="comment">//else you will hit FileNotFoundException for compressed folder</span></span><br><span class="line">            <span class="keyword">new</span> <span class="keyword">File</span>(newFile.getParent()).mkdirs();</span><br><span class="line">              </span><br><span class="line">            FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(newFile);             </span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> len;</span><br><span class="line">            <span class="keyword">while</span> ((len = zis.<span class="keyword">read</span>(buffer)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">       		fos.<span class="keyword">write</span>(buffer, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line">        		</span><br><span class="line">            fos.close();   </span><br><span class="line">            ze = zis.getNextEntry();</span><br><span class="line">    	&#125;</span><br><span class="line">    	</span><br><span class="line">        zis.closeEntry();</span><br><span class="line">    	zis.close();</span><br><span class="line">    		</span><br><span class="line">    	System.out.<span class="keyword">println</span>(<span class="string">"Done"</span>);</span><br><span class="line">    		</span><br><span class="line">    &#125;<span class="keyword">catch</span>(IOException ex)&#123;</span><br><span class="line">       ex.printStackTrace(); </span><br><span class="line">    &#125;</span><br><span class="line">   &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法二">方法二</h3><ul>
<li>GBK编码，支持中文，zip格式</li>
<li>压缩</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.<span class="keyword">File</span>; </span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream; </span><br><span class="line"><span class="keyword">import</span> java.io.IOException; </span><br><span class="line"><span class="keyword">import</span> java.io.InputStream; </span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset; </span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry; </span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> zip &#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[]) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">      <span class="keyword">File</span> inFile = <span class="keyword">new</span> <span class="keyword">File</span>(<span class="string">"D:\\test.txt"</span>); </span><br><span class="line">      ZipOutputStream zos = <span class="keyword">new</span> ZipOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\test.zip"</span>), Charset.forName(<span class="string">"GBK"</span>));</span><br><span class="line">      </span><br><span class="line">      zos.setComment(<span class="string">"ziped by Ming Cheng."</span>); </span><br><span class="line">      zipFile(inFile, zos, <span class="string">""</span>); </span><br><span class="line">      zos.close(); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> zipFile(<span class="keyword">File</span> inFile, ZipOutputStream zos, String dir) <span class="keyword">throws</span> IOException &#123; </span><br><span class="line">        <span class="keyword">if</span> (inFile.isDirectory()) &#123; </span><br><span class="line">            <span class="keyword">File</span>[] files = inFile.listFiles(); </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">File</span> <span class="keyword">file</span>:files) </span><br><span class="line">                zipFile(<span class="keyword">file</span>, zos, dir + <span class="string">"\\"</span> + inFile.getName()); </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            String entryName = <span class="keyword">null</span>; </span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">""</span>.equals(dir)) </span><br><span class="line">                entryName = dir + <span class="string">"\\"</span> + inFile.getName(); </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                entryName = inFile.getName(); </span><br><span class="line">                </span><br><span class="line">            ZipEntry entry = <span class="keyword">new</span> ZipEntry(entryName); </span><br><span class="line">            zos.putNextEntry(entry); </span><br><span class="line">            </span><br><span class="line">            InputStream is = <span class="keyword">new</span> FileInputStream(inFile); </span><br><span class="line">            <span class="keyword">int</span> len = <span class="number">0</span>; </span><br><span class="line">            <span class="keyword">while</span> ((len = is.<span class="keyword">read</span>()) != -<span class="number">1</span>) </span><br><span class="line">                zos.<span class="keyword">write</span>(len); </span><br><span class="line">                </span><br><span class="line">            is.close(); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解压</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.File;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileInputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.FileOutputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.IOException;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.InputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.io.OutputStream;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.nio.charset.Charset;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipEntry;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipFile;</span> </span><br><span class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.zip.ZipInputStream;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Unzip</span> </span>&#123; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[]) throws IOException &#123; </span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"D:\\test.zip"</span>);</span><br><span class="line">        ZipFile zipFile = <span class="keyword">new</span> ZipFile(file, Charset.forName(<span class="string">"GBK"</span>));</span><br><span class="line"></span><br><span class="line">        ZipInputStream zipInputStream = <span class="keyword">new</span> ZipInputStream(<span class="keyword">new</span> FileInputStream(file), Charset.forName(<span class="string">"GBK"</span>)); </span><br><span class="line">        unpack(zipFile, zipInputStream); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> unpack(ZipFile zipFile, ZipInputStream zipInputStream) throws IOException &#123; </span><br><span class="line"></span><br><span class="line">        ZipEntry zipEntry = <span class="literal">null</span>; </span><br><span class="line">        <span class="keyword">while</span> ((zipEntry = zipInputStream.getNextEntry()) != <span class="literal">null</span>) &#123; </span><br><span class="line">            String fileName = zipEntry.getName(); </span><br><span class="line">            File temp = <span class="keyword">new</span> File(<span class="string">"D:\\Test\\"</span> + fileName); </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (! temp.getParentFile().exists()) </span><br><span class="line">                temp.getParentFile().mkdirs(); </span><br><span class="line"></span><br><span class="line">            OutputStream os = <span class="keyword">new</span> FileOutputStream(temp); </span><br><span class="line">            InputStream <span class="keyword">is</span> = zipFile.getInputStream(zipEntry); </span><br><span class="line"></span><br><span class="line">            int len = <span class="number">0</span>; </span><br><span class="line">            System.out.println(zipEntry.getName()); </span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> ((len = <span class="keyword">is</span>.read()) != -<span class="number">1</span>) </span><br><span class="line">                os.write(len); </span><br><span class="line"></span><br><span class="line">            os.close(); </span><br><span class="line">            <span class="keyword">is</span>.close(); </span><br><span class="line">        &#125; </span><br><span class="line">        zipInputStream.close(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Java/">Java</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-math" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/27/js-math/" class="article-date">
  	<time datetime="2015-10-26T16:00:00.000Z" itemprop="datePublished">2015-10-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/27/js-math/">javascript 数学函数汇总</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>javascript中数学函数十分强大，能够帮助我们完成大多数常用的数学计算任务；</li>
<li>本文汇总了这些常用的数学函数；</li>
</ul>
<h3 id="基本计算">基本计算</h3><p><img src="/images/js-math/math1.png" alt="math1"></p>
<h3 id="科学计算">科学计算</h3><p><img src="/images/js-math/math2.png" alt="math2"></p>
<h3 id="实用技巧">实用技巧</h3><ul>
<li>快速得出number数组的最大最小值：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">math</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">6</span>];</span><br><span class="line">	<span class="keyword">var</span> max = <span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">	<span class="keyword">var</span> min = <span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取n-m之间的随机数（包含n和m）</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">math</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> num = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*m + n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-array" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/27/js-array/" class="article-date">
  	<time datetime="2015-10-26T16:00:00.000Z" itemprop="datePublished">2015-10-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/27/js-array/">javascript 数组操作总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>数组是javascript中的重要数据结构，可以存储各种数据类型，有很多重要的操作必须牢记；</li>
<li>本文系统总结了javascript数组的各种常见操作，欢迎补充！</li>
</ul>
<h3 id="javascript数组需要掌握的方法">javascript数组需要掌握的方法</h3><ul>
<li>push、pop </li>
<li>shift、unshift </li>
<li>splice、slice </li>
<li>concat、join、sort、reverse</li>
<li>这些方法在下面会详细介绍</li>
</ul>
<h3 id="数组的定义">数组的定义</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法一，定义后赋值</span></span><br><span class="line">var arr = <span class="keyword">new</span> Array();</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">123</span></span><br><span class="line">arr[<span class="number">1</span>] = <span class="string">"abc"</span></span><br><span class="line">arr[<span class="number">5</span>] = <span class="function"><span class="literal">false</span></span><br><span class="line"><span class="title">alert</span><span class="params">(arr[<span class="number">3</span>])</span> <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//方法二，定义数组长度</span></span><br><span class="line">var arr2 </span>= <span class="keyword">new</span> Array(<span class="number">2</span>);</span><br><span class="line">arr2[<span class="number">0</span>] = <span class="string">"ddd"</span>;</span><br><span class="line">arr2[<span class="number">1</span>] = <span class="number">123</span>;</span><br><span class="line">arr2[<span class="number">4</span>] = <span class="literal">false</span>;  <span class="comment">//数组长度自动扩展</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//方法三，定义时赋值</span></span><br><span class="line">var arr3 = <span class="keyword">new</span> Array(<span class="literal">true</span>,<span class="number">123</span>,<span class="string">"aaa"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法四，直接赋值</span></span><br><span class="line">var arr4 = [<span class="string">"aaa"</span>,<span class="number">111</span>,<span class="literal">false</span>];</span><br></pre></td></tr></table></figure>
<h3 id="数组的判断">数组的判断</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.isArray(arr);  <span class="comment">//true</span></span><br><span class="line">arr <span class="keyword">instanceof</span> <span class="built_in">Array</span>;  <span class="comment">//true</span></span><br><span class="line">arr.constructor === <span class="built_in">Array</span>;  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<h3 id="数组元素的合并">数组元素的合并</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'d'</span>];</span><br><span class="line">document.<span class="keyword">write</span>(arr.<span class="keyword">join</span>());  <span class="comment">//c,b,d</span></span><br><span class="line">document.<span class="keyword">write</span>(arr.<span class="keyword">join</span>(<span class="string">"."</span>));  <span class="comment">//c.b.d</span></span><br></pre></td></tr></table></figure>
<h3 id="数组的属性">数组的属性</h3><ul>
<li>length属性</li>
</ul>
<figure class="highlight rsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'d'</span>];</span><br><span class="line">alert(arr.<span class="built_in">length</span>);  <span class="comment">//3</span></span><br><span class="line">arr.<span class="built_in">length</span> = <span class="number">10</span>;  <span class="comment">// 数组自动扩展</span></span><br><span class="line">arr.<span class="built_in">length</span> = <span class="number">2</span>;  <span class="comment">//arr[2]丢失</span></span><br></pre></td></tr></table></figure>
<ul>
<li>prototype属性</li>
</ul>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function <span class="built_in">max</span>()&#123;</span><br><span class="line">	var i,</span><br><span class="line">	<span class="built_in">max</span> = <span class="keyword">this</span>[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;<span class="keyword">this</span>.length; i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">max</span>&lt;<span class="keyword">this</span>[i])&#123;</span><br><span class="line">			<span class="built_in">max</span> = <span class="keyword">this</span>[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">Array</span>.prototype.<span class="built_in">max</span> = <span class="built_in">max</span>;</span><br><span class="line">var x = <span class="keyword">new</span> <span class="keyword">Array</span>(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>);</span><br><span class="line">alert(x.<span class="built_in">max</span>());  <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<h3 id="数组常见操作">数组常见操作</h3><ul>
<li>添加元素</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="string">"aaa"</span>,<span class="literal">false</span>];</span><br><span class="line">arr.push(<span class="number">3</span>);  <span class="comment">//添加到末尾</span></span><br><span class="line">arr.unshift(<span class="string">'c'</span>);  <span class="comment">//添加到开头，其余元素后移</span></span><br><span class="line">arr.splice(<span class="number">1</span>,<span class="number">0</span>,<span class="string">'d'</span>);  <span class="comment">//插入到数组下表为1的位置，并且有0个元素被吃掉</span></span><br></pre></td></tr></table></figure>
<ul>
<li>删除元素</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="string">"aaa"</span>,<span class="literal">false</span>];</span><br><span class="line">arr.pop();  <span class="comment">//移除最后一个元素</span></span><br><span class="line">arr.shift();  <span class="comment">//移除最前面的元素并返回该元素的值</span></span><br><span class="line">arr.splice(<span class="number">1</span>,<span class="number">1</span>);  <span class="comment">//移除下标为1开始的1个元素</span></span><br><span class="line"><span class="keyword">delete</span> arr[<span class="number">2</span>];  <span class="comment">//移除下标为2的元素</span></span><br></pre></td></tr></table></figure>
<ul>
<li>移除特定元素</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>];</span><br><span class="line"><span class="keyword">var</span> <span class="keyword">index</span> = null;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span>; i&lt;arr.length; i++)<span class="comment">&#123;</span><br><span class="line">	if(arr[i]=='c')&#123;</span><br><span class="line">		index = i;</span><br><span class="line">	&#125;</span></span><br><span class="line">&#125;</span><br><span class="line">arr.splice(<span class="keyword">index</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>截取数组</li>
</ul>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="atom">var</span> <span class="atom">arr</span> = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>];</span><br><span class="line"><span class="atom">arr</span>.<span class="atom">slice</span>(<span class="number">1</span>,<span class="number">3</span>);  // [<span class="string">'b'</span>,<span class="string">'c'</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>连接数组</li>
</ul>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="atom">var</span> <span class="atom">arr</span> = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>];</span><br><span class="line"><span class="atom">var</span> <span class="atom">arr2</span> = [<span class="string">'f'</span>,<span class="string">'g'</span>];</span><br><span class="line"><span class="atom">arr</span>.<span class="atom">concat</span>(<span class="atom">arr2</span>);  // [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>拷贝数组</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.<span class="keyword">concat</span>();</span><br></pre></td></tr></table></figure>
<ul>
<li>数组排序</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'e'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>];</span><br><span class="line">alert(arr.sort());  <span class="comment">// a b c d e</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数组倒序</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'e'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>];</span><br><span class="line">alert(arr.<span class="keyword">reverse</span>());  <span class="comment">// e d c b a</span></span><br></pre></td></tr></table></figure>
<ul>
<li>判断数组是否包含特定值</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'e'</span>,<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'d'</span>,<span class="string">'c'</span>];</span><br><span class="line">alert(arr.indexOf(<span class="string">'d'</span>));  <span class="comment">// 3</span></span><br><span class="line">alert(arr.indexOf(<span class="string">'g'</span>));  <span class="comment">// -1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>求number数组最大最小值</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">math</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">var</span> max = <span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">    <span class="keyword">var</span> min = <span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组去重">数组去重</h3><ul>
<li>方法一：<ul>
<li>利用数组的indexOf方法</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr) &#123;</span><br><span class="line"> <span class="keyword">var</span> <span class="literal">result</span> = []; </span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++)</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="literal">result</span>.indexOf(arr[i]) == -<span class="number">1</span>) <span class="literal">result</span>.push(arr[i]);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法二：<ul>
<li>利用hash表</li>
<li>可能会出现字符串和数字一样的话出错，如var a = [1, 2, 3, 4, ‘3’, 5],会返回[1, 2, 3, 4, 5]</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> hash = &#123;&#125;,<span class="literal">result</span> = []; </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++)</span><br><span class="line">  &#123;</span><br><span class="line">     <span class="keyword">if</span> (!hash[arr[i]]) </span><br><span class="line">     &#123;</span><br><span class="line">         hash[arr[i]] = <span class="literal">true</span>; </span><br><span class="line">         <span class="literal">result</span>.push(arr[i]); </span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法三：<ul>
<li>排序后比较相邻，如果一样则放弃，否则加入到result</li>
<li>会出现与方法2一样的问题，如果数组中存在1,1,’1’这样的情况，则会排错</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr) &#123;</span><br><span class="line">  arr.sort();</span><br><span class="line">  <span class="keyword">var</span> <span class="literal">result</span>=[arr[<span class="number">0</span>]];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; arr.length; i++)&#123;</span><br><span class="line">      <span class="keyword">if</span>( arr[i] !== arr[i-<span class="number">1</span>]) &#123;</span><br><span class="line">          <span class="literal">result</span>.push(arr[i]);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法四：<ul>
<li>最简单但是效率最低的算法,也不会出现方法2和方法3出现的bug</li>
</ul>
</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function unique (arr) &#123;</span><br><span class="line">  <span class="keyword">if</span>(arr.length == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">var</span> <span class="literal">result</span> = [arr[<span class="number">0</span>]], isRepeate;</span><br><span class="line">  <span class="keyword">for</span>( <span class="keyword">var</span> i = <span class="number">0</span>, j = arr.length; i &lt; j; i++ )&#123;</span><br><span class="line">    isRepeate = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>( <span class="keyword">var</span> k = <span class="number">0</span>, h = <span class="literal">result</span>.length; k &lt; h; k++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="literal">result</span>[k] === arr[i])&#123;</span><br><span class="line">            isRepeate = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k == h) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( !isRepeate ) <span class="literal">result</span>.push(arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组随机扰乱">数组随机扰乱</h3><ul>
<li>方法一：<ul>
<li>每次随机抽一个数并移动到新数组中</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">shuffle</span><span class="params">(<span class="built_in">array</span>)</span> </span>&#123;</span><br><span class="line">  var copy = [],</span><br><span class="line">       n = <span class="built_in">array</span>.length,</span><br><span class="line">       i;</span><br><span class="line">  <span class="comment">// 如果还剩有元素则继续。。。</span></span><br><span class="line">  <span class="keyword">while</span> (n) &#123;</span><br><span class="line">     <span class="comment">// 随机抽取一个元素</span></span><br><span class="line">     i = Math.<span class="built_in">floor</span>(Math.random() * <span class="built_in">array</span>.length);</span><br><span class="line">     <span class="comment">// 如果这个元素之前没有被选中过。。</span></span><br><span class="line">     <span class="keyword">if</span> (i in <span class="built_in">array</span>) &#123;</span><br><span class="line">        copy.push(<span class="built_in">array</span>[i]);</span><br><span class="line">        <span class="keyword">delete</span> <span class="built_in">array</span>[i];</span><br><span class="line">        n--;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法二：<ul>
<li>跟方法1类似，只不过通过splice来去掉原数组已选项</li>
</ul>
</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function shuffle(array) &#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="keyword">copy</span> = [],</span><br><span class="line">       <span class="keyword">n</span> = array.length,</span><br><span class="line">       i;</span><br><span class="line">  <span class="comment">// 如果还剩有元素。。</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="keyword">n</span>) &#123;</span><br><span class="line">     <span class="comment">// 随机选取一个元素</span></span><br><span class="line">     i = Math.<span class="literal">floor</span>(Math.random() * <span class="keyword">n</span>--);</span><br><span class="line">     <span class="comment">// 移动到新数组中</span></span><br><span class="line">     <span class="keyword">copy</span>.push(array.splice(i, 1)[0]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">copy</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>方法三：<ul>
<li>前面随机抽数依次跟末尾的数交换，后面依次前移</li>
<li>即：第一次前n个数随机抽一个跟第n个交换，第二次前n-1个数跟第n-1个交换，依次类推</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shuffle</span><span class="params">(array)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> m = <span class="keyword">array</span>.length,</span><br><span class="line">     t, i;</span><br><span class="line">  <span class="comment">// 如果还剩有元素…</span></span><br><span class="line">  <span class="keyword">while</span> (m) &#123;</span><br><span class="line">    <span class="comment">// 随机选取一个元素…</span></span><br><span class="line">    i = Math.floor(Math.random() * m--);</span><br><span class="line">    <span class="comment">// 与当前元素进行交换</span></span><br><span class="line">    t = <span class="keyword">array</span>[m];</span><br><span class="line">    <span class="keyword">array</span>[m] = <span class="keyword">array</span>[i];</span><br><span class="line">    <span class="keyword">array</span>[i] = t;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">array</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组间操作">数组间操作</h3><ul>
<li>数组求交集</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用filter和数组自带的indexOf方法</span></span><br><span class="line">array1.filter(<span class="function"><span class="keyword">function</span><span class="params">(n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array2.indexOf(n) != -<span class="number">1</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>数组求并集</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法原理：连接两个数组并去重</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arrayUnique</span><span class="params">(<span class="keyword">array</span>)</span> <span class="comment">&#123;</span><br><span class="line">  var a = array.concat();</span><br><span class="line">  for(var i=0; i&lt;a.length; ++i) &#123;</span><br><span class="line">    for(var j=i+1; j&lt;a.length; ++j) &#123;</span><br><span class="line">       if(a[i] === a[j])</span><br><span class="line">          a.splice(j--, 1);</span><br><span class="line">    &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title">return</span> <span class="title">a</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>数组求差集</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用filter和indexOf方法</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.diff = <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.filter(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;<span class="keyword">return</span> a.indexOf(i) &lt; <span class="number">0</span>;&#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-function" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/26/js-function/" class="article-date">
  	<time datetime="2015-10-25T16:00:00.000Z" itemprop="datePublished">2015-10-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/26/js-function/">javascript 函数解析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>javascript中，函数是重要的机制，可以避免页面载入时执行该脚本，这些代码只能被事件激活，或者在函数被调用时才会执行；</li>
<li>本文总结了javascript函数的定义和调用方法，以供参考；</li>
</ul>
<h3 id="javascript函数的定义">javascript函数的定义</h3><ul>
<li>直接定义函数：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;   </span><br><span class="line">	alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过函数字面量定义</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span><span class="params">(x)</span></span>&#123;  </span><br><span class="line">    alert(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过构造函数定义：</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> func2 = <span class="keyword">new</span> <span class="function"><span class="keyword">Function</span><span class="params">(x,alert<span class="params">(x)</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="javascript函数的调用">javascript函数的调用</h3><ul>
<li>直接通过函数名调用：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;   </span><br><span class="line">    alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();          </span><br><span class="line"><span class="built_in">window</span>.onload = test();</span><br></pre></td></tr></table></figure>
<ul>
<li>通过变量调用：</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function test()&#123;   </span><br><span class="line">    alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable"><span class="keyword">var</span> fun</span> = test;  </span><br><span class="line"><span class="function"><span class="title">fun</span><span class="params">()</span>;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>下面两种方法可让函数自动执行</li>
</ul>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">(<span class="keyword">function</span> test<span class="list">()</span><span class="collection">&#123;   </span><br><span class="line">    alert<span class="list">(<span class="string">"..."</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span>)</span><span class="list">()</span></span><br><span class="line"></span><br><span class="line"><span class="list">(<span class="keyword">function</span> test<span class="list">()</span><span class="collection">&#123;   </span><br><span class="line">    alert<span class="list">(<span class="string">"..."</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span><span class="list">()</span>)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>下面的代码会发生错误，请注意括号</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;   <span class="comment">//error</span></span><br><span class="line">	alert(<span class="string">"..."</span>);</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-Closure" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/26/js-Closure/" class="article-date">
  	<time datetime="2015-10-25T16:00:00.000Z" itemprop="datePublished">2015-10-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/26/js-Closure/">JavaScript 闭包详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="js变量作用域">js变量作用域</h3><ul>
<li>变量的作用域无非就是两种：全局变量和局部变量；</li>
<li>Javascript语言的特殊之处，就在于函数内部可以直接读取全局变量：</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> n=<span class="number">999</span>;</span><br><span class="line">　　<span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">()</span><span class="comment">&#123;</span><br><span class="line">　　　　alert(n);</span><br><span class="line">　　&#125;</span></span><br><span class="line"><span class="title">f1</span><span class="params">()</span>;</span> <span class="comment">// 999</span></span><br></pre></td></tr></table></figure>
<ul>
<li>但是，在函数外部自然无法读取函数内的局部变量：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">()</span></span>&#123;</span><br><span class="line">　　　　<span class="keyword">var</span> n=<span class="number">999</span>;</span><br><span class="line">　　&#125;</span><br><span class="line">alert(n); <span class="comment">// error</span></span><br></pre></td></tr></table></figure>
<ul>
<li>除非不用var声明：</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span><span class="params">()</span><span class="comment">&#123;</span><br><span class="line">　　　　n=999;</span><br><span class="line">　　&#125;</span></span><br><span class="line">　　<span class="title">f1</span><span class="params">()</span>;</span></span><br><span class="line">alert(n); <span class="comment">// 999</span></span><br></pre></td></tr></table></figure>
<ul>
<li>总之，js中作用域是链式的，内部可获取外部变量，反之不行；</li>
<li>如果函数f2就被包括在函数f1内部，这时f1内部的所有局部变量，对f2都是可见的，但是反过来就不行，f2内部的局部变量，对f1就是不可见的；</li>
<li>既然f2可以读取f1中的局部变量，那么只要把f2作为返回值，我们不就可以在f1外部读取它的内部变量了吗；</li>
<li>这种打破常规，实现在函数外部访问函数私有变量的机制叫做闭包；</li>
</ul>
<h3 id="js什么时候进行垃圾回收？">js什么时候进行垃圾回收？</h3><ul>
<li>在javascript中，如果一个对象不再被引用，那么这个对象就会被GC回收；</li>
<li>如果两个对象互相引用，而不再被第3者所引用，那么这两个互相引用的对象也会被回收；</li>
</ul>
<h3 id="闭包（Closure）的定义">闭包（Closure）的定义</h3><ul>
<li>闭包就是能够读取其他函数内部变量的函数；</li>
<li>由于在Javascript语言中，只有函数内部的子函数才能读取局部变量，因此可以把闭包简单理解成”定义在一个函数内部的函数”；</li>
<li>在本质上，闭包就是将函数内部和函数外部连接起来的一座桥梁；</li>
</ul>
<h3 id="闭包的深入理解">闭包的深入理解</h3><p>看下面程序：</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">　　　　<span class="keyword">var</span> n=<span class="number">999</span>;</span><br><span class="line">　　　　nAdd=function()&#123;n+=<span class="number">1</span>&#125;</span><br><span class="line">　　　　function f2()&#123;</span><br><span class="line">　　　　　　alert(n);</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　　　<span class="keyword">return</span> f2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> <span class="literal">result</span>=f1();</span><br><span class="line"><span class="literal">result</span>(); // <span class="number">999</span></span><br><span class="line">nAdd();</span><br><span class="line"><span class="literal">result</span>(); // <span class="number">1000</span></span><br></pre></td></tr></table></figure>
<ul>
<li>result实际上就是闭包f2函数，它一共运行了两次，第一次的值是999，第二次的值是1000，这证明了，函数f1中的局部变量n一直保存在内存中，并没有在f1调用后被自动清除；</li>
<li>原因就在于f1是f2的父函数，而f2被赋给了一个全局变量，这导致f2始终在内存中（不满足上面任何一条垃圾回收条件），而f2的存在依赖于f1，因此f1也始终在内存中（不满足上面任何一条垃圾回收条件），不会在调用结束后被垃圾回收机制（garbage collection）回收；</li>
<li>这段代码中另一个值得注意的地方，就是”nAdd=function(){n+=1}”这一行；<ul>
<li>首先在nAdd前面没有使用var关键字，因此nAdd是一个全局变量，而不是局部变量；</li>
<li>其次，nAdd的值是一个匿名函数（anonymous function），而这个匿名函数本身也是一个闭包，所以nAdd相当于是一个setter，可以在函数外部对函数内部的局部变量进行操作；</li>
</ul>
</li>
</ul>
<h3 id="使用闭包需要注意">使用闭包需要注意</h3><ul>
<li>由于闭包会使得函数中的变量都被保存在内存中，内存消耗很大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露,解决方法是，在退出函数之前，将不使用的局部变量全部删除；</li>
<li>闭包会在父函数外部，改变父函数内部变量的值，所以如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值；</li>
</ul>
<hr>
<p>本文参考：<a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="external">学习Javascript闭包（Closure）</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-js-this" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/25/js-this/" class="article-date">
  	<time datetime="2015-10-24T16:00:00.000Z" itemprop="datePublished">2015-10-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/25/js-this/">JavaScript中this关键字详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>js中，this关键是令人头疼的问题，它的指代对象和this所处的上下文环境、函数调用者等多重因素有关；</li>
<li>我们要解决的问题是，this关键字代指哪个对象；</li>
<li>本文用丰富的实例让您清晰、明确的判断各种情况下，this关键字所指代的对象；</li>
</ul>
<h3 id="判断原则：">判断原则：</h3><ul>
<li>原则一：this指的是直接调用函数的那个对象，没有的话就值window；</li>
<li>原则二：this代指的对象就是它使用的时候（不是定义的时候）所处的环境的上下文；</li>
<li>原则三：当new关键字出现时，this指代new出来的那个对象；</li>
<li>this是js关键字，某些程序中出现的that仅仅是普通的变量，不是关键字；</li>
<li>下面，我们用实例说话，一一验证上述原则；</li>
</ul>
<h3 id="无对象调用函数时this指代window的例子">无对象调用函数时this指代window的例子</h3><ul>
<li>例一：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</span><br><span class="line">    alert(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line">test();  <span class="comment">//1</span></span><br><span class="line">alert(x);  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例二：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line">test();  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例三：</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">test();  </span><br><span class="line">alert(x); <span class="comment">//0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例四：</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = 0;</span><br><span class="line">function <span class="keyword">test</span>()&#123;</span><br><span class="line">    alert(this.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line">o.x = 1;</span><br><span class="line">o.<span class="keyword">m</span> = <span class="keyword">test</span>;</span><br><span class="line">o.<span class="keyword">m</span>.apply();  <span class="comment">//0  apply参数为空时，默认调用全局对象，故this指向window</span></span><br><span class="line">o.<span class="keyword">m</span>.apply(o);  <span class="comment">//1  test函数的调用者是o，故this指代对象o</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例五：<ul>
<li>执行第一个this时，function调用者为obj，故this指代obj对象；</li>
<li>执行f函数和匿名函数时，函数没有直接的调用者，故this指代window；</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> context = <span class="string">"global"</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> obj = &#123;  </span><br><span class="line">    context: <span class="string">"object"</span>,</span><br><span class="line">    method: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;  </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);  <span class="comment">// [object Object]:object</span></span><br><span class="line"> </span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> context = <span class="string">"function"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);   <span class="comment">// [object Window]:global</span></span><br><span class="line">        &#125;;</span><br><span class="line">        f(); </span><br><span class="line"> </span><br><span class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> context = <span class="string">"function"</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span> + <span class="string">":"</span> +<span class="keyword">this</span>.context);  <span class="comment">// [object Window]:global</span></span><br><span class="line">        &#125;)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">obj.method();</span><br></pre></td></tr></table></figure>
<h3 id="有对象调用函数时this指代调用函数者的例子">有对象调用函数时this指代调用函数者的例子</h3><ul>
<li>例一:<ul>
<li>o调用了test函数，故this指代对象o</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123;&#125;;</span><br><span class="line">o.x = <span class="number">1</span>;</span><br><span class="line">o.m = test;</span><br><span class="line">o.m();  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例二：<ul>
<li>getInfo()函数的调用者是ext1，this指代ext1；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this1.png" alt="this1"></p>
<ul>
<li>例三：<ul>
<li>getInfo()函数的调用者是ext1，this指代ext1；</li>
<li>this.id和this.name都是代指ext1对象的id和name，但是由于ext1对象本身没有name属性，所以需要到原型链上查找name属性；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this2.png" alt="this2"></p>
<ul>
<li>例四：<ul>
<li>内层的funcion中包含了this，但是，内层function没有直接调用者；</li>
<li>故这里的this指window；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this3.png" alt="this3"></p>
<ul>
<li>例五：<ul>
<li>object对象调用了外层函数，所以var that = this中的this指代object对象，执行完此句后，that也指代object对象；</li>
<li>that并不是js的关键字，仅仅是一个普通的变量，所以下面return that.name的时候，返回的是object.name；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this4.png" alt="this4"></p>
<ul>
<li>例六：<ul>
<li>object对象直接调用了外层的function，故var that = this中的this指代object对象，执行完此句后，that也指代object对象；</li>
<li>内层function没有直接调用者，故内层函数中的this指代window；</li>
</ul>
</li>
</ul>
<p><img src="/images/js-this/this5.png" alt="this5"></p>
<ul>
<li>例七：<ul>
<li>point对象调用moveTo方法，故this指代point对象；</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var point = &#123; </span><br><span class="line"> x : <span class="number">0</span>, </span><br><span class="line"> y : <span class="number">0</span>, </span><br><span class="line"> moveTo : function(x, y) &#123; </span><br><span class="line">     <span class="keyword">this</span>.x = <span class="keyword">this</span>.x + x; </span><br><span class="line">     <span class="keyword">this</span>.y = <span class="keyword">this</span>.y + y; </span><br><span class="line">     &#125; </span><br><span class="line"> &#125;;</span><br><span class="line">point.moveTo(<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line">console.<span class="built_in">log</span>(point.x);  <span class="comment">//1</span></span><br><span class="line">console.<span class="built_in">log</span>(point.y);  <span class="comment">//1</span></span><br><span class="line">console.<span class="built_in">log</span>(x);  <span class="comment">//x is not defined</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例八：<ul>
<li>moveX和moveY函数没有调用者，所以其中的this指代window，而不是point对象；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point = &#123; </span><br><span class="line"> x : <span class="number">0</span>, </span><br><span class="line"> y : <span class="number">0</span>, </span><br><span class="line"> moveTo : <span class="function"><span class="keyword">function</span><span class="params">(x, y)</span> </span>&#123; </span><br><span class="line">     <span class="keyword">var</span> moveX = <span class="function"><span class="keyword">function</span><span class="params">(x)</span> </span>&#123; </span><br><span class="line">         <span class="keyword">this</span>.x = x;</span><br><span class="line">     &#125;; </span><br><span class="line"></span><br><span class="line">     <span class="keyword">var</span> moveY = <span class="function"><span class="keyword">function</span><span class="params">(y)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">     &#125;; </span><br><span class="line">    </span><br><span class="line">     moveX(x); </span><br><span class="line">     moveY(y); </span><br><span class="line">    &#125; </span><br><span class="line"> &#125;; </span><br><span class="line"> point.moveTo(<span class="number">1</span>,<span class="number">1</span>); </span><br><span class="line"> point.x; <span class="comment">//=&gt;0 </span></span><br><span class="line"> point.y; <span class="comment">//=&gt;0 </span></span><br><span class="line"> x; <span class="comment">//=&gt;1 </span></span><br><span class="line"> y; <span class="comment">//=&gt;1</span></span><br></pre></td></tr></table></figure>
<h3 id="this指代new出来的那个对象">this指代new出来的那个对象</h3><ul>
<li>例一：<ul>
<li>由于存在new关键字，this指代的对象是new出来的对象，即对象o；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> test();</span><br><span class="line">alert(o.x);  <span class="comment">//1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例二：<ul>
<li>this指代对象o，而不是window；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">2</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> test();</span><br><span class="line">alert(x);  <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例三：<ul>
<li>np对象是new出来的，所以this指代np对象；</li>
<li>p对象不是new出来的，且Point函数无调用者，故this指代window；</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params">x,y</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">this</span>.x = x; </span><br><span class="line">    <span class="keyword">this</span>.y = y; </span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">var</span> np=<span class="keyword">new</span> Point(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">np.x;  <span class="comment">//1</span></span><br><span class="line"><span class="keyword">var</span> p=Point(<span class="number">2</span>,<span class="number">2</span>);</span><br><span class="line">p.x;  <span class="comment">//error, p是一个空对象undefined</span></span><br><span class="line"><span class="built_in">window</span>.x;  <span class="comment">//2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例四：<ul>
<li>apply使得Point函数的调用者为p2，故this指代p2对象；</li>
</ul>
</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span><span class="params">(x, y)</span></span>&#123; </span><br><span class="line">    <span class="keyword">this</span>.x = x; </span><br><span class="line">    <span class="keyword">this</span>.y = y; </span><br><span class="line">    <span class="keyword">this</span>.moveTo = <span class="function"><span class="keyword">function</span><span class="params">(x, y)</span></span>&#123; </span><br><span class="line">        <span class="keyword">this</span>.x = x; </span><br><span class="line">        <span class="keyword">this</span>.y = y; </span><br><span class="line">    &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Point(<span class="number">0</span>, <span class="number">0</span>); </span><br><span class="line"><span class="keyword">var</span> p2 = &#123;x: <span class="number">0</span>, y: <span class="number">0</span>&#125;; </span><br><span class="line">p1.moveTo.apply(p2, [<span class="number">10</span>, <span class="number">10</span>]);  <span class="comment">//apply实际上为p2.moveTo(10,10)</span></span><br><span class="line">p2.x;   <span class="comment">//10</span></span><br></pre></td></tr></table></figure>
<h3 id="bind/call/apply重定向this关键字指向">bind/call/apply重定向this关键字指向</h3><ul>
<li>例一：<ul>
<li>apply和call将函数的调用者转变了，所以this指代的对象随之转变；</li>
<li>bind创建一个新的函数，这个函数中的this对象指代的内容也由bind函数指定；</li>
</ul>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">add</span><span class="params">(numA, numB)</span></span>&#123;</span><br><span class="line">  console.<span class="built_in">log</span>( <span class="keyword">this</span>.original + numA + numB);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// NaN</span></span><br><span class="line"> </span><br><span class="line">var obj = &#123;original: <span class="number">10</span>&#125;;</span><br><span class="line">add.apply(obj, [<span class="number">1</span>, <span class="number">2</span>]);  <span class="comment">// 13</span></span><br><span class="line">add.call(obj, <span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// 13</span></span><br><span class="line"> </span><br><span class="line">var f1 = add.bind(obj);</span><br><span class="line">f1(<span class="number">2</span>, <span class="number">3</span>);  <span class="comment">// 15</span></span><br><span class="line"> </span><br><span class="line">var f2 = add.bind(obj, <span class="number">2</span>);</span><br><span class="line">f2(<span class="number">3</span>);  <span class="comment">// 15</span></span><br></pre></td></tr></table></figure>
<h3 id="js事件中的this指代">js事件中的this指代</h3><ul>
<li>例一：<ul>
<li>前面的一个，console调用者是button对象，故this指代button对象；</li>
<li>中间的一个，匿名函数没有直接调用者，所以this指代window；</li>
<li>第三个，通过bind重定向函数中的this指向，所以this代表button对象；</li>
</ul>
</li>
</ul>
<figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="transposed_variable">document.</span>write(<span class="string">'&lt;button onclick="</span><span class="transposed_variable">console.</span>log(this)<span class="string">"&gt;Show this&lt;/button&gt;'</span>);</span><br><span class="line"><span class="comment">// &lt;button onclick="console.log(this)"&gt;Show this&lt;/button&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="transposed_variable">document.</span>write(<span class="string">'&lt;button onclick="</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(this)</span>;&#125;)<span class="params">()</span>"&gt;<span class="title">Show</span> <span class="title">this</span>&lt;/<span class="title">button</span>&gt;');</span></span><br><span class="line"><span class="comment">// window</span></span><br><span class="line"></span><br><span class="line"><span class="transposed_variable">document.</span>write(<span class="string">'&lt;button onclick="</span>((<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(this)</span>;&#125;).<span class="title">bind</span><span class="params">(this)</span>)<span class="params">()</span>"&gt;<span class="title">Show</span> <span class="title">this</span>&lt;/<span class="title">button</span>&gt;');</span></span><br><span class="line"><span class="comment">// &lt;button onclick="((function()&#123;console.log(this);&#125;).bind(this))()"&gt;Show this&lt;/button&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>其他的js事件中的this关键字指代请参考<a href="http://mp.weixin.qq.com/s?__biz=MzAxODE2MjM1MA==&amp;mid=400742840&amp;idx=1&amp;sn=c2c389f831c29fd98c54297bc6a3b9e8&amp;3rd=MzA3MDU4NTYzMw==&amp;scene=6#rd" target="_blank" rel="external">这里</a>；</li>
</ul>
<h3 id="this关键字指代对象的暂存方法">this关键字指代对象的暂存方法</h3><ul>
<li>说明：<ul>
<li>有些时候希望在this指代正确的对象的时候将this指代的对象暂存起来，备用；</li>
</ul>
</li>
<li>例一：<ul>
<li>下面程序将this指代的bar对象暂存到self对象中；</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;</span><br><span class="line">    name: <span class="string">"bar"</span>,</span><br><span class="line">    body: <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>],</span><br><span class="line"> </span><br><span class="line">    greeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hi there, I'm "</span> + <span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;,</span><br><span class="line"> </span><br><span class="line">    anotherMethod: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">this</span>.body.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            self.greeting();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">bar.anotherMethod();   <span class="comment">// Hi there, I'm [object Object]:bar</span></span><br></pre></td></tr></table></figure>
<ul>
<li>上面的程序也可以用bind实现：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bar = &#123;</span><br><span class="line">    name: <span class="string">"bar"</span>,</span><br><span class="line">    body: <span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>],</span><br><span class="line"> </span><br><span class="line">    greeting: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Hi there, I'm "</span> + <span class="keyword">this</span> + <span class="string">":"</span> + <span class="keyword">this</span>.name);</span><br><span class="line">    &#125;,</span><br><span class="line"> </span><br><span class="line">    anotherMethod: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.body.addEventListener(<span class="string">"click"</span>, (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.greeting();</span><br><span class="line">        &#125;).bind(<span class="keyword">this</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">bar.anotherMethod();   <span class="comment">// Hi there, I'm [object Object]:bar</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/7/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Eric Chang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
	
	<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/cn/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/">知识共享署名 3.0 中国大陆许可协议</a>进行许可。
	
	<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','1BK1VZMDEA-ktxiBz_9B');
</script>

<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258423514'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1258423514%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
          
	
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>