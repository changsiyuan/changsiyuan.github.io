<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Eric Chang&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="~爱前端，爱生活~">
<meta property="og:type" content="website">
<meta property="og:title" content="Eric Chang's Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Eric Chang's Blog">
<meta property="og:description" content="~爱前端，爱生活~">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Eric Chang's Blog">
<meta name="twitter:description" content="~爱前端，爱生活~">
  
    <link rel="alternative" href="/atom.xml" title="Eric Chang&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">


	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/images/me.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/" style="font-family: Microsoft Yahei;">Eric Chang</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">归档</a></li>
				        
							<li><a href="/tags/feeling">感悟</a></li>
				        
							<li><a href="/tags/me">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/changsiyuan" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/2803286360" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="mailto:changsiyuan2011@126.com" title="mail">mail</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/preview?locale=zh_CN&trk=prof-0-sb-preview-primary-button" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Angularjs/" style="font-size: 11.25px;">Angularjs</a> <a href="/tags/DevOps/" style="font-size: 10px;">DevOps</a> <a href="/tags/Flask/" style="font-size: 10px;">Flask</a> <a href="/tags/JSONP/" style="font-size: 10px;">JSONP</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/JavaScript/" style="font-size: 18.75px;">JavaScript</a> <a href="/tags/Latex/" style="font-size: 10px;">Latex</a> <a href="/tags/Linkedlist/" style="font-size: 11.25px;">Linkedlist</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Operating-System/" style="font-size: 10px;">Operating System</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/RESTful/" style="font-size: 10px;">RESTful</a> <a href="/tags/Safety/" style="font-size: 10px;">Safety</a> <a href="/tags/Tree/" style="font-size: 11.25px;">Tree</a> <a href="/tags/Web/" style="font-size: 17.5px;">Web</a> <a href="/tags/books/" style="font-size: 11.25px;">books</a> <a href="/tags/computer/" style="font-size: 11.25px;">computer</a> <a href="/tags/cooking/" style="font-size: 11.25px;">cooking</a> <a href="/tags/css/" style="font-size: 12.5px;">css</a> <a href="/tags/datebase/" style="font-size: 13.75px;">datebase</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/feeling/" style="font-size: 17.5px;">feeling</a> <a href="/tags/git/" style="font-size: 11.25px;">git</a> <a href="/tags/glassfish/" style="font-size: 10px;">glassfish</a> <a href="/tags/hadoop/" style="font-size: 16.25px;">hadoop</a> <a href="/tags/hardware/" style="font-size: 10px;">hardware</a> <a href="/tags/hdfs/" style="font-size: 10px;">hdfs</a> <a href="/tags/html/" style="font-size: 11.25px;">html</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/jQuery/" style="font-size: 12.5px;">jQuery</a> <a href="/tags/javaEE/" style="font-size: 10px;">javaEE</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/mail/" style="font-size: 10px;">mail</a> <a href="/tags/mapreduce/" style="font-size: 13.75px;">mapreduce</a> <a href="/tags/me/" style="font-size: 10px;">me</a> <a href="/tags/network/" style="font-size: 10px;">network</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/others/" style="font-size: 11.25px;">others</a> <a href="/tags/psychology/" style="font-size: 11.25px;">psychology</a> <a href="/tags/publicity/" style="font-size: 10px;">publicity</a> <a href="/tags/selenium/" style="font-size: 10px;">selenium</a> <a href="/tags/translation/" style="font-size: 11.25px;">translation</a> <a href="/tags/travel/" style="font-size: 11.25px;">travel</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.yinshuisiyuan.net/">我的主页</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/home.html">阮一峰</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/">Github</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://azure.microsoft.com/en-us/?v=17.14">Azure</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000">Python</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434501245426ad4b91f2b880464ba876a8e3043fc8ef000">Nodejs</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我叫常思源，毕业于北京邮电大学，目前就职于斯伦贝谢技术有限公司。专注DevOps和持续交付。快速学习，注重细节，追求卓越！</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Eric Chang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/images/me.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Eric Chang</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">归档</a></li>
		        
					<li><a href="/tags/feeling">感悟</a></li>
		        
					<li><a href="/tags/me">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/changsiyuan" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/2803286360" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="mailto:changsiyuan2011@126.com" title="mail">mail</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/profile/preview?locale=zh_CN&trk=prof-0-sb-preview-primary-button" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2016-5-7-BFT-DFT" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/07/2016-5-7-BFT-DFT/" class="article-date">
  	<time datetime="2016-05-06T16:00:00.000Z" itemprop="datePublished">2016-05-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/07/2016-5-7-BFT-DFT/">树的广度优先遍历和深度优先遍历</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>本文介绍了树的广度优先和深度优先遍历，并给出程序。</li>
</ul>
<h3 id="原理">原理</h3><ul>
<li>广度优先遍历（BFT breadth-first traversal）：广度优先遍历是连通图的一种遍历策略，它的思想是从一个顶点V0开始，辐射状地优先遍历其周围较广的区域，故得名。树的广度优先遍历是指优先遍历完某一层的所有节点，然后再依次向下层遍历。</li>
<li>深度优先遍历（DFT depth-first traversal）：树的深度优先遍历是指首先遍历树的某个分支上的所有节点，在遍历另一个分支的节点，对于节点中的分支也这样处理。</li>
<li>广度优先和深度优先各有其侧重点，在不同的情境下可以选择使用。</li>
<li>本文不讨论广度优先和深度优先的适用场景，只给出两者的具体实现java代码，以供参考。</li>
</ul>
<h3 id="代码">代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">package test;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayDeque;</span><br><span class="line">import java.util.Queue;</span><br><span class="line">import java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Test &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//树的节点的定义</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> TreeNode &#123;</span><br><span class="line">		<span class="keyword">int</span> val;</span><br><span class="line">		TreeNode left;</span><br><span class="line">		TreeNode right;</span><br><span class="line"></span><br><span class="line">		TreeNode(<span class="keyword">int</span> x) &#123;</span><br><span class="line">			val = x;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//构建树</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title">BinaryTree</span><span class="params">(<span class="keyword">int</span>[] <span class="built_in">array</span>)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> makeBinaryTreeByArray(<span class="built_in">array</span>, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TreeNode <span class="title">makeBinaryTreeByArray</span><span class="params">(<span class="keyword">int</span>[] <span class="built_in">array</span>, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (index &lt; <span class="built_in">array</span>.length) &#123;</span><br><span class="line">			<span class="keyword">int</span> value = <span class="built_in">array</span>[index];</span><br><span class="line">			<span class="keyword">if</span> (value != <span class="number">0</span>) &#123;</span><br><span class="line">				TreeNode t = <span class="keyword">new</span> TreeNode(value);</span><br><span class="line">				<span class="built_in">array</span>[index] = <span class="number">0</span>;</span><br><span class="line">				t.left = makeBinaryTreeByArray(<span class="built_in">array</span>, index * <span class="number">2</span>);</span><br><span class="line">				t.right = makeBinaryTreeByArray(<span class="built_in">array</span>, index * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">				<span class="keyword">return</span> t;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">levelOrderTraversal</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 用队列</span></span><br><span class="line">		<span class="keyword">if</span> (root == null) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Queue&lt;TreeNode&gt; q1 = <span class="keyword">new</span> ArrayDeque&lt;&gt;();</span><br><span class="line">		q1.add(root);</span><br><span class="line">		<span class="keyword">while</span> (!q1.isEmpty()) &#123;</span><br><span class="line">			TreeNode tmp = q1.poll();</span><br><span class="line">			System.out.print(tmp.val+<span class="string">" "</span>);</span><br><span class="line">			<span class="keyword">if</span> (tmp.left != null) &#123;</span><br><span class="line">				q1.add(tmp.left);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (tmp.right != null) &#123;</span><br><span class="line">				q1.add(tmp.right);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">depthOrderTraversal</span><span class="params">(TreeNode root)</span></span>&#123;</span><br><span class="line">		<span class="comment">// 用栈</span></span><br><span class="line">		<span class="keyword">if</span>(root==null)&#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		Stack&lt;TreeNode&gt; s = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">		s.push(root);</span><br><span class="line">		<span class="keyword">while</span>(!s.isEmpty())&#123;</span><br><span class="line">			TreeNode tmp = s.pop();</span><br><span class="line">			System.out.print(tmp.val+<span class="string">" "</span>);</span><br><span class="line">			<span class="keyword">if</span>(tmp.right!=null)&#123;</span><br><span class="line">				s.push(tmp.right);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(tmp.left!=null)&#123;</span><br><span class="line">				s.push(tmp.left);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	 <span class="comment">/**  </span><br><span class="line">     *                  13 </span><br><span class="line">     *                 /  \ </span><br><span class="line">     *               65    5 </span><br><span class="line">     *              /  \    \ </span><br><span class="line">     *             97  25   37 </span><br><span class="line">     *            /    /\   / </span><br><span class="line">     *           22   4 28 32 </span><br><span class="line">     */</span>  </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] arr = &#123;<span class="number">0</span>,<span class="number">13</span>,<span class="number">65</span>,<span class="number">5</span>,<span class="number">97</span>,<span class="number">25</span>,<span class="number">0</span>,<span class="number">37</span>,<span class="number">22</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">28</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">32</span>,<span class="number">0</span>&#125;;</span><br><span class="line">		TreeNode root = BinaryTree(arr);</span><br><span class="line">		levelOrderTraversal(root);  <span class="comment">//13 65 5 97 25 37 22 4 28 32 </span></span><br><span class="line">		System.out.print(<span class="string">"\n"</span>);</span><br><span class="line">		depthOrderTraversal(root);  <span class="comment">//13 65 97 22 25 4 28 5 37 32 </span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/">Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tree/">Tree</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Algorithm/">Algorithm</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-5-6-database-design" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/06/2016-5-6-database-design/" class="article-date">
  	<time datetime="2016-05-05T16:00:00.000Z" itemprop="datePublished">2016-05-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/06/2016-5-6-database-design/">数据库设计原则</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>本文小结了数据设计原则；</li>
<li>数据库设计对于数据库的可维护性、可扩展性至关重要，某些原则必须严格遵守；</li>
</ul>
<h3 id="数据库设计范式">数据库设计范式</h3><ul>
<li>第一范式：属性具有原子性，不可再分解，即不能表中有表；</li>
<li>第二范式：唯一性约束，每条记录有唯一标示，所有的非主键字段均需依赖于主键字段；</li>
<li>第三范式：冗余性约束，非主键字段间不能相互依赖；</li>
</ul>
<h3 id="数据库设计原则">数据库设计原则</h3><ul>
<li>完整性：<ul>
<li><code>not null</code>声明禁止插入空值；</li>
<li><code>check</code>子句限制属性域；</li>
</ul>
</li>
<li>去冗余：<ul>
<li>避免冗余属性，冗余属性会带来数据不一致性；</li>
<li>学生选课系统中，老师可以开课、学生可以选课，数据库设计中，课程可以由课程编号和课程名称等确定；</li>
<li>如果现在维护两个表，一个表A存储课程信息（课程编号、名称、简介、学分、院系等），另一个表B存储开课信息（有哪些课程开课），如果B中重复存储了A的课程名称、简介、学分、院系等信息，一旦A中的信息更新，B中和A中信息便出现不一致；</li>
<li>正确的做法是，B中只存储课程编号，并以此和A相关联；</li>
</ul>
</li>
<li>解耦合：<ul>
<li>一个表只存储它应该存储的信息，和此表无关的信息放到另一个表去存储，表之间尽量解耦；</li>
<li>上面的例子中，A中存储且只存储面向课程的信息，另外有表C，存储且只存储面向学生的信息（学号、姓名、性别、年龄、选课id等），对于“课程级别”的信息，应当坚决的存储在A而不是C中，而且尽量避免将A、C合并成一个表（可能刚开始是设计成一个表），而且A、C间尽量解耦；</li>
</ul>
</li>
<li>字段不可再分：<ul>
<li>一个字段中不要出现分隔符，或者在一个字段中存储多个信息;</li>
<li>例如，first name和last name不要放在同一个字段中，稳定版本号和临时版本号不要放在同一个字段中；</li>
</ul>
</li>
<li>考虑性能：<ul>
<li>上述原则可能造成多表连接查询的情况出现，降低性能；</li>
<li>如果性能成为主要矛盾，则上述原则也不绝对；</li>
</ul>
</li>
</ul>
<h3 id="数据库命名原则">数据库命名原则</h3><ul>
<li>数据库的命名会直接影响到上层应用的名称，所以要和业务部门仔细讨论、慎重确定；</li>
<li>每个属性名在数据库中只有唯一的含义，number这个属性名可能表示电话号码或是房间号，这是一种容易引起歧义的命名；</li>
<li>数据库的名词要一致，不能在这个地方叫一个名字，到另外一个表又叫另外一个名字；</li>
<li>一般来说，Table命名用单数，Column命名用单数；</li>
<li>Table不用Prefix前缀来表示不同的组，而用schema来划分命名空间（postgresql中）；</li>
<li>命名用snake_case，不要有其他特殊字符；</li>
<li>名称中不要有<a href="http://www.postgresql.org/docs/9.3/static/sql-keywords-appendix.html" target="_blank" rel="external">sql关键字</a>；</li>
<li>如果确实需要使用sql关键字，可用双引号包围，比如<code>CREATE TABLE &quot;order&quot;(...)</code>；</li>
<li>主键的名字永远都是同一的，就是id，外键名称才需要加table的名字，诸如<code>xxx_id</code>、<code>yyy_id</code>；</li>
<li>命名不要用缩写，比如date缩写成dt；</li>
<li>用    <code>create_date/update_date/sample_date</code>这些含义更明确的名称代替date这个命名，这样不仅表达更准确，而且避免了用关键字的麻烦；</li>
<li>timestamp类型的字段要有timezone（时区），字段名用<code>xxx_date</code>的形式，仅表示年月日用<code>xxx_day</code>，仅表示时分秒用<code>xxx_time</code>；</li>
<li>表示数量、次数等概念的字段名称最好写为<code>xxx_count</code>，不要写为<code>xxx_number/xxx_num/xxx_no</code>等；</li>
<li>boolean类型的命名要用<code>is_xxx</code>格式；</li>
</ul>
<h3 id="数据库设计其他注意事项">数据库设计其他注意事项</h3><ul>
<li>每个表都要有主键，名称是id，类型为<code>bigint</code>；</li>
<li>主键的类型是设为integer还是long，取决于这个系统用多长时间，如果要用100年，主键还是设置为long类型较好，这样用的很久以后id也不会超出范围；</li>
<li>一个字段不要有多个用途，空间不是问题，清晰才是重点；</li>
<li>不要过早优化，先把东西做出来再说，遇到性能问题再去优化；</li>
<li>对于<code>varchar</code>类型的字段，当字符串并不是非常明确到底限制是多少的时候，通常选择255这个长度，<code>varchar(50)</code>并不比<code>varchar(255)</code>节省空间，<code>varchar(50)</code>仅仅是表示最多分配50个字符而已；</li>
<li><code>varchar(100)</code>类型在PostgreSQL中代表100个字符，而在Oracle中代表100字节，具体的占用空间数目和语言、编码方式有关；</li>
<li>对外键要加Index；</li>
<li>数据库里面的密码一定要加密，不能保存明文；</li>
<li>用<code>is_deleted=true</code>来表示本条记录的业务上的删除，不要在数据库中真正删除记录，或者仅仅是版本化修改，这样能防止数据丢失；</li>
</ul>
<h3 id="数据库性能提升方案">数据库性能提升方案</h3><ul>
<li>使用索引会大大提升查询效率，同时降低在被索引的表上INSERT和DELETE效率；</li>
<li>分离频繁和不频繁使用的数据到多个表中；<ul>
<li>例如，原先，一个表中保存用户名、密码、年龄、个人简介、学校等信息，但是发现访问用户名、密码、年龄的频率远高于其他字段，此时就应当将这个表分为两个表，分别存储频繁访问项和非频繁访问项；</li>
</ul>
</li>
</ul>
<h3 id="数据库安全策略">数据库安全策略</h3><ul>
<li>至少保存3个月的系统访问日志； </li>
<li>数据库中的表可以有创建和更新时间戳，及所创建/修改行的用户标示； </li>
<li>不删除字段，而是打上一个被删除的标记； </li>
<li>版本化修改；</li>
</ul>
<h3 id="大型数据库设计">大型数据库设计</h3><ul>
<li>负载均衡；</li>
<li>读写分离；</li>
<li>分布式存储；</li>
<li>参考<a href="http://www.cnblogs.com/ejiyuan/archive/2010/10/29/1796292.html" target="_blank" rel="external">这篇文章</a>；</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/datebase/">datebase</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/datebase/">datebase</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-5-2-database-search" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/02/2016-5-2-database-search/" class="article-date">
  	<time datetime="2016-05-01T16:00:00.000Z" itemprop="datePublished">2016-05-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/02/2016-5-2-database-search/">数据库查询优化方案小结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>本文小结了数据查询的优化方案；</li>
</ul>
<h3 id="查询耗时点">查询耗时点</h3><ul>
<li>解析SQL语句时间；</li>
<li>磁盘存取（查询所用CPU时间）；</li>
<li>磁盘IO；</li>
<li>并行/分布式数据库的网络通信时间；</li>
<li>其中，磁盘存取一般认为是耗时最多的点；</li>
</ul>
<h3 id="数据库层面的优化">数据库层面的优化</h3><ul>
<li>优化器设计（可将用户输入语句转换为等价的效率更高的执行语句）；</li>
<li>优化索引设计；</li>
<li>优化查询算法：<ul>
<li>在等价的查询语句中，选择读磁盘最少的那个；</li>
<li>对于简单的查询语句，可通过线性扫描和搜索引擎处理；</li>
<li>对于复杂的查询，将它转换为简单查询的并和交；</li>
<li>用外部归并排序算法对大于内存的关系进行排序；</li>
</ul>
</li>
</ul>
<h3 id="用户层面的优化">用户层面的优化</h3><ul>
<li>避免出现SELECT * FROM table 语句，要明确查出的字段；</li>
<li>在一个SQL语句中，如果一个where条件过滤的数据库记录越多，定位越准确，则该where条件越应该前移；</li>
<li>使用内层限定原则，在拼写SQL语句时，将查询条件分解、分类，并尽量在SQL语句的最里层进行限定，以减少数据的处理量；</li>
<li>在判断有无符合条件的记录时建议不要用SELECT COUNT （*）和select top 1 语句；</li>
<li>小心使用 IN 和 OR，需要注意In集合中的数据量，建议集合中的数据不超过200个；</li>
<li>应绝对避免在order by子句中使用表达式；</li>
<li><code>&lt;&gt;</code> 用 <code>&lt;</code> 、 <code>&gt;</code> 代替，<code>&gt;</code>用<code>&gt;=</code>代替，<code>&lt;</code>用<code>&lt;=</code>代替，这样可以有效的利用索引；</li>
<li>如果需要从关联表读数据，关联的表一般不要超过7个；</li>
<li>在一个事务中，对同一个表的多个insert语句应该集中在一起执行；</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/datebase/">datebase</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/datebase/">datebase</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-5-1-database-transaction" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/01/2016-5-1-database-transaction/" class="article-date">
  	<time datetime="2016-04-30T16:00:00.000Z" itemprop="datePublished">2016-05-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/01/2016-5-1-database-transaction/">数据库事务</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>事务是数据库的重要概念；</li>
<li>事务处理是数据库的核心机制之一；</li>
<li>本文总结数据库事务的相关概念；</li>
<li>事务的概念可参考<a href="http://mp.weixin.qq.com/s?__biz=MzA5ODM5MDU3MA==&amp;mid=2650861576&amp;idx=1&amp;sn=939459b313ef2e709840f98de0c4221f&amp;scene=0#wechat_redirect" target="_blank" rel="external">这篇文章</a></li>
</ul>
<h3 id="事务的性质">事务的性质</h3><ul>
<li>事务是数据库并发控制的基本单元；</li>
<li>事务是一个操作序列，不可分割，要么都执行，要么都不执行；</li>
<li>事务开始前和结束后，数据库中的数据应当保持一致性；</li>
<li>对数据库修改的多个事务彼此隔离，每个事务不应当影响或依赖其他事务；</li>
</ul>
<h3 id="数据库事务的四个特性及含义">数据库事务的四个特性及含义</h3><table>
<thead>
<tr>
<th>性质</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>原子性（atomicity）</td>
<td>一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节；<br>事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样；<br>可以维护一个日志（或快照）记录事务执行前数据库的状态，如果事务执行失败，则回滚到事务执行前的状态；<br>转账时，不可能发生转出账户扣款了，转入账户未到账的情况；</td>
</tr>
<tr>
<td>一致性（consistency）</td>
<td>在事务开始之前和事务结束以后，数据库的完整性没有被破坏；<br>转账时，账户总金额不能多也不能少，保持一致性；</td>
</tr>
<tr>
<td>隔离性（isolation）</td>
<td>数据库允许多个并发事务同时对齐数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致；<br>事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable），下面详细讲了；</td>
</tr>
<tr>
<td>持久性（durability）</td>
<td>事务处理结束后，对数据的修改就是永久的，即便系统出现故障，即真正持久化到数据库中；</td>
</tr>
</tbody>
</table>
<h3 id="事务执行进度">事务执行进度</h3><ul>
<li>begin：开始执行事务；</li>
<li>aborted：事务执行一半终止了；</li>
<li>roll back：事务已经回滚；</li>
<li>commited：事务已提交，即执行成功，已经持久化到数据库中；</li>
</ul>
<h3 id="事务并发产生的问题">事务并发产生的问题</h3><ul>
<li>脏读：<ul>
<li>一个事务读取了另一个事务操作但未提交的数据；</li>
<li>事务T1更新了数据还未提交，这时事务T2来读取相同的数据，则T2读到的数据其实是错误的数据，即脏数据，如果T1回滚的话，T2读到的数据是不可靠的；</li>
<li>基于脏数据所作的操作是不可能正确的；</li>
</ul>
</li>
<li>丢失更新：<ul>
<li>事务T1读取了数据，并执行了一些操作，然后更新数据，事务T2也做相同的事，则T1和T2更新数据时可能会覆盖对方的更新，从而引起错误； </li>
<li>用排他锁解决；</li>
</ul>
</li>
<li>不可重复读：<ul>
<li>一个事务中的多个相同的查询返回了不同数据；</li>
<li>一个事务的两次读取中，读取相同的资源得到不同的值，当事务T2在事务T1的两次读取之间更新数据，则会发生此种错误（重点在修改）；</li>
<li>用共享锁解决；</li>
</ul>
</li>
<li>幻读：<ul>
<li>事务并发执行时，其中一个事务对另一个事务中操作的结果集的影响；</li>
<li>事务T1对一定范围内执行操作，T2对相同的范围内执行不兼容的操作，这时会发生幻读；</li>
<li>T1删除符合条件C1的所有数据，T2又插入了一些符合条件C1的数据，则在T1中再次查找符合条件C1的数据还是可以查到，这对T1来说好像是幻觉一样，这时的读取操作称为幻读（重点在新增或删除）；</li>
<li>用排它锁解决；</li>
</ul>
</li>
</ul>
<h3 id="事务隔离级别">事务隔离级别</h3><ul>
<li>下面是数据库事务从高到低的四个隔离级别；</li>
</ul>
<table>
<thead>
<tr>
<th>级别名称</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>可串行化（Serializable）</td>
<td>提供严格的事务隔离；<br>它要求事务序列化执行，事务只能一个接着一个地执行，不能并发执行;</td>
</tr>
<tr>
<td>可重复读（Repeatable Read）</td>
<td>事务T1读取一个数据块，另外，事务T2在事务T1未commit的情况下，试图写同样的数据块，此时，T2的写操作会被阻塞，直到T1commit后，写操作才被commit进入数据库；</td>
</tr>
<tr>
<td>已提交读（Read committed）</td>
<td>事务T1读取一个数据块，另外，事务T2在事务T1未commit的情况下，成功对同样的数据块进行写操作并commit，事务T1再读这个数据块时，结果和前一次不同；<br>即允许事务T1在两次读操作期间，其他事务对相同的数据块进行写操作；</td>
</tr>
<tr>
<td>未提交读（Read uncommitted）</td>
<td>事务T1在事务T2对于一个数据块的写操作未commit的情况下，可以读取T2修改后的结果；</td>
</tr>
</tbody>
</table>
<ul>
<li>数据库事务隔离级别分别存在的并发问题</li>
</ul>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>是否存在脏读</th>
<th>是否存在不可重复读</th>
<th>是否存在幻读</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read uncommitted</td>
<td>存在</td>
<td>存在</td>
<td>存在</td>
</tr>
<tr>
<td>Read committed</td>
<td>不存在</td>
<td>存在</td>
<td>存在</td>
</tr>
<tr>
<td>Repeatable Read</td>
<td>不存在</td>
<td>不存在</td>
<td>存在</td>
</tr>
<tr>
<td>Serializable</td>
<td>不存在</td>
<td>不存在</td>
<td>不存在</td>
</tr>
</tbody>
</table>
<ul>
<li>以上所有的隔离级别都不允许脏写（一个数据项已经被另外一个尚未提交或中止的事务写入，则不允许对该数据项执行写操作）；</li>
<li>数据库隔离界别越高，并发性能越低；</li>
</ul>
<h3 id="事务并发的处理方法">事务并发的处理方法</h3><ul>
<li>共享锁（S锁）：<ul>
<li>获准共享锁的事务职能读取数据，不能修改数据；</li>
<li>如果事务T对数据A加上共享锁后，则其他事务只能对A再加共享锁，不能加排他锁；</li>
</ul>
</li>
<li>排他锁（X锁）：<ul>
<li>获准排他锁的事务既能读取数据，也能修改数据；</li>
<li>如果事务T对数据A加上排他锁后，则其他事务不能在对A加任何类型的封锁；</li>
</ul>
</li>
</ul>
<h3 id="死锁及其解决方法">死锁及其解决方法</h3><ul>
<li>死锁实例1：<ul>
<li>现有事务A和B；</li>
<li>A在b上拥有排它锁，B正在申请b上的共享锁，故B需要等待A释放b上的排它锁；</li>
<li>B在a上拥有共享锁，A正在申请a上的排它锁，故A需要等待B释放a上的共享锁；</li>
<li>A和B相互等待，形成死锁；</li>
</ul>
</li>
<li>死锁实例2：<ul>
<li>将数据库设置为可重复读的隔离级别；</li>
<li>事务A等待事务B执行完毕，以便commit对对象a的更改（B已经读取了a）；</li>
<li>事务B等待事务A执行完毕，以便commit对对象b的更改（A已经读取了b）；</li>
</ul>
</li>
<li>死锁的解决：<ul>
<li>必须有一个事务主动回滚；</li>
<li>回滚的事务自动释放了锁；</li>
<li>另一个未回滚的事务就可以继续向下执行；</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/datebase/">datebase</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/datebase/">datebase</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-4-9-angularjs-directive" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/09/2016-4-9-angularjs-directive/" class="article-date">
  	<time datetime="2016-04-08T16:00:00.000Z" itemprop="datePublished">2016-04-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/09/2016-4-9-angularjs-directive/">Angularjs 指令详解</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>angularjs有许多内置指令，这些指令主要用于操纵DOM、指定路由、绑定事件处理器、执行数据绑定等等；</li>
<li>angularjs不仅有丰富的内置指令，而且可以自定义指令，实现自己需要的功能；</li>
<li>angularjs指令系统是angularjs最重要的一个知识点，在本文中加以总结，如有不完善之处请您指出；</li>
<li>非常感谢慕课网的大漠穷秋老师，本文的很多代码复制自大漠穷秋老师在慕课网angularjs课程的示例代码；</li>
</ul>
<h3 id="内置指令">内置指令</h3><ul>
<li>angularjs以ng开头的指令均为内置指令，详见<a href="https://docs.angularjs.org/api/ng/directive" target="_blank" rel="external">官方文档</a>、<a href="http://www.atove.com/Article/Details/8FA45E956F366F46D3F87D054C5BA787" target="_blank" rel="external">内置指令总结</a>；</li>
<li>所有内置指令如下：</li>
</ul>
<p><img src="/images/angularjs-directive/in-build-directive.png" alt="in-build-directive"></p>
<h3 id="编写指令">编写指令</h3><ul>
<li>最简单的指令模板如下：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span> <span class="attribute">ng-app</span>=<span class="value">"testApp"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">type</span>=<span class="value">"text/css"</span> <span class="attribute">href</span>=<span class="value">"lib/bootstrap-3.3.1/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"testCtrl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">hello</span>&gt;</span><span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">hello</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"hello"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- directive:hello --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"lib/bootstrap-3.3.1/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"lib/angular-1.3.3/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"test.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//test.js</span></span><br><span class="line"><span class="keyword">var</span> mod = angular.module(<span class="string">'testApp'</span>, []);</span><br><span class="line"></span><br><span class="line">mod.directive(<span class="string">'hello'</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        restrict:<span class="string">'AEMC'</span>,</span><br><span class="line">        template:<span class="string">'&lt;div&gt;this is a directive test!&lt;/div&gt;'</span>,</span><br><span class="line">        replace:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>自定义指令参数</li>
</ul>
<p><img src="/images/angularjs-directive/directive-params.png" alt="directive-params"></p>
<ul>
<li>对自定义指令声明参数的说明：<ul>
<li>restrict：替换自定义元素类型，E（元素）、C（类）、A（属性）、M（注释）；</li>
<li>template：替换的模板，如<code>template: &lt;div&gt;this is a directive test.&lt;/div&gt;</code>;</li>
<li>templateURL: 替换的模板的URL，如<code>templateUrl: &#39;hello.html&#39;</code>;</li>
<li><code>replace:true</code>,将自定义标签的内容全部替换掉；</li>
<li><code>transclude:true</code>,自定义标签的内容不会被替换，而是被放置在template中的<code>&lt;div ng-transclude&gt;&lt;/div&gt;</code>中；</li>
<li><code>compile: function(){...}</code>,自定义compile函数，一般放置暴露给外部看的（比如其他directive）一些公共函数；</li>
<li><code>link: function(){...}</code>，自定义link函数，一般放置本directive中操纵DOM、添加事件监听器等的代码；</li>
<li>作用域问题：在上述代码中，四个被指令替换的DOM标签其实所在的是同一个作用域，这样做不太安全，如果需要将作用域分开，则在指令中添加<code>scope:{}</code>即可，下面会详细讲解；</li>
</ul>
</li>
</ul>
<h3 id="独立scope">独立scope</h3><ul>
<li>实现独立scope的方法是在指令中添加<code>scope:{}</code>即可；</li>
<li>代码如下，改动任意一个input标签的内容，其他的directive不受影响，即directive作用域独立：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"MyModule"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span>&gt;</span><span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span>&gt;</span><span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span>&gt;</span><span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span>&gt;</span><span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"IsolateScope.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//IsolateScope.js</span></span><br><span class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</span><br><span class="line">myModule.directive(<span class="string">"hello"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        restrict: <span class="string">'AE'</span>,</span><br><span class="line">        scope:&#123;&#125;,</span><br><span class="line">        template: <span class="string">'&lt;div&gt;&lt;input type="text" ng-model="userName"/&gt;&#123;&#123;userName&#125;&#125;&lt;/div&gt;'</span>,</span><br><span class="line">        replace: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="指令和controller的交互">指令和controller的交互</h3><ul>
<li>在link函数中完成简单的directive和controller的交互,下面程序实现了在link中添加事件监听器并调用controller的特定方法：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/ng-table.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">ng-app</span>=<span class="value">"myApp"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"myCtrl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span>&gt;</span>滑动加载<span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/jquery-2.1.4.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/ng-table.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="undefined"></span><br><span class="line"></span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line"><span class="keyword">var</span> mod = angular.module(<span class="string">'myApp'</span>, []);</span><br><span class="line"></span><br><span class="line">mod.controller(<span class="string">"myCtrl"</span>,<span class="function"><span class="keyword">function</span><span class="params">(<span class="variable">$scope</span>)</span></span>&#123;</span><br><span class="line">	<span class="variable">$scope</span>.loadData = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">		console.log(<span class="string">"正在加载数据"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">mod.directive(<span class="string">'hello'</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        restrict:<span class="string">'AEMC'</span>,  </span><br><span class="line">        link: <span class="function"><span class="keyword">function</span><span class="params">(scope, element, attr)</span></span>&#123;</span><br><span class="line">        	element.bind(<span class="string">"mouseenter"</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">        		scope.loadData();</span><br><span class="line">        	&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>一个指令也可同时调用多个controller的函数：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">title</span>&gt;</span><span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/ng-table.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">ng-app</span>=<span class="value">"myApp"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"myCtrl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span> <span class="attribute">howtoload</span>=<span class="value">"loadData()"</span>&gt;</span>滑动加载<span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"myCtrl2"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">hello</span> <span class="attribute">howtoload</span>=<span class="value">"loadData2()"</span>&gt;</span>滑动加载2<span class="tag">&lt;/<span class="title">hello</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/jquery-2.1.4.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/angular.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"js/ng-table.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"app.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="undefined"></span><br><span class="line"></span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">//app.js</span><br><span class="line"></span><br><span class="line">var mod = angular.module(<span class="string">'myApp'</span>, []);</span><br><span class="line"></span><br><span class="line">mod.controller(<span class="string">"myCtrl"</span>,<span class="keyword">function</span>(<span class="variable">$scope</span>)&#123;</span><br><span class="line">	<span class="variable">$scope</span>.loadData = function()&#123;</span><br><span class="line">		console.log(<span class="string">"正在加载数据"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">mod.controller(<span class="string">"myCtrl2"</span>,<span class="keyword">function</span>(<span class="variable">$scope</span>)&#123;</span><br><span class="line">	<span class="variable">$scope</span>.loadData2 = function()&#123;</span><br><span class="line">		console.log(<span class="string">"正在加载数据...2222"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">mod.directive(<span class="string">'hello'</span>,<span class="keyword">function</span>()&#123;</span><br><span class="line">    return&#123;</span><br><span class="line">        restrict:<span class="string">'AEMC'</span>,  </span><br><span class="line">        link: function(scope, element, attrs)&#123;</span><br><span class="line">        	element.bind(<span class="string">"mouseenter"</span>,function(event)&#123;</span><br><span class="line">        		scope.<span class="variable">$apply</span>(attrs.howtoload); //一律小写，不用驼峰法则，没有括号()</span><br><span class="line">        	&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="指令间通信">指令间通信</h3><ul>
<li>指令间通信的方法是：<code>scope: {}</code>定义独立作用域，<code>controller</code>暴露方法给别的指令，<code>require</code>引用其他指令；</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"MyModule"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"Directive&amp;Directive.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-md-3"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">superman</span> <span class="attribute">strength</span>&gt;</span>动感超人---力量<span class="tag">&lt;/<span class="title">superman</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-md-3"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">superman</span> <span class="attribute">strength</span> <span class="attribute">speed</span>&gt;</span>动感超人2---力量+敏捷<span class="tag">&lt;/<span class="title">superman</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-md-3"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">superman</span> <span class="attribute">strength</span> <span class="attribute">speed</span> <span class="attribute">light</span>&gt;</span>动感超人3---力量+敏捷+发光<span class="tag">&lt;/<span class="title">superman</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Directive&amp;Directive.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myModule = angular.module(<span class="string">"MyModule"</span>, []);</span><br><span class="line">myModule.directive(<span class="string">"superman"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        scope: &#123;&#125;,</span><br><span class="line">        restrict: <span class="string">'AE'</span>,</span><br><span class="line">        controller: <span class="function"><span class="keyword">function</span><span class="params">(<span class="variable">$scope</span>)</span> </span>&#123;</span><br><span class="line">            <span class="variable">$scope</span>.abilities = [];</span><br><span class="line">            this.addStrength = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="variable">$scope</span>.abilities.push(<span class="string">"strength"</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">            this.addSpeed = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="variable">$scope</span>.abilities.push(<span class="string">"speed"</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">            this.addLight = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="variable">$scope</span>.abilities.push(<span class="string">"light"</span>);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span><span class="params">(scope, element, attrs)</span> </span>&#123;</span><br><span class="line">            element.addClass(<span class="string">'btn btn-primary'</span>);</span><br><span class="line">            element.bind(<span class="string">"mouseenter"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                console.log(scope.abilities);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">myModule.directive(<span class="string">"strength"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="keyword">require</span>: <span class="string">'^superman'</span>,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span><span class="params">(scope, element, attrs, supermanCtrl)</span> </span>&#123;</span><br><span class="line">            supermanCtrl.addStrength();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">myModule.directive(<span class="string">"speed"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="keyword">require</span>: <span class="string">'^superman'</span>,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span><span class="params">(scope, element, attrs, supermanCtrl)</span> </span>&#123;</span><br><span class="line">            supermanCtrl.addSpeed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">myModule.directive(<span class="string">"light"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="keyword">require</span>: <span class="string">'^superman'</span>,</span><br><span class="line">        link: <span class="function"><span class="keyword">function</span><span class="params">(scope, element, attrs, supermanCtrl)</span> </span>&#123;</span><br><span class="line">            supermanCtrl.addLight();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="scope绑定">scope绑定</h3><ul>
<li><code>@</code>绑定：将当前属性作为字符串传递，实现绑定；<ul>
<li>下面代码中，<code>flavor:&#39;@&#39;</code>实现的功能可以由注释掉的link函数代替；</li>
</ul>
</li>
</ul>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"MyModule"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"MyCtrl"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">drink</span> <span class="attribute">flavor</span>=<span class="value">"</span></span></span><span class="expression">&#123;&#123;<span class="variable">ctrlFlavor</span>&#125;&#125;</span><span class="xml"><span class="tag"><span class="value">"</span>&gt;</span><span class="tag">&lt;/<span class="title">drink</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"ScopeAt.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var myModule = angular.module(<span class="string">"MyModule"</span>, []);</span><br><span class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="keyword">function</span>(<span class="variable">$scope</span>)&#123;</span><br><span class="line">	<span class="variable">$scope</span>.ctrlFlavor=<span class="string">"百威"</span>;</span><br><span class="line">&#125;])</span><br><span class="line">myModule.directive(<span class="string">"drink"</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">    	restrict:<span class="string">'AE'</span>,</span><br><span class="line">        scope:&#123;</span><br><span class="line">        	flavor:<span class="string">'@'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        template:<span class="string">"&lt;div&gt;&#123;&#123;flavor&#125;&#125;&lt;/div&gt;"</span></span><br><span class="line">        // ,</span><br><span class="line">        // link:function(scope,element,attrs)&#123;</span><br><span class="line">        // 	scope.flavor=attrs.flavor;</span><br><span class="line">        // &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>=</code>实现与父scope的属性双向绑定</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"MyModule"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"MyCtrl"</span>&gt;</span></span><br><span class="line">			Ctrl:</span><br><span class="line">			<span class="tag">&lt;<span class="title">br</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">ng-model</span>=<span class="value">"ctrlFlavor"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">br</span>&gt;</span></span><br><span class="line">			Directive:</span><br><span class="line">			<span class="tag">&lt;<span class="title">br</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">drink</span> <span class="attribute">flavor</span>=<span class="value">"ctrlFlavor"</span>&gt;</span><span class="tag">&lt;/<span class="title">drink</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"ScopeEqual.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var myModule = angular.module(<span class="string">"MyModule"</span>, []);</span><br><span class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="keyword">function</span>(<span class="variable">$scope</span>)&#123;</span><br><span class="line">	<span class="variable">$scope</span>.ctrlFlavor=<span class="string">"百威"</span>;</span><br><span class="line">&#125;])</span><br><span class="line">myModule.directive(<span class="string">"drink"</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">    	restrict:<span class="string">'AE'</span>,</span><br><span class="line">        scope:&#123;</span><br><span class="line">        	flavor:<span class="string">'='</span></span><br><span class="line">        &#125;,</span><br><span class="line">        template:<span class="string">'&lt;input type="text" ng-model="flavor"/&gt;'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>&amp;</code>：传递一个父scope的函数，稍后调用</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">ng-app</span>=<span class="value">"MyModule"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"utf-8"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span> <span class="attribute">href</span>=<span class="value">"css/bootstrap-3.0.0/css/bootstrap.css"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">ng-controller</span>=<span class="value">"MyCtrl"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">greeting</span> <span class="attribute">greet</span>=<span class="value">"sayHello(name)"</span>&gt;</span><span class="tag">&lt;/<span class="title">greeting</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">greeting</span> <span class="attribute">greet</span>=<span class="value">"sayHello(name)"</span>&gt;</span><span class="tag">&lt;/<span class="title">greeting</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="title">greeting</span> <span class="attribute">greet</span>=<span class="value">"sayHello(name)"</span>&gt;</span><span class="tag">&lt;/<span class="title">greeting</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"framework/angular-1.3.0.14/angular.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"ScopeAnd.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var myModule = angular.module(<span class="string">"MyModule"</span>, []);</span><br><span class="line">myModule.controller(<span class="string">'MyCtrl'</span>, [<span class="string">'$scope'</span>, <span class="keyword">function</span>(<span class="variable">$scope</span>)&#123;</span><br><span class="line">	<span class="variable">$scope</span>.sayHello=function(name)&#123;</span><br><span class="line">		alert(<span class="string">"Hello "</span>+name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;])</span><br><span class="line">myModule.directive(<span class="string">"greeting"</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">    	restrict:<span class="string">'AE'</span>,</span><br><span class="line">        scope:&#123;</span><br><span class="line">        	greet:<span class="string">'&amp;'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        template:<span class="string">'&lt;input type="text" ng-model="userName" /&gt;&lt;br/&gt;'</span>+</span><br><span class="line">        		 <span class="string">'&lt;button class="btn btn-default" ng-click="greet(&#123;name:userName&#125;)"&gt;Greeting&lt;/button&gt;&lt;br/&gt;'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="angularjs_初始化过程">angularjs 初始化过程</h3><ul>
<li>理解angularjs的初始化过程有助于我们进一步理解link和compile函数；</li>
<li>初始化过程如下：<ul>
<li>ng-app寻找angular作用边界，在ng-app作用域范围内创建<code>$rootScope</code>，以后各层级的<code>$scope</code>均在<code>$rootScope</code>基础上创建，实现树形作用域结构；</li>
<li>解析module中的各种组件名称对应的回调函数的注册表，回调函数不被执行，注册表中的组件均可被用于依赖注入；</li>
<li>controller立即执行；</li>
<li>Compile：根据从服务器获取的或者dierective中的HTML模板编译HTML，对指定的模板进行转换，生成Linking函数，此时DOM是静态DOM；</li>
<li>Link：将Compile结果与Scope结合，产生动态视图，包括在元素上注册时间监听，即动态DOM；</li>
<li>对于同一个指定的多个实例(如<code>ng-repeat</code>)，compile只会执行一次，而link对于指令的每个实例都会执行一次； </li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Angularjs/">Angularjs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-4-7-Operating-System" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/07/2016-4-7-Operating-System/" class="article-date">
  	<time datetime="2016-04-06T16:00:00.000Z" itemprop="datePublished">2016-04-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/07/2016-4-7-Operating-System/">操作系统重点概念汇总</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>最近利用下班的空闲时间看了看《现代操作系统》，感觉讲得非常好，虽然某些细节仍不理解，但是受益匪浅，让我对计算机有了全新的认识；</li>
<li>这篇博客总结了操作系统的基本概念，如果以后有用到其中的知识，我准备再深入研究细节；</li>
</ul>
<h3 id="为什么要有操作系统">为什么要有操作系统</h3><ul>
<li>空间上，为上层应用程序提供一个清晰的、一致的、友好的硬件抽象，由于硬件种类繁多，软件编写者不可能就各种不同的硬件接口编写不同版本的程序，所以屏蔽硬件的不一致性的任务就交给操作系统；</li>
<li>时间上，保证各个程序有序运行，并充分利用硬件资源，比如时分复用、线程调度等都是具体实现；</li>
</ul>
<h3 id="有关CPU的概念">有关CPU的概念</h3><ul>
<li>CPU的两种模式为内核态和用户态，为了安全，在内核态时CPU可使用全部硬件，用户态时不行；</li>
<li>每种CPU都有自己的指令集，用于执行取指、解码、执行的各个过程；</li>
<li>CPU有自己的寄存器，用于存储计算暂时结果，它比内存快很多；</li>
<li>时间多路复用/时分复用/多线程技术/超线程技术：CPU切换执行不同的线程，线程执行进度保存在程序计数器中（本质是一个寄存器），当切换到其他线程前，需要保存所有寄存器的状态，以便下次执行这个线程时重新装入这些寄存器的值；</li>
<li>流水线：CPU的取指、解码和执行单元相互分离，执行指令n时，可以对n+1条指令解码，并读取指令n+2；</li>
<li>超标量技术：CPU的取指、解码和执行这些指令级的运算的并行运算技术，实现超标量的物理基础是CPU的算术逻辑单元、位移单元、乘法器相互分离，可以并行执行多条指令；</li>
<li>多核技术：  一个CPU上装有多个小芯片，每个芯片能够独立完成取指、解码和执行等过程；</li>
</ul>
<h3 id="进程">进程</h3><ul>
<li>进程是正在执行的一个程序；</li>
<li>每个进程有其单独的地址空间，存有：可执行程序、程序的数据、程序的堆栈，如果进程申请的地址空间大于内存，则使用虚拟内存技术来解决；</li>
<li>每个进程有其单独的资源集，包含：程序计数器、堆栈指针、寄存器等；</li>
<li>运行过程：当一个CPU核心切换到某个进程时，为这个进程分配内存资源和CPU核执行时间资源（时间片），当时间片用完后，当前运行的指针被保存下来，进程被暂时挂起，CPU核切换到另一个进程执行；</li>
<li>守护进程：一种在后台执行的进程（电子邮件、web页面、新闻）；</li>
<li>句柄：父进程和子进程之间的通信；</li>
<li>进程状态：就绪、运行、阻塞，在这三种状态间切换叫做进程调度；</li>
<li>进程调度的例子：<ul>
<li>某一进程不能继续运行（如进程的输入尚未准备好）–阻塞；</li>
<li>某一进程运行时间太长，CPU需要切换到其他进程–就绪；</li>
<li>某一进程开始执行–运行；</li>
</ul>
</li>
</ul>
<h3 id="线程">线程</h3><ul>
<li>线程是比进程更小的一个概念，一个进程可以包含多个线程；</li>
<li>所线程共享其所在进程的地址空间、内存资源、全局变量、打开文件，但不能同时读取同一块内存（线程锁控制）；</li>
<li>线程自己拥有的只是一点在运行中必不可少的资源(如程序计数器,一组寄存器和栈)；</li>
<li>进程和线程的区别：<ul>
<li>进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响，而线程只是一个进程中的不同执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。</li>
<li>具体请参考<a href="http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html" target="_blank" rel="external">这篇文章</a>；</li>
</ul>
</li>
</ul>
<h3 id="进程间通信">进程间通信</h3><ul>
<li>为什么进程间要有通信机制？<ul>
<li>考察命令 <code>cat abc.txt | grep &quot;sss&quot;</code>，上述命令中，cat启动一个进程，这个进程的结果要传给grep启动的这个进程，这就需要进程间通信；</li>
<li>两个打印进程如果没有通信（CPU轮训执行这两个进程），同时向打印机的打印队列中放入待打印的文件名，并将打印队列的指针移动一位，就可能出现错误，比如A进程覆盖B进程的待打印文件；</li>
</ul>
</li>
<li>进程间的竞争问题的解决<ul>
<li>总的思想：阻止多个进程同时读写共享的数据；</li>
<li>临界区：进程的共享内存或共享文件成为临界区，不得使多个进程同时进入其临界区；</li>
</ul>
</li>
<li>临界区的具体实现方法：<ul>
<li>当一个进程进入临界区后，CPU屏蔽中断，此时，CPU无法切换到其他进程，直到当前进程退出临界区；</li>
<li>当一个进程进入临界区后，将锁变量设置为1，表示临界区内有进程，其他进程直到锁变量变为0后才能进入临界区；</li>
</ul>
</li>
<li>上述方法的缺点：<ul>
<li>如果当前临界区内有进程，则另一个想要进入临界区的进程就不得不等待，直到临界区内无进程，这非常耗时；</li>
<li>如果有一个高优先级H进程、低优先级L进程，L在临界区中，H在临界区外，H等待L退出临界区，但是由于L优先级比H低，L不会被调度、不会出临界区，则H一直在等待；</li>
</ul>
</li>
<li>信号量和互斥量：<ul>
<li>信号量和互斥量是两个非常重要的进程间通信的机制，两者不同，互斥量的本质是二元信号量；</li>
<li>信号量的例子：维护一个打印队列，最长队列为N，最短为0；生产者可以将打印文件名放入队列，消费者可从打印队列中取出文件名；生产者进程维护一个信号量记录队列中占用的槽总数，初始信号量为0，每放入一个信号量加一，信号量为N时生产者进程阻塞；消费者进程维护一个信号量记录队列中空的打印槽，初始信号量为N，每取出一个信号量减一，信号量为0时生产者进程阻塞；另外，为了保证生产者进程、消费者进程不同时修改打印队列（临界区），另外维护一个二元的信号量mutex（即互斥量），它的值只能为0或1，每当有进程进入临界区，其值为1，其他进程不能进入，进入临界区的进程退出后，mutex值变为0，其他进程可以进入临界区；</li>
<li>两者的区别：互斥量用于线程的互斥（二元，要么锁住，要么解锁），信号量用于线程的同步（多元）；从作用域来说，信号量是进程间或线程间(linux仅线程间)，互斥锁是线程间；</li>
</ul>
</li>
</ul>
<h3 id="进程调度">进程调度</h3><ul>
<li>为什要有进程调度？当CPU要选择执行哪个进程的时候，如果两个或多个进程处于就绪状态，这时就存在选择的问题，需要进程调度解决；</li>
<li>何时启动进程调度机制？<ul>
<li>在创建一个新进程后，决定运行父进程还是子进程；</li>
<li>在一个进程退出时，系统必须选择另外一个处于就绪状态的进程执行，否则会浪费CPU资源；</li>
<li>当一个进程阻塞时，必须选择另一个进程运行；</li>
<li>在一个I/O中断发生时，必须做出调度决策；</li>
</ul>
</li>
<li>进程调度的目标：<ul>
<li>公平：地位等价的进程占用CPU资源的程度应当差不多相等；</li>
<li>效率：让CPU以及I/O资源尽可能忙碌，所有部分不要闲着，这就需要对“CPU密集型进程”“I/O密集型进程”进行合理调度；</li>
</ul>
</li>
<li>进程调度的两种策略：<ul>
<li>非抢占式：CPU挑选一个进程，让它运行直至被阻塞（阻塞在IO或者等待另一个进程）或自行释放CPU；</li>
<li>抢占式：让一个进程运行一段时间，强行挂起该进程，让另一个进程运行；</li>
</ul>
</li>
<li>具体的进程调度策略：<ul>
<li>轮转调度：所有进程排成一个圆圈，转圈圈调度；</li>
<li>优先级调度：动态赋予进程优先级，优先级高的先执行；</li>
<li>多级队列调度：一个进程需要100个时间片才能完成，CPU每次执行它时只执行一个时间片的时间，如果采用轮转调度，要频繁的从磁盘取出和写入进程，但是如果该进程在第一次获得CPU时分配1个时间片、在第二次获得CPU时分配2个时间片、在第三次获得CPU时分配4个时间片、在第四次获得CPU时分配8个时间片等等，这样就能减少磁盘读写，提升CPU密集型的进程的执行效率，这就是多级队列调度；</li>
</ul>
</li>
<li>死锁：<ul>
<li>定义：如果一个进程集合中的每个进程都在等待只能由该进程集合中的其他进程才能引发的事件，那么该进程集合就是死锁的；</li>
<li>死锁的条件和避免死锁的方法有严格的逻辑推导，这里不再赘述；</li>
<li><a href="https://zh.wikipedia.org/wiki/哲学家就餐问题" target="_blank" rel="external">哲学家就餐问题</a></li>
</ul>
</li>
</ul>
<h3 id="存储管理">存储管理</h3><ul>
<li>直接使用物理地址的危害：<ul>
<li>用户程序可以寻址内存的每个字节，很容易破坏操作系统，除非有特殊的硬件保护；</li>
<li>如果每个用户程序都直接使用内存的所有物理地址，并行的执行多个用户程序变得困难；</li>
<li>解决方法：给每个用户进程分配单独的地址空间；</li>
</ul>
</li>
<li>地址空间：<ul>
<li>地址空间是对内存这个硬件的抽象；</li>
<li>具体实现：用基址寄存器和界限寄存器确定进程的地址空间，这两个寄存器是CPU的重要硬件；</li>
<li>交换技术（解决物理内存不够大的问题）：在物理内存不够大时，可以将目前未在执行的进程存回磁盘，运行时再调入内存；</li>
<li>虚拟内存（解决物理内存不够大的问题）：地址空间映射的物理内存在内存条上是不连续的、甚至有些在磁盘中，但是暴露给进程看的虚拟内存地址是连续的；</li>
</ul>
</li>
<li>虚拟内存/分页：<ul>
<li>每个进程拥有自己的地址空间；</li>
<li>这个地址空间被分为许多内部地址连续的块，即“页”，和页相关的信息存储在页表中；</li>
<li>每一页都能够映射到物理内存中，“页”在物理地址中称作“页框”，映射关系由内存管理单元（MMU）统一管理，如果要使用一个地址的数据，虚拟地址首先被送到MMU转换为物理地址；</li>
<li>必要时可以有多级的映射关系；</li>
<li>缺页中断：当MMU发现虚拟内存地址映射的物理地址不在内存中时，向CPU发送缺页中断；</li>
<li>页面置换：当发生缺页中断时，必须选择一个页面换出内存，这样才能将磁盘中需要的数据换入内存；</li>
<li>页面置换算法的效率问题：如果一个页面即将被使用但是被换出了内存，这样就很低效，为了提升效率，有如下的页面置换算法：最近未使用页面置换算法、先进先出算法、二次机会页面置换算法、时钟页面置换算法、最近最少使用页面置换算法；</li>
</ul>
</li>
<li>空闲内存管理：<ul>
<li>位图：内存被分为若干多个内存单元（几个字-几千字节都可以）进行管理；每个内存单元要么空闲、要么占用，以“0”“1”映射到位图中；搜索位图中的连续空闲地址比较耗时；</li>
<li>链表：维护一个链表，每个节点记录一块空闲的内存区域的起始地址、长度、指向下一个链表的指针；当两个空闲区域相邻时，将链表中的相邻两个结点合并即可；</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Operating-System/">Operating System</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/computer/">computer</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-3-30-Angularjs-source-code" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/30/2016-3-30-Angularjs-source-code/" class="article-date">
  	<time datetime="2016-03-29T16:00:00.000Z" itemprop="datePublished">2016-03-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/30/2016-3-30-Angularjs-source-code/">Angularjs 源码阅读体会</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="说明">说明</h3><ul>
<li>本文是我在阅读Angularjs源码时的一些体会，写出来分享给大家，不足之处请多多指正。</li>
<li>本文以angularjs 1.5.x版本源码为例；</li>
<li>本文参考：<a href="http://www.html-js.com/article/2364" target="_blank" rel="external">文章一</a>、<a href="http://angularjs.cn/A0AY" target="_blank" rel="external">系列分析文章</a></li>
</ul>
<h3 id="Angularjs在初始化的时候做了什么">Angularjs在初始化的时候做了什么</h3><h4 id="尝试绑定jQuery对象，如果没有则采用内置的jqLite(30561行)：">尝试绑定jQuery对象，如果没有则采用内置的jqLite(30561行)：</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//try to bind to jquery now so that one can write jqLite(document).ready()</span></span><br><span class="line"><span class="comment">//but we will rebind on bootstrap again.</span></span><br><span class="line"><span class="function">bindJQuery</span>();</span><br></pre></td></tr></table></figure>
<h4 id="publishExternalAPI初始化angular环境,这也是angularjs实现其重要特性–扩展指令、依赖注入的重要步骤："><code>publishExternalAPI</code>初始化angular环境,这也是angularjs实现其重要特性–扩展指令、依赖注入的重要步骤：</h4><ul>
<li>把一些基础api挂载到angular上(2455行)：</li>
</ul>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">extend(angular, &#123;</span><br><span class="line">    <span class="string">'bootstrap'</span>: bootstrap,</span><br><span class="line">    <span class="string">'copy'</span>: copy,</span><br><span class="line">    <span class="string">'extend'</span>: extend,</span><br><span class="line">    <span class="string">'merge'</span>: merge,</span><br><span class="line">    <span class="string">'equals'</span>: equals,</span><br><span class="line">    <span class="string">'element'</span>: jqLite,</span><br><span class="line">    <span class="string">'forEach'</span>: forEach,</span><br><span class="line">    <span class="string">'injector'</span>: createInjector,</span><br><span class="line">    <span class="string">'noop'</span>: noop,</span><br><span class="line">    <span class="string">'bind'</span>: bind,</span><br><span class="line">    <span class="string">'toJson'</span>: toJson,</span><br><span class="line">    <span class="string">'fromJson'</span>: fromJson,</span><br><span class="line">    <span class="string">'identity'</span>: identity,</span><br><span class="line">    <span class="string">'isUndefined'</span>: isUndefined,</span><br><span class="line">    <span class="string">'isDefined'</span>: isDefined,</span><br><span class="line">    <span class="string">'isString'</span>: <span class="built_in">isString</span>,</span><br><span class="line">    <span class="string">'isFunction'</span>: isFunction,</span><br><span class="line">    <span class="string">'isObject'</span>: isObject,</span><br><span class="line">    <span class="string">'isNumber'</span>: <span class="built_in">isNumber</span>,</span><br><span class="line">    <span class="string">'isElement'</span>: isElement,</span><br><span class="line">    <span class="string">'isArray'</span>: <span class="built_in">isArray</span>,</span><br><span class="line">    <span class="string">'version'</span>: version,</span><br><span class="line">    <span class="string">'isDate'</span>: isDate,</span><br><span class="line">    <span class="string">'lowercase'</span>: lowercase,</span><br><span class="line">    <span class="string">'uppercase'</span>: uppercase,</span><br><span class="line">    <span class="string">'callbacks'</span>: &#123;counter: <span class="number">0</span>&#125;,</span><br><span class="line">    <span class="string">'getTestability'</span>: getTestability,</span><br><span class="line">    <span class="string">'$$minErr'</span>: minErr,</span><br><span class="line">    <span class="string">'$$csp'</span>: csp,</span><br><span class="line">    <span class="string">'reloadWithDebugInfo'</span>: reloadWithDebugInfo</span><br><span class="line">  &#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在angular上添加了module方法（2488行）：<ul>
<li>在window下面创建全局的angular对象,并且返回一个高阶函数，赋值给了angular.module属性；</li>
<li><code>setupModuleLoader</code>返回的内容中包含了<code>provider</code>、<code>factory</code>、<code>service</code>、<code>value</code>、<code>constant</code>、<code>controller</code>、<code>directive</code>等诸多对象，方便用angular.module链式调用这些对象；</li>
</ul>
</li>
</ul>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angularModule = setupModuleLoader<span class="list">(<span class="keyword">window</span>)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//链式调用</span></span><br><span class="line">angular.module(<span class="emphasis">'demoApp'</span>, [])</span><br><span class="line"><span class="title">.factory()</span></span><br><span class="line"><span class="title">.controller()</span></span><br><span class="line"><span class="title">.directive()</span></span><br><span class="line"><span class="title">.config()</span></span><br><span class="line"><span class="title">.run();</span></span><br></pre></td></tr></table></figure>
<h4 id="当dom_ready时，开始执行程序的初始化">当dom ready时，开始执行程序的初始化</h4><ul>
<li>执行初始化的代码（30708行）：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jqLite(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    angularInit(<span class="built_in">document</span>, bootstrap);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>angularInit函数(1591行):<ul>
<li>获取<code>ng-app</code>的应用根节点（含有<code>xx-app</code>属性的dom）；</li>
<li>获取启动模块（<code>xx-app</code>的值xx为 [‘ng-‘, ‘data-ng-‘, ‘ng:’, ‘x-ng-‘] 任一一种;</li>
<li>将上述结果传给bootstrap函数：<code>bootstrap(appElement, module ? [module] : [], config);</code></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The element `element` has priority over any other element</span></span><br><span class="line">forEach(ngAttrPrefixes, <span class="function"><span class="keyword">function</span>(<span class="params">prefix</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = prefix + <span class="string">'app'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!appElement &amp;&amp; element.hasAttribute &amp;&amp; element.hasAttribute(name)) &#123;</span><br><span class="line">    appElement = element;</span><br><span class="line">    <span class="built_in">module</span> = element.getAttribute(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">forEach(ngAttrPrefixes, <span class="function"><span class="keyword">function</span>(<span class="params">prefix</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = prefix + <span class="string">'app'</span>;</span><br><span class="line">  <span class="keyword">var</span> candidate;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!appElement &amp;&amp; (candidate = element.querySelector(<span class="string">'['</span> + name.replace(<span class="string">':'</span>, <span class="string">'\\:'</span>) + <span class="string">']'</span>))) &#123;</span><br><span class="line">    appElement = candidate;</span><br><span class="line">    <span class="built_in">module</span> = candidate.getAttribute(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>boostrap函数（1679行）：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bootstrap</span>(<span class="params">element, modules, config</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...省略若干代码</span></span><br><span class="line">  <span class="keyword">var</span> doBootstrap = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    element = jqLite(element);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 首先判断该dom是否已经被注入（即这个dom已经被bootstrap过）</span></span><br><span class="line">    <span class="comment">// 注意这里的injector方法是Angular为jqLite中提供的，区别于一般的jQuery api</span></span><br><span class="line">    <span class="keyword">if</span> (element.injector()) &#123;</span><br><span class="line">      <span class="keyword">var</span> tag = (element[<span class="number">0</span>] === <span class="built_in">document</span>) ? <span class="string">'document'</span> : startingTag(element);</span><br><span class="line">      <span class="comment">//Encode angle brackets to prevent input from being sanitized to empty string #8683</span></span><br><span class="line">      <span class="keyword">throw</span> ngMinErr(</span><br><span class="line">          <span class="string">'btstrpd'</span>,</span><br><span class="line">          <span class="string">"App Already Bootstrapped with this Element '&#123;0&#125;'"</span>,</span><br><span class="line">          tag.replace(<span class="regexp">/&lt;/</span>,<span class="string">'&lt;'</span>).replace(<span class="regexp">/&gt;/</span>,<span class="string">'&gt;'</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    modules = modules || [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加匿名模块</span></span><br><span class="line">    modules.unshift([<span class="string">'$provide'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$provide</span>) </span>&#123;</span><br><span class="line">      $provide.value(<span class="string">'$rootElement'</span>, element);</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (config.debugInfoEnabled) &#123;</span><br><span class="line">      <span class="comment">// Pushing so that this overrides `debugInfoEnabled` setting defined in user's `modules`.</span></span><br><span class="line">      modules.push([<span class="string">'$compileProvider'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$compileProvider</span>) </span>&#123;</span><br><span class="line">        $compileProvider.debugInfoEnabled(<span class="literal">true</span>);</span><br><span class="line">      &#125;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加ng模块</span></span><br><span class="line">    modules.unshift(<span class="string">'ng'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 到这里modules可能是: ['ng', [$provide, function($provide)&#123;...&#125;], 'xx']</span></span><br><span class="line">    <span class="comment">// xx: ng-app="xx" </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建injector对象，注册所有的内置模块</span></span><br><span class="line">    <span class="keyword">var</span> injector = createInjector(modules, config.strictDi);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 利用injector的依赖注入，执行回调</span></span><br><span class="line">    injector.invoke([<span class="string">'$rootScope'</span>, <span class="string">'$rootElement'</span>, <span class="string">'$compile'</span>, <span class="string">'$injector'</span>,</span><br><span class="line">       <span class="function"><span class="keyword">function</span> <span class="title">bootstrapApply</span>(<span class="params">scope, element, compile, injector</span>) </span>&#123;</span><br><span class="line">        scope.$apply(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="comment">// 标记该dom已经被注入</span></span><br><span class="line">          element.data(<span class="string">'$injector'</span>, injector);</span><br><span class="line">          <span class="comment">// 编译整个dom</span></span><br><span class="line">          compile(element)(scope);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;]</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> injector;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...省略若干代码</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span> &amp;&amp; !NG_DEFER_BOOTSTRAP.test(<span class="built_in">window</span>.name)) &#123;</span><br><span class="line">    <span class="keyword">return</span> doBootstrap();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...省略若干代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>除了系统会自动调用bootsrap函数，也可以自己手动调用：</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'demo'</span>, [])</span><br><span class="line">    .controller(<span class="string">'WelcomeController'</span>, <span class="keyword">function</span>(<span class="variable">$scope</span>) &#123;</span><br><span class="line">         <span class="variable">$scope</span>.greeting = <span class="string">'Welcome!'</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">angular.bootstrap(document, [<span class="string">'demo'</span>]);</span><br></pre></td></tr></table></figure>
<h3 id="$get的分析"><code>$get</code>的分析</h3><ul>
<li><code>$get</code>见源码16163行；</li>
<li>构造函数如下：</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> Scope() &#123;</span><br><span class="line">      this.<span class="variable">$id</span> = nextUid();</span><br><span class="line">      this.$<span class="variable">$phase</span> = this.<span class="variable">$parent</span> = this.$<span class="variable">$watchers</span> =</span><br><span class="line">                     this.$<span class="variable">$nextSibling</span> = this.$<span class="variable">$prevSibling</span> =</span><br><span class="line">                     this.$<span class="variable">$childHead</span> = this.$<span class="variable">$childTail</span> = null;</span><br><span class="line">      this.<span class="variable">$root</span> = this;</span><br><span class="line">      this.$<span class="variable">$destroyed</span> = false;</span><br><span class="line">      this.$<span class="variable">$listeners</span> = &#123;&#125;;</span><br><span class="line">      this.$<span class="variable">$listenerCount</span> = &#123;&#125;;</span><br><span class="line">      this.$<span class="variable">$watchersCount</span> = <span class="number">0</span>;</span><br><span class="line">      this.$<span class="variable">$isolateBindings</span> = null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>含义：</p>
<ul>
<li>$id, 通过nextUid方法来生成一个唯一的标识</li>
<li>$$phase, 这是一个状态标识,一般在dirty check时用到，表明现在在哪个阶段</li>
<li>$parent, 代表自己的上级scope属性</li>
<li>$$watchers, 保存scope变量当前所有的监控数据,是一个数组</li>
<li>$$nextSibling, 下一个兄弟scope属性</li>
<li>$$prevSibling, 前一个兄弟scope属性</li>
<li>$$childHead, 第一个子级scope属性</li>
<li>$$childTail, 最后一个子级scope属性</li>
<li>$$destroyed, 表示是否被销毁</li>
<li>$$asyncQueue, 代表异步操作的数组</li>
<li>$$postDigestQueue, 代表一个在dirty check之后执行的数组</li>
<li>$$listeners, 代表scope变量当前所有的监听数据,是一个数组</li>
</ul>
</li>
<li><p>创建子级作用域是通过<code>$new</code>方法：</p>
</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$new</span>: <span class="keyword">function</span>(isolate, parent) &#123;</span><br><span class="line">        var child;</span><br><span class="line"></span><br><span class="line">        parent = parent || this;</span><br><span class="line"></span><br><span class="line">        if (isolate) &#123;</span><br><span class="line">          child = new Scope();</span><br><span class="line">          child.<span class="variable">$root</span> = this.<span class="variable">$root</span>;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          // Only create a child scope class if somebody asks for one,</span><br><span class="line">          // but cache it to allow the VM to optimize lookups.</span><br><span class="line">          if (!this.$<span class="variable">$ChildScope</span>) &#123;</span><br><span class="line">            this.$<span class="variable">$ChildScope</span> = createChildScopeClass(this);</span><br><span class="line">          &#125;</span><br><span class="line">          child = new this.$<span class="variable">$ChildScope</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        child.<span class="variable">$parent</span> = parent;</span><br><span class="line">        child.$<span class="variable">$prevSibling</span> = parent.$<span class="variable">$childTail</span>;</span><br><span class="line">        if (parent.$<span class="variable">$childHead</span>) &#123;</span><br><span class="line">          parent.$<span class="variable">$childTail</span>.$<span class="variable">$nextSibling</span> = child;</span><br><span class="line">          parent.$<span class="variable">$childTail</span> = child;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          parent.$<span class="variable">$childHead</span> = parent.$<span class="variable">$childTail</span> = child;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // When the new scope is not isolated or we inherit from `this`, and</span><br><span class="line">        // the parent scope is destroyed, the property `$<span class="variable">$destroyed</span>` is inherited</span><br><span class="line">        // prototypically. In all other cases, this property needs to be set</span><br><span class="line">        // when the parent scope is destroyed.</span><br><span class="line">        // The listener needs to be added after the parent is set</span><br><span class="line">        if (isolate || parent != this) child.<span class="variable">$on</span>(<span class="string">'$destroy'</span>, destroyChildScope);</span><br><span class="line"></span><br><span class="line">        return child;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>分析：<ul>
<li>isolate标识来创建独立作用域,这个在创建指令，并且scope属性定义的情况下，会触发这种情况，还有几种别的特殊情况,假如是独立作用域的话，会多一个$root属性,这个默认是指向rootscope的；</li>
<li>如果不是独立的作用域,则会生成一个内部的构造函数,把此构造函数的prototype指向当前scope实例；</li>
<li>通用的操作就是,设置当前作用域的<code>$$childTail</code>,<code>$$childTail.$$nextSibling</code>,<code>$$childHead</code>,<code>this.$$childTail</code>为生成的子级作用域;设置子级域的<code>$parent</code>为当前作用域,<code>$$prevSibling</code>为当前作用域最后一个子级作用域；</li>
</ul>
</li>
</ul>
<h3 id="$watch的分析"><code>$watch</code>的分析</h3><ul>
<li><code>$watch</code>在16452行，具体如下：</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$watch</span>: <span class="keyword">function</span>(watchExp, listener, objectEquality, prettyPrintExpression) &#123;</span><br><span class="line">        var get = <span class="variable">$parse</span>(watchExp);</span><br><span class="line"></span><br><span class="line">        if (get.$<span class="variable">$watchDelegate</span>) &#123;</span><br><span class="line">          return get.$<span class="variable">$watchDelegate</span>(this, listener, objectEquality, get, watchExp);</span><br><span class="line">        &#125;</span><br><span class="line">        var scope = this,</span><br><span class="line">            array = scope.$<span class="variable">$watchers</span>,</span><br><span class="line">            watcher = &#123;</span><br><span class="line">              fn: listener,</span><br><span class="line">              last: initWatchVal,</span><br><span class="line">              get: get,</span><br><span class="line">              exp: prettyPrintExpression || watchExp,</span><br><span class="line">              eq: !!objectEquality</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">        lastDirtyWatch = null;</span><br><span class="line"></span><br><span class="line">        if (!isFunction(listener)) &#123;</span><br><span class="line">          watcher.fn = noop;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!array) &#123;</span><br><span class="line">          array = scope.$<span class="variable">$watchers</span> = [];</span><br><span class="line">        &#125;</span><br><span class="line">        // we use unshift since we use a while loop in <span class="variable">$digest</span> for speed.</span><br><span class="line">        // the while loop reads in reverse order.</span><br><span class="line">        array.unshift(watcher);</span><br><span class="line">        incrementWatchersCount(this, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        return function deregisterWatch() &#123;</span><br><span class="line">          if (arrayRemove(array, watcher) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            incrementWatchersCount(scope, -<span class="number">1</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          lastDirtyWatch = null;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>对象含义：</p>
<ul>
<li>fn, 代表监听函数,当监控表达式新旧不相等时会执行此函数</li>
<li>last, 保存最后一次发生变化的监控表达式的值</li>
<li>get, 保存一个监控表达式对应的函数,目的是用来获取表达式的值然后用来进行新旧对比的</li>
<li>exp, 保存一个原始的监控表达式</li>
<li>eq, 保存$watch函数的第三个参数，表示是否进行深度比较</li>
</ul>
</li>
<li><p>检查传递进来的监听参数是否为函数,如果是一个有效的字符串，则通过parse来解析生成一个函数,否则赋值为一个noop占位函数,最后生成一个包装函数，函数体的内容就是执行刚才生成的监听函数,默认传递当前作用域.</p>
</li>
<li>检查监控表达式是否为字符串并且执行表达式的constant为true,代表这个字符串是一个常量,那么，系统在处理这种监听的时候，执行完一次监听函数之后就会删除这个<code>$watch</code>.最后往当前作用域里的<code>$$watchers</code>数组头中添加<code>$watch</code>信息,注意这里的返回值,利用JS的闭包保留了当前的watcher，然后返回一个函数，这个就是用来删除监听用的.</li>
</ul>
<h3 id="$digest分析"><code>$digest</code>分析</h3><ul>
<li>见源码16812行；</li>
<li>digest方法是dirty check的核心,主要思路是先执行<code>$$asyncQueue</code>队列中的表达式,然后开启一个loop来的执行所有的watch里的监听函数,前提是前后两次的值是否不相等,假如ttl超过系统默认值，则dirth check结束,最后执行<code>$$postDigestQueue</code>队列里的表达式.</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$digest</span>: <span class="keyword">function</span>() &#123;</span><br><span class="line">        var watch, value, last, fn, get,</span><br><span class="line">            watchers,</span><br><span class="line">            length,</span><br><span class="line">            dirty, ttl = TTL,</span><br><span class="line">            next, current, target = this,</span><br><span class="line">            watchLog = [],</span><br><span class="line">            logIdx, asyncTask;</span><br><span class="line"></span><br><span class="line">        beginPhase(<span class="string">'$digest'</span>);</span><br><span class="line">        // Check for changes to browser url that happened in sync before the call to <span class="variable">$digest</span></span><br><span class="line">        <span class="variable">$browser</span>.$<span class="variable">$checkUrlChange</span>();</span><br><span class="line"></span><br><span class="line">        if (this === <span class="variable">$rootScope</span> &amp;&amp; applyAsyncId !== null) &#123;</span><br><span class="line">          // If this is the root scope, and <span class="variable">$applyAsync</span> has scheduled a deferred <span class="variable">$apply</span>(), then</span><br><span class="line">          // cancel the scheduled <span class="variable">$apply</span> and flush the queue of expressions to be evaluated.</span><br><span class="line">          <span class="variable">$browser</span>.defer.cancel(applyAsyncId);</span><br><span class="line">          flushApplyAsync();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lastDirtyWatch = null;</span><br><span class="line"></span><br><span class="line">        do &#123; // <span class="string">"while dirty"</span> loop</span><br><span class="line">          dirty = false;</span><br><span class="line">          current = target;</span><br><span class="line"></span><br><span class="line">          while (asyncQueue.length) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">              asyncTask = asyncQueue.shift();</span><br><span class="line">              asyncTask.scope.<span class="variable">$eval</span>(asyncTask.expression, asyncTask.locals);</span><br><span class="line">            &#125; catch (e) &#123;</span><br><span class="line">              <span class="variable">$exceptionHandler</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">            lastDirtyWatch = null;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          traverseScopesLoop:</span><br><span class="line">          do &#123; // <span class="string">"traverse the scopes"</span> loop</span><br><span class="line">            if ((watchers = current.$<span class="variable">$watchers</span>)) &#123;</span><br><span class="line">              // process our watches</span><br><span class="line">              length = watchers.length;</span><br><span class="line">              while (length--) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                  watch = watchers[length];</span><br><span class="line">                  // Most common watches are on primitives, in which case we can short</span><br><span class="line">                  // circuit it with === operator, only when === fails do we use .equals</span><br><span class="line">                  if (watch) &#123;</span><br><span class="line">                    get = watch.get;</span><br><span class="line">                    if ((value = get(current)) !== (last = watch.last) &amp;&amp;</span><br><span class="line">                        !(watch.eq</span><br><span class="line">                            ? equals(value, last)</span><br><span class="line">                            : (typeof value === <span class="string">'number'</span> &amp;&amp; typeof last === <span class="string">'number'</span></span><br><span class="line">                               &amp;&amp; isNaN(value) &amp;&amp; isNaN(last)))) &#123;</span><br><span class="line">                      dirty = true;</span><br><span class="line">                      lastDirtyWatch = watch;</span><br><span class="line">                      watch.last = watch.eq ? copy(value, null) : value;</span><br><span class="line">                      fn = watch.fn;</span><br><span class="line">                      fn(value, ((last === initWatchVal) ? value : last), current);</span><br><span class="line">                      if (ttl &lt; <span class="number">5</span>) &#123;</span><br><span class="line">                        logIdx = <span class="number">4</span> - ttl;</span><br><span class="line">                        if (!watchLog[logIdx]) watchLog[logIdx] = [];</span><br><span class="line">                        watchLog[logIdx].push(&#123;</span><br><span class="line">                          msg: isFunction(watch.exp) ? <span class="string">'fn: '</span> + (watch.exp.name || watch.exp.toString()) : watch.exp,</span><br><span class="line">                          newVal: value,</span><br><span class="line">                          oldVal: last</span><br><span class="line">                        &#125;);</span><br><span class="line">                      &#125;</span><br><span class="line">                    &#125; else if (watch === lastDirtyWatch) &#123;</span><br><span class="line">                      // If the most recently dirty watcher is now clean, short circuit since the remaining watchers</span><br><span class="line">                      // have already been tested.</span><br><span class="line">                      dirty = false;</span><br><span class="line">                      break traverseScopesLoop;</span><br><span class="line">                    &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125; catch (e) &#123;</span><br><span class="line">                  <span class="variable">$exceptionHandler</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // Insanity Warning: scope depth-first traversal</span><br><span class="line">            // yes, this code is a bit crazy, but it works and we have tests to prove it!</span><br><span class="line">            // this piece should be kept in sync with the traversal in <span class="variable">$broadcast</span></span><br><span class="line">            if (!(next = ((current.$<span class="variable">$watchersCount</span> &amp;&amp; current.$<span class="variable">$childHead</span>) ||</span><br><span class="line">                (current !== target &amp;&amp; current.$<span class="variable">$nextSibling</span>)))) &#123;</span><br><span class="line">              while (current !== target &amp;&amp; !(next = current.$<span class="variable">$nextSibling</span>)) &#123;</span><br><span class="line">                current = current.<span class="variable">$parent</span>;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; while ((current = next));</span><br><span class="line"></span><br><span class="line">          // `break traverseScopesLoop;` takes us to here</span><br><span class="line"></span><br><span class="line">          if ((dirty || asyncQueue.length) &amp;&amp; !(ttl--)) &#123;</span><br><span class="line">            clearPhase();</span><br><span class="line">            throw <span class="variable">$rootScopeMinErr</span>(<span class="string">'infdig'</span>,</span><br><span class="line">                <span class="string">'&#123;0&#125; $digest() iterations reached. Aborting!\n'</span> +</span><br><span class="line">                <span class="string">'Watchers fired in the last 5 iterations: &#123;1&#125;'</span>,</span><br><span class="line">                TTL, watchLog);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">        &#125; while (dirty || asyncQueue.length);</span><br><span class="line"></span><br><span class="line">        clearPhase();</span><br><span class="line"></span><br><span class="line">        while (postDigestQueue.length) &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            postDigestQueue.shift()();</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            <span class="variable">$exceptionHandler</span>(e);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>核心就是两个loop，外loop保证所有的model都能检测到,内loop则是真实的检测每个watch,watch.get就是计算监控表达式的值,这个用来跟旧值进行对比,假如不相等，则执行监听函数；</li>
<li>比较完之后,把新值传给watch.last,然后执行watch.fn也就是监听函数,传递三个参数,分别是:最新计算的值,上次计算的值(假如是第一次的话,则传递新值),最后一个参数是当前作用域实例,这里有一个设置外loop的条件值，那就是dirty = true,也就是说只要内loop执行了一次watch,则外loop还要接着执行，这是为了保证所有的model都能监测一次，虽然这个有点浪费性能,不过超过ttl设置的值后,dirty check会强制关闭，并抛出异常；</li>
<li>当检查完一个作用域内的所有watch之后，则开始深度遍历当前作用域的子级或者父级,虽然这有些影响性能，就像这里的注释写的那样yes, <code>this code is a bit crazy</code></li>
</ul>
<h3 id="$apply分析"><code>$apply</code>分析</h3><ul>
<li>见源码17121行；</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$apply</span>: <span class="keyword">function</span>(expr) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">          beginPhase(<span class="string">'$apply'</span>);</span><br><span class="line">          try &#123;</span><br><span class="line">            return this.<span class="variable">$eval</span>(expr);</span><br><span class="line">          &#125; finally &#123;</span><br><span class="line">            clearPhase();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; catch (e) &#123;</span><br><span class="line">          <span class="variable">$exceptionHandler</span>(e);</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">          try &#123;</span><br><span class="line">            <span class="variable">$rootScope</span>.<span class="variable">$digest</span>();</span><br><span class="line">          &#125; catch (e) &#123;</span><br><span class="line">            <span class="variable">$exceptionHandler</span>(e);</span><br><span class="line">            throw e;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这个方法一般用在，不在ng的上下文中执行js代码的情况,比如原生的DOM事件中执行想改变ng中某些model的值,这个时候就要使用<code>$apply</code>方法了;</li>
<li>代码中，首先让当前阶段标识为<code>$apply</code>,这个可以防止使用<code>$apply</code>方法时检查是否已经在这个阶段了,然后就是执行<code>$eval</code>方法, 这个方法上面有讲到,最后执行<code>$digest</code>方法,来使ng中的M或者VM改变.</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Angularjs/">Angularjs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-3-10-jQuery3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/10/2016-3-10-jQuery3/" class="article-date">
  	<time datetime="2016-03-09T16:00:00.000Z" itemprop="datePublished">2016-03-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/10/2016-3-10-jQuery3/">jQuery3新特性</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="说明">说明</h3><ul>
<li>本文为翻译文章，原文<a href="http://developer.telerik.com/featured/whats-new-in-jquery-3/?utm_source=javascriptweekly&amp;utm_medium=email" target="_blank" rel="external">在这里</a></li>
<li>本文作者：Aurelio De Rosa</li>
<li>本文总结了jQuery3新特性，作为jQuery开发者的参考</li>
</ul>
<h3 id="引言">引言</h3><ul>
<li>jQuery影响网页开发已经有十年的时间，它一路走来源于它的诸多优势。 jQuery为用户提供了一个易于使用的与DOM交互方式，比如：执行Ajax请求，创建动画，等等。此外，不同于纯DOM的API，jQuery实现了复合模式。正因为如此，你在不用知道元素数量的前提下，可以方便调用一个jQuery集合或是一个jQuery方法。</li>
<li>在未来的几个星期，一个重要的时间节点将要到来，jQuery将发布版本3，其中修复了很多的bug，增加了新的方法，弃用并删除了一些功能，改变了一些功能的行为。在这篇文章中，我将讲解jQuery3引入的最重要的变化。</li>
</ul>
<h3 id="新特性">新特性</h3><blockquote>
<ul>
<li>在下面的章节，我将讨论jQuery3中添加的最重要的特性。</li>
</ul>
</blockquote>
<h4 id="FOR…OF_LOOP">FOR…OF LOOP</h4><ul>
<li>jQuery3将提供for…of 循环来遍历一个jQuery集合的DOM元素。这种新的迭代器是ECMAScript 2015（又名的ECMAScript6）规范的一部分。它可以让你方便的迭代对象（包括阵列，地图，设置，等等）。</li>
<li>当使用这种新的迭代方式的时候，您会收到一个不是jQuery的集合，从中仅可以在同一时间访问一个DOM元素。这个迭代器将使你可以在一个jQuery集合执行操作的方式略有提升。</li>
<li>为了理解这个迭代器是如何工作的，我们举个例子。比如你想分配一个ID给页面的每个输入元素。 jQuery的3之前你可以这样写：</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var <span class="variable">$inputs</span> = $(<span class="string">'input'</span>);</span><br><span class="line"><span class="keyword">for</span>(var i = <span class="number">0</span>; i &lt; <span class="variable">$inputs</span>.length; i++) &#123;</span><br><span class="line">   <span class="variable">$inputs</span>[i].id = <span class="string">'input-'</span> + i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>在jQuery3中可以这样写：</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var <span class="variable">$inputs</span> = $(<span class="string">'input'</span>);var i = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">for</span>(var input <span class="keyword">of</span> <span class="variable">$inputs</span>) &#123;</span><br><span class="line">  input.id = <span class="string">'input-'</span> + i++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="$-GET()_AND_$-POST()的新属性"><code>$.GET()</code> AND <code>$.POST()</code>的新属性</h4><ul>
<li>jQuery3增加了<code>$.get()</code>和<code>$.post()</code>的新属性，他们是ajax的具体实现。添加新的属性是：</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="function"><span class="title">get</span><span class="params">([settings])</span></span></span><br><span class="line">$.<span class="function"><span class="title">post</span><span class="params">([settings])</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>setting是一个对象，可以拥有许多属性。你可以给$.ajax()提供相同的对象。要了解更多内容，请参阅<a href="http://api.jquery.com/jquery.ajax/#jQuery-ajax-settings" target="_blank" rel="external">$.ajax()</a>。</li>
<li>在给<code>$.get()</code>、<code>$.post()</code>传送对象和给<code>$.ajax()</code>传送对象的最大的区别是方法的属性始终被忽略掉。产生这种情况的原因是<code>$.get()</code>、<code>$.post()</code>对象有一个预设的HTTP方法来执行Ajax请求（GET方法对应<code>$.get()</code>、POST方法对应<code>$.post()</code>）。最基本的一个原则是，你不能尝试通过<code>$.get()</code>去发送POST请求。</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$.get(&#123;</span><br><span class="line">   url: 'https://www.audero.it',</span><br><span class="line">   <span class="keyword">method</span>: '<span class="type">POST</span>' // <span class="type">This</span> property <span class="keyword">is</span> ignored</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>尽管显式设置了请求的方法为POST，这段代码仍将发出GET而非POST请求。</li>
</ul>
<h4 id="使用REQUESTANIMATIONFRAME()播放动画">使用REQUESTANIMATIONFRAME()播放动画</h4><ul>
<li>所有现代浏览器，包括Internet Explorer10及以上，都支持requestAnimationFrame。在实际操作中，jQuery3播放动画时，使用这个API将使得动画的播放更加平滑，而且消耗更少的CPU资源。</li>
</ul>
<h4 id="UNWRAP()">UNWRAP()</h4><ul>
<li>jQuery3对于unwrap()函数增加了一个可选的选择参数。该方法现在可以这么使用：</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">unwrap</span><span class="params">([selector])</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>由于这种变化，你可以在unwrap函数中添加选择器。如果选择器存在匹配的DOM对象，则匹配的子元素是展开；否则，不进行操作。</li>
</ul>
<h3 id="未来的变化">未来的变化</h3><blockquote>
<ul>
<li>jQuery3还修改了它的一些功能的行为。</li>
</ul>
</blockquote>
<h4 id="VISIBLE_和_:HIDDEN">VISIBLE 和 :HIDDEN</h4><ul>
<li>新版的jQuery更改了:visible 和:hidden的含义，如果元素存在盒模型（包括那些宽度和高度为零的盒模型），这样的元素将被认为是:visible的。例如，<br>元素和一些没有内容的行内元素在jQuery3中就会被:visible选择器选中。所以，如果您页面上结构如下：</li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;div&gt;</span><span class="tag">&lt;/div&gt;</span></span><br><span class="line"><span class="tag">&lt;br /&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>而且您写了如下的代码：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log($(<span class="string">'body :visible'</span>).length);</span><br></pre></td></tr></table></figure>
<ul>
<li>在jQuery1和jQuery2中，您将获取0，在jQuery3中，您将获得2.</li>
</ul>
<h4 id="DATA()">DATA()</h4><ul>
<li>另一个重要变化是关于data()方法的。它已被更改为符合 Dataset API specifications的方法。 jQuery3将所有属性的key值变更为camel case。要理解这种变化，请考虑以下代码：</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="property">id</span>=<span class="string">"container"</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果您使用的是jQuery3之前的版本，你可以这么写：</li>
</ul>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var <span class="variable">$elem</span> = $(<span class="string">'#container'</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$elem</span>.data(&#123;</span><br><span class="line">   <span class="string">'my-property'</span>: <span class="string">'hello'</span>&#125;);</span><br><span class="line"></span><br><span class="line">console.log(<span class="variable">$elem</span>.data());</span><br></pre></td></tr></table></figure>
<ul>
<li>在控制台你将得到如下输出：</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="rules">&#123;<span class="rule"><span class="attribute">my-property</span>:<span class="value"> <span class="string">"hello"</span></span></span></span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>但是如果您使用jQuery3，将得到：</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="rules">&#123;<span class="rule"><span class="attribute">myProperty</span>:<span class="value"> <span class="string">"hello"</span></span></span></span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>注意，jQuery3属性的名称是camel case的，没有“-”符号，而以前的版本则有。</li>
</ul>
<h4 id="THE_DEFERRED_OBJECT">THE DEFERRED OBJECT</h4><ul>
<li>jQuery3改变了递延对象的行为，是Promise对象的先驱，以提高其与promise/ A+对象的兼容性。这个对象和它的历史是很有趣的。为了更多地了解它，你可以阅读<a href="https://api.jquery.com/category/deferred-object/" target="_blank" rel="external">官方文档</a>或阅读<a href="https://www.manning.com/books/jquery-in-action-third-edition" target="_blank" rel="external">我的书</a>,涵盖jQuery3的知识点。</li>
<li>在jQuery1.x和2.x中，回调函数中的未捕获异常被传递给一个异常中止程序的执行。不同于原生的Promise 对象，它会一层一层抛出异常，直到它达到window.onerror对象。如果你还没有为此函数定义事件（这是一种罕见的情况），异常消息会显示出来，程序流被终止。</li>
<li>jQuery3遵循和原生的Promise对象相同的模式。因此，引发的异常被转换成一个rejection 对象并且执行失败情况下的回调函数。一旦完成，该过程继续，并且随后执行成功情况下的回调函数。</li>
<li>为了帮助您了解这种差异，让我们看一个小例子。考虑下面的代码：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> deferred = $.Deferred();</span><br><span class="line"></span><br><span class="line">deferred</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'An error'</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Success 1'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Failure 1'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .then(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Success 2'</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Failure 2'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">deferred.resolve();</span><br></pre></td></tr></table></figure>
<ul>
<li>在jQuery1和jQuery2中，只有第一个函数（抛出异常的那个函数）被执行。另外，因为我们没有定义任何window.onerror的处理函数，控制台消息将输出“Uncaught Error: An error”，程序执行将中止。</li>
<li>在jQuery3中，程序的行为是完全不同的。你会看到控制台消息显示“Failure 1”和“Success 2”。该异常由第一个失败处理函数来处理，一旦它已经被处理，接下来成功的函数可以被执行。</li>
</ul>
<h4 id="SVG_文件">SVG 文件</h4><ul>
<li>没有jQuery版本，包括jQuery3，正式支持SVG文件。然而事实是，许多方法都可以工作，比如那些操纵类名称的函数，已在jQuery3中被更新。因此，在这个即将到来的jQuery版本，你就可以使用SVG文档的方法，如addClass()和hasClass()方法。</li>
</ul>
<h3 id="方法和属性已过时或删除">方法和属性已过时或删除</h3><blockquote>
<ul>
<li>到目前我们介绍了jQuery3新增的功能，同时它也移除和弃用的几个功能。</li>
</ul>
</blockquote>
<ul>
<li><p>弃用 BIND(), UNBIND(), DELEGATE() UNDELEGATE()方法</p>
<ul>
<li>on()方法以前曾经介绍过，是用来为提供一个统一的接口来代替jQuery的bind()、delegate()和 live()方法。同时，jQuery建议用off()提供的统一的接口来代替unbind(),undelegated()和die()方法。</li>
<li>jQuery3弃用了所有的这些方法，将来的版本也不会重新使用。请在你的项目中专注于使用on() 和off()。</li>
</ul>
</li>
<li><p>弃用LOAD(), UNLOAD() 和 ERROR()方法</p>
<ul>
<li>jQuery3弃用了LOAD(), UNLOAD() 和 ERROR()方法。这些方法其实早在jQuery1.8中就被弃用了，但并未被绝对禁止使用。如果你正在使用依赖于一个或一个以上的这些方法，升级到jQuery3则会破坏你的代码的可用性。因此，在决定升级前要注意。</li>
</ul>
</li>
<li><p>弃用CONTEXT, SUPPORT 和 SELECTOR属性</p>
<ul>
<li>jQuery3 弃用了context, support和 selector属性。正如我在上一节中提到的，如果你还在项目中使用它们，升级到jQuery3会破坏你的代码的可用性。</li>
</ul>
</li>
<li><p>Bug的修正</p>
<ul>
<li>jQuery3修复了以前版本中的一些重要的错误。在下面的部分，我将重点讲解两方面，这将使您的工作方式的巨大变化。</li>
</ul>
</li>
<li><p>对于 width() 和height()函数不会有更多的四舍五入</p>
<ul>
<li>jQuery3修复了包括width()和height()等相关函数的bug。这些方法将不再舍入到最近的像素，这使得它在某些情况下难以定位。</li>
<li>要理解这个问题，举例来说，你有一个有100像素宽的容器元素，分成三等份，每一份为宽度为整体的三分之一（即33.333333％）,在jQuery历史版本中，如果你要按照下面的代码获取每一份的宽度,你将会得到四舍五入后的宽度33像素。jQuery3中修复了这个bug，你将会得到一个浮点数。</li>
</ul>
</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">div</span> <span class="type">class</span>=<span class="string">"container"</span>&gt;</span><br><span class="line">   &lt;<span class="keyword">div</span>&gt;My <span class="property">name</span>&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">   &lt;<span class="keyword">div</span>&gt;<span class="keyword">is</span>&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">   &lt;<span class="keyword">div</span>&gt;Aurelio De Rosa&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(</span><span class="string">'.container div'</span>).width();</span><br></pre></td></tr></table></figure>
<ul>
<li>WRAPALL()函数<ul>
<li>jQuery的新版本修复了一个wrapAll()方法的错误。在jQuery3之前的版本中，当向wrapAll()传递函数时，它独立包装jQuery的集合中的元素。换句话说，它的行为和向wrap()传递函数作用相同。</li>
<li>为了解决这个问题，因为函数被在jQuery3中仅仅被调用了1次，它没有通过jQuery的集合传递元素的索引。最后，函数上下文（this对象）将引用jQuery集合中的第一个元素。</li>
</ul>
</li>
</ul>
<h3 id="下载jQuery3测试版本1">下载jQuery3测试版本1</h3><ul>
<li><p>可通过如下URL下载</p>
<blockquote>
<ul>
<li>非压缩版本: <a href="https://code.jquery.com/jquery-3.0.0-beta1.js" target="_blank" rel="external">https://code.jquery.com/jquery-3.0.0-beta1.js</a></li>
<li>压缩版本: <a href="https://code.jquery.com/jquery-3.0.0-beta1.min.js" target="_blank" rel="external">https://code.jquery.com/jquery-3.0.0-beta1.min.js</a></li>
</ul>
</blockquote>
</li>
<li><p>也可用npm下载：</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jquery@<span class="number">3.0</span><span class="number">.0</span>-beta1</span><br></pre></td></tr></table></figure>
<h3 id="结论">结论</h3><ul>
<li>很多人说，jQuery已死，现代Web开发不会用到jQuery了。然而，它的发展仍在继续，但其78.5％的使用率的统计结果违背了这些说法。</li>
<li>在这篇文章中，我已经带您领略了jQuery3的新特性。正如您可能已经注意到，这个版本不会打破任何现有的项目，因为它不会引入许多重大更改。尽管如此，有一些更改在升级前需要牢记。第三方的依赖升级前，该项目的审查会帮助你发现任何异常行为或损坏的功能。</li>
</ul>
<h3 id="再次声明">再次声明</h3><ul>
<li>本文是<a href="http://developer.telerik.com/featured/whats-new-in-jquery-3/?utm_source=javascriptweekly&amp;utm_medium=email" target="_blank" rel="external">这篇文章</a>的翻译，作者是Aurelio De Rosa，译者是饮水思源。</li>
<li>非常感谢作者分享jQuery3新特性，让我们对jQuery有了全新的认识和体验。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/translation/">translation</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/translation/">translation</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-3-9-sudoku" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/09/2016-3-9-sudoku/" class="article-date">
  	<time datetime="2016-03-08T16:00:00.000Z" itemprop="datePublished">2016-03-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/09/2016-3-9-sudoku/">九宫格样式的实现</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="九宫格样式">九宫格样式</h3><ul>
<li>页面显示九宫格，鼠标放在哪一个格子上，相应的格子的外边框变色；</li>
<li>具体效果如下：</li>
</ul>
<p><img src="/images/sudoku/sudoku.png" alt="suduku"></p>
<ul>
<li>下面先贴出代码：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">		<span class="id">#outer</span>&gt;<span class="tag">div</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">float</span>:<span class="value"> left</span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">border</span>:<span class="value"><span class="number">5px</span> solid blue</span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">text-align</span>:<span class="value"> center</span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">100px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">position</span>:<span class="value"> relative</span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line"></span><br><span class="line">		<span class="id">#outer</span>&gt;<span class="tag">div</span><span class="pseudo">:hover</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">border</span>:<span class="value"><span class="number">5px</span> solid red</span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">z-index</span>:<span class="value"><span class="number">999</span></span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line"></span><br><span class="line">		<span class="class">.middle</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">margin-left</span>:<span class="value"> -<span class="number">5px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">margin-right</span>:<span class="value"> -<span class="number">5px</span></span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line">		<span class="class">.middle1</span><span class="rules">&#123;</span><br><span class="line">			<span class="rule"><span class="attribute">margin-top</span>:<span class="value"> -<span class="number">5px</span></span></span>;</span><br><span class="line">			<span class="rule"><span class="attribute">margin-bottom</span>:<span class="value"> -<span class="number">5px</span></span></span>;</span><br><span class="line">		&#125;</span></span><br><span class="line">		</span><br><span class="line">	</span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">style</span>=<span class="value">"width:320px; height:320px;background-color:#eee"</span> <span class="attribute">id</span>=<span class="value">"outer"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span>&gt;</span>1<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"middle"</span>&gt;</span>2<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span>&gt;</span>3<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"middle1"</span>&gt;</span>4<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"middle middle1"</span>&gt;</span>5<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"middle1"</span>&gt;</span>6<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span>&gt;</span>7<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"middle"</span>&gt;</span>8<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="title">div</span>&gt;</span>9<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="研究">研究</h3><ul>
<li>div换行问题：<ul>
<li><code>&lt;div&gt;</code>是块级元素，前后有换行符，如果不加任何设置，九个div将垂直排列在页面；</li>
<li>解决方法是，先设置好外层、内层div的宽高，然后对内层div加入<code>float: left;</code>属性，使其向左浮动，去掉div前后的换行符，由于外层div有宽度限制，内层div在达到外层div宽度后，会自动换行，实现九宫格基本样式；</li>
</ul>
</li>
<li>文字的居中问题：<ul>
<li>对于文字的左右居中，不需要使用position属性配合left、margin-left属性来设置，只需用特定作用于文字的属性<code>text-align: center;</code>即可，这个属性不仅可以作用于文字，而且还能作用于很多块级元素，美中不足的是，如果父元素设置了<code>text-align</code>属性，它的所有子元素将继承这个属性的值；</li>
<li>对于文字的上下居中，本来也想使用position属性配合left、margin-left属性来设置，但看到网上有牛人直接用<code>line-height</code>就实现了，这个属性用于设置行间距，由于九宫格中的文字只有一行，所以将<code>line-height</code>设置为div的高度即可实现垂直居中效果；</li>
</ul>
</li>
<li>负外边距的问题：<ul>
<li>如果不对<code>.middle</code>和<code>.middle1</code>类设置负外边距，效果是下面的样子，即处于上下中间或左右中间的格子，只对自己的外边框变化了颜色，与我们要求的效果有差距；</li>
<li>通过将2、5、8格子的左右的margin设置为负值，4、5、6格子的上下的margin设置为负值，可有效避免相邻格子间的外边距叠加的问题；</li>
</ul>
</li>
</ul>
<p><img src="/images/sudoku/sudoku-error1.png" alt="suduku_error1"></p>
<ul>
<li>将格子的position属性设置为relative，并且将鼠标悬浮时的格子的z-index属性设置为较大的值，可保证鼠标悬浮时，当前格子总是处于最高的层叠位置，否则会出现下图的情况：</li>
</ul>
<p><img src="/images/sudoku/sudoku-error2.png" alt="suduku_error2"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Web/">Web</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
    <article id="post-2016-1-5-sort-algorithm" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/05/2016-1-5-sort-algorithm/" class="article-date">
  	<time datetime="2016-01-04T16:00:00.000Z" itemprop="datePublished">2016-01-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/05/2016-1-5-sort-algorithm/">几种排序算法的实现</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="引言">引言</h3><ul>
<li>排序算法是重要的基础算法；</li>
<li>排序算法的效率至关重要；</li>
<li>任何算法的空间效率和时间效率不可兼得，所以没有最好的算法，只有最合适的算法；</li>
<li>本文总结了几种排序算法，并分析了他们的适用场景，使用的语言为java和js；</li>
</ul>
<h3 id="选择排序（selection_sort）">选择排序（selection sort）</h3><ul>
<li>思想：对于一个数组a，找出数组中的最小元素并和a[0]交换，然后忽略a[0]，再次找出数组中的最小元素并与a[1]交换，以此类推；</li>
<li>java实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> SelectionSort &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span> &#125;;</span><br><span class="line">		sort(nums);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			System.out.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] myArray)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; myArray.length; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span> temp = myArray[i];</span><br><span class="line">			<span class="keyword">int</span> position = i;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; myArray.length; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (myArray[j] &lt; temp) &#123;</span><br><span class="line">					temp = myArray[j];</span><br><span class="line">					position = j;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			myArray[position] = myArray[i];</span><br><span class="line">			myArray[i] = temp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nums = [<span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span>];</span><br><span class="line"><span class="keyword">var</span> selectionSort = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;nums.length; i++)&#123;</span><br><span class="line">		<span class="keyword">var</span> temp = nums[i];</span><br><span class="line">		<span class="keyword">var</span> position = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> j=i; j&lt;nums.length; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(nums[j]&lt;temp)&#123;</span><br><span class="line">				temp = nums[j];</span><br><span class="line">				position = j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		nums[position] = nums[i];</span><br><span class="line">		nums[i] = temp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">selectionSort(nums);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> number <span class="keyword">in</span> nums)&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(nums[number]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="插入排序（Insertion_sort）">插入排序（Insertion  sort）</h3><ul>
<li>思想：从数组的第二个元素开始，将数组中的每一个元素按照规则插入到已排好序的数组中以达到排序的目的；</li>
<li>java排序：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> InsertionSort &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span> &#125;;</span><br><span class="line">		sort(nums);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			System.out.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] myArray)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; myArray.length; i++) &#123;</span><br><span class="line">			<span class="keyword">int</span> j = i - <span class="number">1</span>;</span><br><span class="line">			temp = myArray[i];</span><br><span class="line">			<span class="keyword">for</span> (; j &gt;= <span class="number">0</span> &amp;&amp; temp &lt; myArray[j]; j--) &#123;</span><br><span class="line">				myArray[j + <span class="number">1</span>] = myArray[j]; <span class="comment">// 将大于temp的值整体后移一个单位</span></span><br><span class="line">			&#125;</span><br><span class="line">			myArray[j + <span class="number">1</span>] = temp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var nums = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">0</span>];</span><br><span class="line">var insertionSort = function(nums)&#123;</span><br><span class="line">	<span class="keyword">for</span>(var i=<span class="number">1</span>; i&lt;nums.length; i++)&#123;</span><br><span class="line">		var temp = nums[i];</span><br><span class="line">		<span class="keyword">for</span>(var j = i-<span class="number">1</span>; j&gt;=<span class="number">0</span>&amp;&amp;nums[j]&gt;temp; j--)&#123;</span><br><span class="line">			nums[j+<span class="number">1</span>] = nums[j];</span><br><span class="line">		&#125;</span><br><span class="line">		nums[j+<span class="number">1</span>]=temp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">insertionSort(nums);</span><br><span class="line"><span class="keyword">for</span>(var number in nums)&#123;</span><br><span class="line">	console.<span class="built_in">log</span>(nums[number]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="希尔排序（shell_sort）">希尔排序（shell sort）</h3><ul>
<li>希尔排序是改进后的插入排序；</li>
<li>思想：由于数组越接近有序，插入排序时间复杂度越低，所以希尔排序不是直接对数组进行插入排序，而是先对数组分成若干组，对每一组分别进行插入排序，使得数组变得”更加有序”之后再扩大每组的元素个数，再对每组进行插入排序，以此类推，直至元素全部有序，这是一种为了降低时间复杂度的”渐进式”的插入排序；</li>
<li>java实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> InsertionSort &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span> &#125;;</span><br><span class="line">		sort(nums);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			System.out.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] myArray)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">double</span> d = myArray.length;</span><br><span class="line">		<span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">			d = Math.<span class="built_in">ceil</span>(d/<span class="number">2</span>);</span><br><span class="line">			<span class="keyword">int</span> inteval = (<span class="keyword">int</span>)d;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;inteval; i++)&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j=i+inteval; j&lt;myArray.length; j+=inteval)&#123;</span><br><span class="line">					<span class="keyword">int</span> temp = myArray[j];</span><br><span class="line">					<span class="keyword">int</span> k = j-inteval;</span><br><span class="line">					<span class="keyword">for</span>(; k&gt;=<span class="number">0</span>&amp;&amp;myArray[k]&gt;temp;k-=inteval)&#123;</span><br><span class="line">						myArray[k+inteval] = myArray[k];</span><br><span class="line">					&#125;</span><br><span class="line">					myArray[k+inteval] = temp;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(inteval==<span class="number">1</span>)&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nums = [3,1,4,2,7,2,3,10];</span><br><span class="line"><span class="keyword">var</span> shellSort = function(nums)&#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="keyword">d</span> = nums.length;</span><br><span class="line">	<span class="keyword">while</span>(true)&#123;</span><br><span class="line">		<span class="keyword">d</span> = Math.<span class="literal">ceil</span>(<span class="keyword">d</span>/2);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i=0; i&lt;<span class="keyword">d</span>; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> j=i+<span class="keyword">d</span>; j&lt;nums.length; j++)&#123;</span><br><span class="line">				<span class="keyword">var</span> temp = nums[j];</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">var</span> k = j-<span class="keyword">d</span>; k&gt;=0&amp;&amp;nums[k]&gt;temp;k-=<span class="keyword">d</span>)&#123;</span><br><span class="line">					nums[k+<span class="keyword">d</span>] = nums[k];</span><br><span class="line">				&#125;</span><br><span class="line">				nums[k+<span class="keyword">d</span>] = temp;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">d</span>==1)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">shellSort(nums);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> number <span class="keyword">in</span> nums)&#123;</span><br><span class="line">	console.<span class="literal">log</span>(nums[number]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="归并排序（Merge_Sort）">归并排序（Merge Sort）</h3><ul>
<li>归并排序是分治法在排序算法中的的典型实现；</li>
<li>归并排序是将一个数组分为两半A、B（或更多部分），对这两半分别排序后，再将他们归并为一个有序数组；</li>
<li>合并的方法：将A数组中的一个元素与B数组中的一个元素相比较，并将较小的元素复制到第三个新数组中，当其中一个数组到达末尾时，将另一个数组中剩余元素复制到第三个数组中即可；</li>
<li>java实现：</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line">public class <span class="type">InsertionSort</span> &#123;</span><br><span class="line"></span><br><span class="line">	public <span class="keyword">static</span> <span class="type">void</span> main(<span class="type">String</span>[] args) &#123;</span><br><span class="line">		<span class="type">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span> &#125;;</span><br><span class="line">		sort(nums,<span class="number">0</span>,nums.length-<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			<span class="type">System</span>.<span class="keyword">out</span>.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public <span class="keyword">static</span> <span class="type">void</span> sort(<span class="type">int</span>[] myArray,<span class="type">int</span> left,<span class="type">int</span> right) &#123;</span><br><span class="line">		<span class="keyword">if</span>(left&lt;right)&#123;</span><br><span class="line">			<span class="type">int</span> center = (left+right)/<span class="number">2</span>;</span><br><span class="line">			sort(myArray,left,center);  //递归</span><br><span class="line">			sort(myArray,center+<span class="number">1</span>,right);</span><br><span class="line">			merge(myArray,left,center,right);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public <span class="keyword">static</span> <span class="type">void</span> merge(<span class="type">int</span>[] myArray,<span class="type">int</span> left,<span class="type">int</span> center,<span class="type">int</span> right)&#123;</span><br><span class="line">		<span class="type">int</span>[] <span class="literal">result</span> = new <span class="type">int</span>[myArray.length];</span><br><span class="line">		<span class="type">int</span> mid = center+<span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> third = left; //记录新的数组<span class="literal">result</span>的偏移量</span><br><span class="line">		<span class="type">int</span> tmp = left;</span><br><span class="line">		//归并</span><br><span class="line">		<span class="keyword">while</span>(left&lt;=center&amp;&amp;mid&lt;=right)&#123;</span><br><span class="line">			<span class="keyword">if</span>(myArray[left]&lt;=myArray[mid])&#123;</span><br><span class="line">				<span class="literal">result</span>[third++] = myArray[left++];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="literal">result</span>[third++] = myArray[mid++];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		//处理归并剩余部分</span><br><span class="line">		<span class="keyword">while</span>(mid&lt;=right)&#123;</span><br><span class="line">			<span class="literal">result</span>[third++] = myArray[mid++];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(left&lt;=center)&#123;</span><br><span class="line">			<span class="literal">result</span>[third++] = myArray[left++];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		//复制回原数组</span><br><span class="line">		<span class="keyword">while</span>(tmp&lt;=right)&#123;</span><br><span class="line">			myArray[tmp] = <span class="literal">result</span>[tmp];</span><br><span class="line">			tmp++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nums = [<span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span>];</span><br><span class="line"><span class="keyword">var</span> mergeSort = function(nums,left,right)&#123;</span><br><span class="line">	<span class="keyword">if</span>(left&lt;right)&#123;</span><br><span class="line">		<span class="keyword">var</span> center = <span class="type">Math</span>.floor((left+right)/<span class="number">2</span>);</span><br><span class="line">		mergeSort(nums,left,center);</span><br><span class="line">		mergeSort(nums,center+<span class="number">1</span>,right);</span><br><span class="line">		merge(nums,left,center,right);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> merge = function(nums,left,center,right)&#123;</span><br><span class="line">	<span class="keyword">var</span> mid = center+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">var</span> tmp = left;</span><br><span class="line">	<span class="keyword">var</span> third = left;</span><br><span class="line">	<span class="keyword">var</span> <span class="literal">result</span> = new <span class="type">Array</span>(nums.length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(left&lt;=center&amp;&amp;mid&lt;=right)&#123;</span><br><span class="line">		<span class="keyword">if</span>(nums[left]&lt;nums[mid])&#123;</span><br><span class="line">			<span class="literal">result</span>[third++] = nums[left++];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="literal">result</span>[third++] = nums[mid++];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(left&lt;=center)&#123;</span><br><span class="line">		<span class="literal">result</span>[third++] = nums[left++];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(mid&lt;=right)&#123;</span><br><span class="line">		<span class="literal">result</span>[third++] = nums[mid++];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(tmp&lt;=right)&#123;</span><br><span class="line">		nums[tmp] = <span class="literal">result</span>[tmp];</span><br><span class="line">		tmp++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mergeSort(nums,<span class="number">0</span>,nums.length-<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> number <span class="keyword">in</span> nums)&#123;</span><br><span class="line">	console.log(nums[number]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="冒泡排序（Bubble_sort）">冒泡排序（Bubble sort）</h3><ul>
<li>从第一个元素开始，比较相邻的元素，如果第一个比第二个大，就交换他们两个； </li>
<li>依次往后，对每一对相邻元素作同样的工作，直到序列最后，最后的元素应该会是最大的数； </li>
<li>从第一个元素开始，重复上面两步，直到倒数第二个元素就停止（最后一个元素肯定是序列中最大的，不用再次比较）；</li>
<li>重复上面的过程，直到序列末尾；</li>
<li>java实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> InsertionSort &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span> &#125;;</span><br><span class="line">		sort(nums);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			System.out.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] myArray)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> tmp;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;myArray.length-<span class="number">1</span>; i++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;myArray.length-<span class="number">1</span>-i; j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(myArray[j]&gt;myArray[j+<span class="number">1</span>])&#123;</span><br><span class="line">					tmp = myArray[j];</span><br><span class="line">					myArray[j] = myArray[j+<span class="number">1</span>];</span><br><span class="line">					myArray[j+<span class="number">1</span>] = tmp;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var nums = [<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">9</span>];</span><br><span class="line">var bubbleSort = function(nums)&#123;</span><br><span class="line">	var temp;</span><br><span class="line">	<span class="keyword">for</span>(var i=<span class="number">0</span> ;i&lt;nums.length-<span class="number">1</span>; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(var j=<span class="number">0</span>; j&lt;nums.length-<span class="number">1</span>-i; j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(nums[j]&gt;nums[j+<span class="number">1</span>])&#123;</span><br><span class="line">				tmp = nums[j];</span><br><span class="line">				nums[j] = nums[j+<span class="number">1</span>];</span><br><span class="line">				nums[j+<span class="number">1</span>] = tmp;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bubbleSort(nums);</span><br><span class="line"><span class="keyword">for</span>(var number in nums)&#123;</span><br><span class="line">	console.<span class="built_in">log</span>(nums[number]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="快速排序(Quick_Sort)">快速排序(Quick Sort)</h3><ul>
<li>思想：选择一个基准元素,通常选择第一个元素或者最后一个元素,通过一趟扫描，将待排序列分成两部分,一部分比基准元素小,一部分大于等于基准元素,此时基准元素在其排好序后的正确位置,然后再用同样的方法递归地排序划分的两部分；</li>
<li>java实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> InsertionSort &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] nums = &#123; <span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span> &#125;;</span><br><span class="line">		quickSort(nums,<span class="number">0</span>,nums.length-<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			System.out.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] <span class="built_in">list</span>, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (low &lt; high) &#123;</span><br><span class="line">			<span class="keyword">int</span> middle = getMiddle(<span class="built_in">list</span>, low, high); <span class="comment">// 将list数组进行一分为二</span></span><br><span class="line">			quickSort(<span class="built_in">list</span>, low, middle - <span class="number">1</span>); <span class="comment">// 对低字表进行递归排序</span></span><br><span class="line">			quickSort(<span class="built_in">list</span>, middle + <span class="number">1</span>, high); <span class="comment">// 对高字表进行递归排序</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getMiddle</span><span class="params">(<span class="keyword">int</span>[] <span class="built_in">list</span>, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> tmp = <span class="built_in">list</span>[low]; <span class="comment">// 数组的第一个作为中轴</span></span><br><span class="line">		<span class="keyword">while</span> (low &lt; high) &#123;</span><br><span class="line">			<span class="keyword">while</span> (low &lt; high &amp;&amp; <span class="built_in">list</span>[high] &gt;= tmp) &#123;</span><br><span class="line">				high--;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">list</span>[low] = <span class="built_in">list</span>[high]; <span class="comment">// 比中轴小的记录移到低端</span></span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span> (low &lt; high &amp;&amp; <span class="built_in">list</span>[low] &lt;= tmp) &#123;</span><br><span class="line">				low++;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="built_in">list</span>[high] = <span class="built_in">list</span>[low]; <span class="comment">// 比中轴大的记录移到高端</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">list</span>[low] = tmp; <span class="comment">// 中轴记录到尾</span></span><br><span class="line">		<span class="keyword">return</span> low; <span class="comment">// 返回中轴的位置</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nums = [<span class="number">1</span>, <span class="number">54</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">34</span>, <span class="number">12</span>, <span class="number">45</span>];</span><br><span class="line"><span class="keyword">var</span> quickSort = <span class="function"><span class="keyword">function</span>(<span class="params">nums,low,high</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(low&lt;high)&#123;</span><br><span class="line">		<span class="keyword">var</span> middle = sort(nums,low,high);</span><br><span class="line">		quickSort(nums,low,middle-<span class="number">1</span>);</span><br><span class="line">		quickSort(nums,middle+<span class="number">1</span>,high);</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sort = <span class="function"><span class="keyword">function</span>(<span class="params">nums, low, high</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> tmp = nums[low];</span><br><span class="line">	<span class="keyword">while</span>(low&lt;high)&#123;</span><br><span class="line">		<span class="keyword">while</span>(low&lt;high&amp;&amp;tmp&lt;=nums[high])&#123;</span><br><span class="line">			high--;</span><br><span class="line">		&#125;</span><br><span class="line">		nums[low] = nums[high];</span><br><span class="line">		<span class="keyword">while</span>(low&lt;high&amp;&amp;tmp&gt;=nums[low])&#123;</span><br><span class="line">			low++;</span><br><span class="line">		&#125;</span><br><span class="line">		nums[high] = nums[low];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	nums[low] = tmp;</span><br><span class="line">	<span class="keyword">return</span> low;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">quickSort(nums,<span class="number">0</span>,nums.length-<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> number <span class="keyword">in</span> nums)&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(nums[number]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="堆排序(Heap_Sort)">堆排序(Heap Sort)</h3><ul>
<li>堆的基本概念：<ul>
<li>堆是节点含有可比较对象，并以如下方式组织的完全二叉树：</li>
<li>每个节点含有的对象不小于(最大堆)/不大于(最小堆)其后代中的对象；</li>
<li>最大（小）堆的根含有堆中最大（小）的对象；</li>
<li>最大（小）堆中任何节点的子树也是最大（小）堆；</li>
</ul>
</li>
<li>堆排序原理：<ul>
<li><a href="http://www.cnblogs.com/mengdd/archive/2012/11/30/2796845.html" target="_blank" rel="external">这里</a>讲解的很清楚；</li>
</ul>
</li>
<li>java实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">package algorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> InsertionSort &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] nums = &#123; <span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">10</span> &#125;;</span><br><span class="line">		heapSort(nums);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">			System.out.println(nums[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span>[] myArray)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = myArray.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			<span class="comment">// i记录了数组中参与重建最大堆的最后一个元素的索引值</span></span><br><span class="line">			buildMaxHeap(myArray, i);</span><br><span class="line">			<span class="comment">// 交换了第一个元素和倒数第myArray.length-1-i个元素</span></span><br><span class="line">			swap(myArray, <span class="number">0</span>, i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] myArray, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> tmp;</span><br><span class="line">		tmp = myArray[a];</span><br><span class="line">		myArray[a] = myArray[b];</span><br><span class="line">		myArray[b] = tmp;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">buildMaxHeap</span><span class="params">(<span class="keyword">int</span>[] myArray, <span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// (i-1)/2 是数组中最后一个具有叶子节点的节点的索引，从这个节点开始重建堆</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = (i - <span class="number">1</span>) / <span class="number">2</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">			<span class="keyword">int</span> k = j;</span><br><span class="line">			<span class="keyword">while</span> (k * <span class="number">2</span> + <span class="number">1</span> &lt;= i) &#123;</span><br><span class="line">				<span class="keyword">int</span> leftIndex = k * <span class="number">2</span> + <span class="number">1</span>; <span class="comment">// 当前节点的左子节点的索引</span></span><br><span class="line">				<span class="keyword">int</span> rightIndex = leftIndex + <span class="number">1</span>; <span class="comment">// 当前节点的右子节点的索引</span></span><br><span class="line">				<span class="keyword">int</span> biggerInLeftRight = myArray[leftIndex]; <span class="comment">// 左右子节点中较大的数</span></span><br><span class="line">				<span class="keyword">int</span> biggerIndex = leftIndex; <span class="comment">// 左右子节点中较大的数的索引</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">// 判断右子节点是否参与本次重建堆，参与则执行</span></span><br><span class="line">				<span class="keyword">if</span> (rightIndex &lt;= i) &#123;</span><br><span class="line">					<span class="comment">// 找出左右子节点中较大的数</span></span><br><span class="line">					<span class="keyword">if</span> (myArray[leftIndex] &lt; myArray[rightIndex]) &#123;</span><br><span class="line">						biggerInLeftRight = myArray[rightIndex];</span><br><span class="line">						biggerIndex = rightIndex;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// 将当前节点、当前节点的左右子节点中的最大值移到当前节点的位置</span></span><br><span class="line">				<span class="keyword">if</span> (myArray[k] &lt; biggerInLeftRight) &#123;</span><br><span class="line">					swap(myArray, k, biggerIndex);</span><br><span class="line">					<span class="comment">// 继续循环，确保当前节点的左右子节点也满足最大堆的性质</span></span><br><span class="line">					k = biggerIndex;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>js实现：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nums = [<span class="number">8</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line"><span class="keyword">var</span> heapSort = <span class="function"><span class="keyword">function</span>(<span class="params">nums</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=nums.length-<span class="number">1</span>; i&gt;=<span class="number">0</span>; i--)&#123;</span><br><span class="line">		buildMaxHeap(nums,i);</span><br><span class="line">		swap(nums,<span class="number">0</span>,i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> swap = <span class="function"><span class="keyword">function</span>(<span class="params">nums, a, b</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> tmp;</span><br><span class="line">	tmp = nums[a];</span><br><span class="line">	nums[a] = nums[b];</span><br><span class="line">	nums[b] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> buildMaxHeap = <span class="function"><span class="keyword">function</span>(<span class="params">nums,i</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="built_in">Math</span>.floor((i-<span class="number">1</span>)/<span class="number">2</span>); j&gt;=<span class="number">0</span>; j--)&#123;</span><br><span class="line">		<span class="keyword">var</span> k = j;</span><br><span class="line">		<span class="keyword">while</span>(k*<span class="number">2</span>+<span class="number">1</span>&lt;=i)&#123;</span><br><span class="line">			<span class="keyword">var</span> leftIndex = k*<span class="number">2</span>+<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">var</span> rightIndex = leftIndex+<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">var</span> biggerIndex = leftIndex;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(rightIndex&lt;=i)&#123;</span><br><span class="line">				<span class="keyword">if</span>(nums[leftIndex]&lt;nums[rightIndex])&#123;</span><br><span class="line">					biggerIndex = rightIndex;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span>(nums[k]&lt;nums[biggerIndex])&#123;</span><br><span class="line">				swap(nums,k,biggerIndex);</span><br><span class="line">				k = biggerIndex;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">heapSort(nums);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;nums.length; i++)&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(nums[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="基数排序（radix_sort）">基数排序（radix sort）</h3><ul>
<li>基数排序和其他排序方法的思路不同，不是以比较对象大小为基础；</li>
<li>基础排序先将待排序对象的长度补全成相同的长度，然后从最后一位开始：将所有元素按照最后一位的大小排序，排序后元素的最后一位是有序的；再将所有元素按照倒数第二位的大小排序，排序后元素的倒数第二位是有序的，在倒数第二位相同的元素中，它们的最后一位是有序的；再将所有元素按照倒数第三位的大小排序，排序后元素的倒数第三位是有序的，在倒数第三位相同的元素中，它们的倒数第二位是有序的，在倒数第二位相同的元素中，它们的最后一位是有序的；</li>
<li>以此类推，直到元素的第一位排序完成；</li>
<li>此时元素已经是有序序列；</li>
<li>java实现：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package test8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> RadixSort &#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[] <span class="built_in">array</span> = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="number">20</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">45</span>, <span class="number">77</span>, <span class="number">75</span>, <span class="number">55</span>, <span class="number">25</span>, <span class="number">52</span>, <span class="number">79</span>, <span class="number">56</span>,</span><br><span class="line">				<span class="number">44</span>, <span class="number">32</span>, <span class="number">37</span>, <span class="number">35</span>, <span class="number">21</span>, <span class="number">102</span>, <span class="number">33</span>, <span class="number">178</span>, <span class="number">187</span>, <span class="number">156</span>, <span class="number">144</span> &#125;;</span><br><span class="line">		sort(<span class="built_in">array</span>, <span class="number">3</span>); <span class="comment">// 传入数组和数组中长度最大的数的长度</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">array</span>.length; i++) &#123;</span><br><span class="line">			System.out.print(<span class="built_in">array</span>[i] + <span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] <span class="built_in">array</span>, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span>[][] bucket = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="built_in">array</span>.length][<span class="built_in">array</span>.length];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">1</span>, m = <span class="number">0</span>; m &lt; d; n *= <span class="number">10</span>, m++) &#123;</span><br><span class="line">			<span class="keyword">int</span>[] num = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="built_in">array</span>.length];  <span class="comment">//记录二维数组bucket的横向数组的长度</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">array</span>.length; i++) &#123;</span><br><span class="line">				<span class="keyword">int</span> position = <span class="built_in">array</span>[i] / n % <span class="number">10</span>;</span><br><span class="line">				bucket[position][num[position]] = <span class="built_in">array</span>[i];</span><br><span class="line">				num[position]++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>, i = <span class="number">0</span>; k &lt; <span class="built_in">array</span>.length; k++) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; num[k]; j++, i++) &#123;</span><br><span class="line">					<span class="built_in">array</span>[i] = bucket[k][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="各种排序算法对比">各种排序算法对比</h3><ul>
<li><p>资料：</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Sorting_algorithm#Comparison_of_algorithms" target="_blank" rel="external">这里</a>有各种算法的汇总，进入相应的算法的词条有动图；</li>
<li><a href="http://www.webhek.com/misc/comparison-sort" target="_blank" rel="external">这里</a>有HTML5动图，非常好看；</li>
</ul>
</li>
<li><p>复杂度对比：</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>排序算法</th>
<th>最好时间复杂度</th>
<th>平均时间复杂度</th>
<th>最坏时间复杂度</th>
<th>稳定性</th>
<th>空间复杂度</th>
</tr>
</thead>
<tbody>
<tr>
<td>冒泡排序</td>
<td>O(n)</td>
<td>O(n^2)</td>
<td>O(n^2)</td>
<td>稳定</td>
<td>O(1)</td>
</tr>
<tr>
<td>选择排序</td>
<td>O(n^2)</td>
<td>O(n^2)</td>
<td>O(n^2)</td>
<td>不稳定</td>
<td>O(1)</td>
</tr>
<tr>
<td>插入排序</td>
<td>O(n)</td>
<td>O(n^2)</td>
<td>O(n^2)</td>
<td>稳定</td>
<td>O(1)</td>
</tr>
<tr>
<td>希尔排序</td>
<td>O(n)</td>
<td>O(n^1.5)</td>
<td>O(n^2)</td>
<td>不稳定</td>
<td>O(1)</td>
</tr>
<tr>
<td>归并排序</td>
<td><code>O(n*logn)</code></td>
<td><code>O(n*logn)</code></td>
<td><code>O(n*logn)</code></td>
<td>稳定</td>
<td>O(1)</td>
</tr>
<tr>
<td>快速排序</td>
<td><code>O(n*logn)</code></td>
<td><code>O(n*logn)</code></td>
<td>O(n^2)</td>
<td>不稳定</td>
<td>O(logn)~O(n)</td>
</tr>
<tr>
<td>堆排序</td>
<td><code>O(n*logn)</code></td>
<td><code>O(n*logn)</code></td>
<td><code>O(n*logn)</code></td>
<td>不稳定</td>
<td>O(1)</td>
</tr>
<tr>
<td>基数排序</td>
<td>约为O(n)</td>
<td>约为O(n)</td>
<td>约为O(n)</td>
<td>稳定</td>
<td>O(rd+n)</td>
</tr>
</tbody>
</table>
<ul>
<li>各种排序方法的适用条件<ul>
<li>当待排序总数较小，用插入排序或选择排序，虽然他们的时间复杂度高，但是在排序总数较小时时间并不是主要矛盾；</li>
<li>当待排序对象基本有序时，用插入排序、冒泡排序、快速排序，因为他们在序列接近有序的情况下的时间复杂度比序列完全无序时低；</li>
<li>若待排序对象非常多，选择快速排序（首选）、堆排序、归并排序，因为他们的时间复杂度为O(nlgn)，即用空间换取时间，以便解决“时间太长”这个主要矛盾；</li>
<li>若要求排序算法稳定，则选用归并排序；</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/">JavaScript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Algorithm/">Algorithm</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
  <script>
  (function() {
    var cx = '017806109166577290598:caowtb3biqa';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>



</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Eric Chang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
	
	<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/cn/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by/3.0/cn/">知识共享署名 3.0 中国大陆许可协议</a>进行许可。
	
	<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','1BK1VZMDEA-ktxiBz_9B');
</script>

<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258423514'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1258423514%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
          
	
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>